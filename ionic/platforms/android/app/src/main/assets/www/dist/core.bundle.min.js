function EventToDirective(app,directive_name,eventName){return app.directive(directive_name,["$parse",function($parse){return{restrict:"A",compile:function($element,attr){return function(scope,element,attr){element.on(eventName,function(event){scope.$apply($parse(attr[directive_name]).bind(null,scope,{$event:event}))})}}}}])}window.Features=new function(){var _app=angular.module("starter"),$this={},__features={};return $this.featuresToLoadOnStart=[],$this.insertCSS=function(css_content,feature_code){var css=document.createElement("style");css.type="text/css",css.setAttribute("data-feature",feature_code),css.innerHTML=css_content,document.head.appendChild(css)},$this.isRegistered=function(code){return __features.hasOwnProperty(code)},$this.register=function(json,bundle){if(angular.isDefined(json.load_on_start)&&json.load_on_start){var onStart={path:bundle};json.on_start_factory&&(onStart.factory=json.on_start_factory),$this.featuresToLoadOnStart.push(onStart)}var lazyLoadBundle=angular.copy(bundle);json.lazyLoad&&json.lazyLoad.module&&(lazyLoadBundle=lazyLoadBundle.concat(json.lazyLoad.module));var feature_base="features/"+json.code+"/";_app.config(["$stateProvider","HomepageLayoutProvider",function($stateProvider,HomepageLayoutProvider){var template_base=feature_base+"assets/templates/",routes={};angular.forEach(json.routes,function(r){if(!1!==r.autoregister){var route={url:BASE_PATH+"/"+r.url,controller:r.controller};switch(angular.isDefined(lazyLoadBundle)&&(route.resolve={lazy:["$ocLazyLoad",function($ocLazyLoad){return json.lazyLoad&&json.lazyLoad.core&&json.lazyLoad.core.forEach(function(bundle){$ocLazyLoad.load("./dist/packed/"+bundle+".bundle.min.js")}),$ocLazyLoad.load(lazyLoadBundle)}]}),!0){case angular.isString(r.templateHTML):route.template=r.templateHTML;break;case angular.isObject(r.layouts)&&angular.isString(r.template):route.templateUrl=function(param){if(void 0!==param.layout_id&&angular.isString(r.layouts[param.layout_id]))return template_base+r.layouts[param.layout_id]+"/"+r.template;var layout_id=HomepageLayoutProvider.getLayoutIdForValueId(param.value_id);return angular.isString(r.layouts[layout_id])?template_base+r.layouts[layout_id]+"/"+r.template:template_base+r.layouts.default+"/"+r.template};break;case!0===r.externalTemplate&&angular.isString(r.template):route.templateUrl=r.template;break;case angular.isString(r.template):route.templateUrl=template_base+r.template}route.cache=!1!==r.cache,this[r.state]=route}},routes),angular.forEach(routes,function(route,state){$stateProvider.state(state,route)})}]),__features[json.code]=json},_app.config(["$stateProvider",function($stateProvider){$stateProvider.state("go-to-feature",{url:BASE_PATH+"/goto/feature/:code/value_id/:value_id",template:"redirecting..."})}]).factory("Features",["$q","$state",function($q,$state){var factory={register:function(){throw new Error("You cannot register new features at runtime, please use window.Features before angular app has bootstraped.")},get:function(feature_code){return __features.hasOwnProperty(feature_code)?__features[feature_code]:null},goTo:function(feature_code,value_id){var feature=factory.get(feature_code);if(feature){for(var route=null,i=0;i<feature.routes.length;i++){var r=feature.routes[i];if(angular.isObject(r)&&r.root){route=feature.routes[i];break}}route&&($state.go(route.state,{value_id:value_id}),$q.resolve())}return $q.reject}};return factory}]).run(["$rootScope","Features",function($rootScope,Features){$rootScope.$on("$stateChangeStart",function(evt,toState,toParams,fromState,fromParams){angular.isObject(toState)&&"go-to-feature"===toState.name&&(evt.preventDefault(),angular.isObject(toParams)&&angular.isString(toParams.code)&&toParams.code.trim().length>0&&!isNaN(+toParams.value_id)&&+toParams.value_id>0&&Features.goTo(toParams.code,toParams.value_id))})}]),$this},window.hexToRgb=function(hex){var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null},window.rgbToHex=function(red,green,blue){return"#"+((1<<24)+(red<<16)+(green<<8)+blue).toString(16).slice(1)},window.textStyleFromHex=function(hex){var statusBarStyle="light",rgbColor=window.hexToRgb(hex);return.299*rgbColor.r+.587*rgbColor.g+.114*rgbColor.b>186&&(statusBarStyle="dark"),statusBarStyle},window.updateStatusBar=function(hex){switch(window.StatusBar.backgroundColorByHexString(hex),window.textStyleFromHex(hex)){case"dark":window.StatusBar.styleDefault();break;case"light":default:window.StatusBar.styleLightContent()}},angular.module("starter").config(["$provide",function($provide){var transformAsFormPost=function(data,getHeaders){return function serializeData(data,prefix){angular.isString(prefix)||(prefix=""),prefix=prefix.trim(),angular.isArray(data)&&prefix.length<1&&(prefix="data");var pairs=[];if(angular.isObject(data)||angular.isArray(data)){var index=0;angular.forEach(data,function(value,key){angular.isArray(data)&&(key=index),key=encodeURIComponent(key),prefix.length>0&&(key=prefix+"["+key+"]"),angular.isArray(value)||angular.isObject(value)?pairs.push(serializeData(value,key)):((angular.isUndefined(value)||null===value)&&(value=""),pairs.push(key+"="+encodeURIComponent(value))),index+=1})}return pairs.join("&").replace(/%20/g,"+")}(data)};$provide.decorator("$http",["$delegate",function($delegate){return $delegate.postForm=function(url,data,config){return angular.isObject(config)||(config={}),angular.isObject(config.headers)||(config.headers={}),config.headers["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8",angular.isArray(config.transformRequest)?config.transformRequest.push(transformAsFormPost):angular.isFunction(config.transformRequest)?config.transformRequest=[config.transformRequest,transformAsFormPost]:config.transformRequest=transformAsFormPost,$delegate.post(url,data,config)},$delegate}])}]),angular.module("starter").service("AdmobService",function($log,$rootScope,$window){var service={interstitialWeights:{start:{show:.333,skip:.667},low:{show:.025,skip:.975},default:{show:.06,skip:.94},medium:{show:.125,skip:.875}},interstitialState:"start",viewEnterCount:0,options:{},forbiddenStates:[],getWeight:function(probs){var random=_.random(0,1e3),offset=0,keyUsed="app",match=!1;return _.forEach(probs,function(value,key){offset+=1e3*value,!match&&random<=offset&&(keyUsed=key,match=!0)}),$log.debug("AdMob key used: ",keyUsed),keyUsed},init:function(options){if($rootScope.isNativeApp&&$window.AdMob){var whom="app";ionic.Platform.isIOS()&&($log.debug("AdMob init iOS"),whom=service.getWeight(options.ios_weight),service.options=options[whom].ios,service.initWithOptions()),ionic.Platform.isAndroid()&&($log.debug("AdMob init Android"),whom=service.getWeight(options.android_weight),service.options=options[whom].android,service.initWithOptions())}},initWithOptions:function(){service.loadBanner(),service.prepareInterstitial()},loadBanner:function(){service.options.banner?($log.info("init admob banner"),$window.AdMob.removeBanner(),$window.AdMob.createBanner({adId:service.options.banner_id,adSize:"SMART_BANNER",position:$window.AdMob.AD_POSITION.BOTTOM_CENTER,autoShow:!0})):$log.info("!ko init admob banner")},removeBanner:function(){service.options.banner&&$window.AdMob.removeBanner()},forbidStates:function(states){service.forbiddenStates=service.forbiddenStates.concat(states)},prepareInterstitial:function(){service.options.interstitial?($log.info("init interstitial banner"),$window.AdMob.prepareInterstitial({adId:service.options.interstitial_id,autoShow:!1}),$rootScope.$on("$ionicView.enter",function(event,data){var canReloadBanner=!1;-1===service.forbiddenStates.indexOf(data.stateName)?(canReloadBanner=!0,service.viewEnterCount=service.viewEnterCount+1,service.viewEnterCount>=12&&(service.interstitialState="medium"),"show"===service.getWeight(service.interstitialWeights[service.interstitialState])?(document.addEventListener("onAdDismiss",service._reload),$window.AdMob.showInterstitial(),$window.AdMob.prepareInterstitial({adId:service.options.interstitial_id,autoShow:!1}),"start"===service.interstitialState?service.interstitialState="low":service.interstitialState="default",service.viewEnterCount=0):canReloadBanner&&service._reload()):service.removeBanner()})):$log.info("!ko init interstitial banner")},_reload:function(){service.loadBanner(),document.removeEventListener("onAdDismiss",service._reload)}};return service}),angular.module("starter").service("Analytics",function($pwaRequest,$session,$q,$rootScope,$log){var service={data:{},pool:[],storeInstallation:function(){var params={date:Math.round(Date.now()/1e3),OS:device.platform,OSVersion:device.version,Device:device.platform,DeviceVersion:device.model,deviceUUID:device.uuid,latitude:null,longitude:null};service.postData("_installation",params)},storeOpening:function(){var deferred=$q.defer(),params={date:Math.round(Date.now()/1e3),OS:cordova.device?device.platform:"Browser",OSVersion:cordova.device?device.version:null,Device:cordova.device?device.platform:"Browser",DeviceVersion:cordova.device?device.model:null,deviceUUID:cordova.device?device.uuid:null,latitude:null,longitude:null,locale:CURRENT_LANGUAGE};return service.postData("_opening",params).then(function(result){deferred.resolve(result)}).catch(function(error){deferred.reject()}),deferred.promise},storeClosing:function(){if(void 0!==service.data.storeClosingId){var params={date:Math.round(Date.now()/1e3),id:service.data.storeClosingId};service.postData("_closing",params)}else $log.debug("aborting /analytics/mobile_store/closing, no id.")},storePageOpening:function(page){var params={date:Math.round(Date.now()/1e3),featureId:page.value_id,OS:cordova.device?device.platform:"Browser",OSVersion:cordova.device?device.version:null,Device:cordova.device?device.platform:"Browser",DeviceVersion:cordova.device?device.model:null,deviceUUID:cordova.device?device.uuid:null,latitude:null,longitude:null,locale:CURRENT_LANGUAGE};service.postData("_pageopening",params)},storeProductOpening:function(product){var params={date:Math.round(Date.now()/1e3),productId:product.id,name:product.name,OS:cordova.device?device.platform:"Browser",OSVersion:cordova.device?device.version:null,Device:cordova.device?device.platform:"Browser",DeviceVersion:cordova.device?device.model:null,deviceUUID:cordova.device?device.uuid:null,latitude:null,longitude:null,locale:CURRENT_LANGUAGE};service.postData("_productopening",params)},storeProductSold:function(products){var params={date:Math.round(Date.now()/1e3),products:products,OS:cordova.device?device.platform:"Browser",OSVersion:cordova.device?device.version:null,Device:cordova.device?device.platform:"Browser",DeviceVersion:cordova.device?device.model:null,deviceUUID:cordova.device?device.uuid:null,latitude:null,longitude:null,locale:CURRENT_LANGUAGE};service.postData("_productsold",params)},postData:function(url,params){if(!isOverview){var request={url:url,params:params};service.pool.length<10?(service.pool.push(request),$session.setItem("analytics_pool",service.pool)):$session.getItem("analytics_pool").then(function(pool){pool&&(service.pool=pool),service.pool.push(request),service.commitPool()})}return $pwaRequest.reject("Analytics are disabled in Overview!")},commitPool:function(){$pwaRequest.post("analytics/mobile_pool/submit",{data:service.pool,cache:!1,headers:{"Content-Type":"application/x-www-form-urlencoded"}}),$session.setItem("analytics_pool",[])}};return $session.getItem("analytics_pool").then(function(pool){pool&&(service.pool=pool),service.commitPool()}),service}),angular.module("starter").service("Application",function($pwaRequest,$q,$rootScope,$session,$timeout,$ionicPlatform,$window,$queue,$log,Dialog,ProgressbarService){var service={is_webview:!IS_NATIVE_APP,known_modules:{calendar:"Event",catalog:"Catalog",custom_page:"Cms",discount:"Discount",fanwall:"Newswall",form:"Form",music_gallery:"MusicPlaylist",newswall:"Newswall",places:"Places",push_notification:"Push",qr_discount:"Push",rss_feed:"Rss",set_meal:"SetMeal",social_gaming:"SocialGaming",twitter:"Twitter",video_gallery:"Videos",wordpress:"Wordpress"},lazyLoadCodes:{calendar:["event"],custom_page:["cms"],fanwall:["newswall"],music_gallery:["media"],places:["cms","places"],qr_discount:["discount"],rss_feed:["rss"],set_meal:["catalog"],video_gallery:["video"],push_notification:["push"]}},_loaded=!1,_loaded_resolver=$q.defer(),_ready=!1,_ready_resolver=$q.defer();service.preLoad=function(pages){},Object.defineProperty(service,"loaded",{get:function(){return _loaded?$q.resolve():_loaded_resolver.promise},set:function(value){!0===(_loaded=!!value)&&_loaded_resolver.resolve()}}),Object.defineProperty(service,"ready",{get:function(){return _ready?$q.resolve():_ready_resolver.promise},set:function(value){!0===(_ready=!!value)&&_ready_resolver.resolve()}}),service.app_id=null,service.app_name=null,service.googlemaps_key=null,service.is_customizing_colors=$window.location.href.indexOf("application/mobile_customization_colors/")>=0,Object.defineProperty(service,"acceptedOfflineMode",{get:function(){return"ok"===$window.localStorage.getItem("sb-offline-mode")}}),service.populate=function(data){service.app_id=data.application.id,service.app_name=data.application.name,service.privacyPolicy=data.application.privacyPolicy,service.gdpr=data.application.gdpr,service.googlemaps_key=data.application.gmapsKey,service.is_locked=data.application.is_locked,service.offline_content=data.application.offlineContent,service.homepage_background=data.application.useHomepageBackground,service.backButton=data.application.backButton,service.default_background=data.homepageImage,service.colors=data.application.colors,service.ready=!0},service.getBackIcon=function(){if(void 0!==service.backButton)switch(service.backButton){case"ion-android-arrow-back":case"ion-arrow-left-a":case"ion-arrow-left-b":case"ion-arrow-left-c":case"ion-arrow-return-left":case"ion-chevron-left":case"ion-home":case"ion-ios-arrow-back":case"ion-ios-arrow-left":case"ion-ios-arrow-thin-left":case"ion-ios-home-outline":case"ion-ios-home":case"ion-ios-undo-outline":case"ion-ios-undo":case"ion-reply":return"icon "+service.backButton;default:return"icon ion-ios-arrow-back"}return"icon ion-ios-arrow-back"},service.showCacheDownloadModalOrUpdate=function(){ProgressbarService.init().then(function(){$rootScope.progressBarPercent=0;var offlineResponse=$window.localStorage.getItem("sb-offline-mode");if("ok"===offlineResponse)$log.debug("offline mode has been accepted, updating"),service.updateCache(!1);else if("no"===offlineResponse)$log.debug("offline mode has been refused in the past, not updating");else{$log.debug("offline mode need to be asked");Dialog.confirm("Offline content","Do you want to download all the contents now to access it when offline? If you do, we recommend you to use a WiFi connection.",["Yes","No"],"text-center").then(function(res){res?($window.localStorage.setItem("sb-offline-mode","ok"),$rootScope.openLoaderProgress(),ProgressbarService.createCircle(".ui-progress-view-circle"),$timeout(function(){$rootScope.backgroundLoaderProgress()},4700),service.updateCache(!0)):$window.localStorage.setItem("sb-offline-mode","no")})}})};var _updatingCache=!1,_replace_tokens=function(url){return _.isString(url)?url.replace("%DEVICE_UID%",$session.getDeviceUid()).replace("%CUSTOMER_ID%",$rootScope.customer_id):0};return service.updateCache=function(forceMain){if(window.OfflineMode&&window.OfflineMode.setCanCache(),!0!==_updatingCache){var device_screen=$session.getDeviceScreen();$pwaRequest.get("application/mobile_data/findall",{data:{device_uid:$session.getDeviceUid(),device_width:device_screen.width,device_height:device_screen.height},cache:!1,timeout:3e4}).then(function(data){var total=data.paths.length+data.assets.length;isNaN(total)&&(total=100);var progress=0,assets_done=JSON.parse($window.localStorage.getItem("sb-offline-mode-assets"));_.isArray(assets_done)||(assets_done=[]);var fileQueue=[],retryQueue=[],delay=500,maxRequest=15;ionic.Platform.isIOS()&&(delay=250,maxRequest=3);var requestCount=0,pathQueue=null,updateFailed=function(asset){(requestCount-=1)<0&&(requestCount=0),pathQueue.paused&&requestCount<=maxRequest&&pathQueue.start(),retryQueue.push(asset)},updateProgress=function(){if(progress+=1,(requestCount-=1)<0&&(requestCount=0),pathQueue.paused&&requestCount<=maxRequest&&pathQueue.start(),$rootScope.isNativeApp){var percent=progress/total;percent.toFixed(2)>$rootScope.progressBarPercent&&($rootScope.progressBarPercent=percent.toFixed(2)),isNaN($rootScope.progressBarPercent)&&($rootScope.progressBarPercent=0),ProgressbarService.updateProgress($rootScope.progressBarPercent),$window.localStorage.setItem("sb-offline-mode-assets",JSON.stringify(assets_done)),$rootScope.progressBarPercent>=1&&(_updatingCache=!1,$timeout(function(){ProgressbarService.remove(),$rootScope.closeLoaderProgress()},1e3))}},endProgress=function(){progress=total,$rootScope.progressBarPercent=1,ProgressbarService.updateProgress($rootScope.progressBarPercent),$window.localStorage.setItem("sb-offline-mode-assets",JSON.stringify(assets_done)),_updatingCache=!1,$timeout(function(){ProgressbarService.remove(),$rootScope.closeLoaderProgress()},1e3)},look_for_images=function(object){_.forEach(object,function(obj,key){if(_.isString(obj)&&/\.(png|jpg|jpeg|gif)$/.test(obj)){var path=_replace_tokens(obj);/^https?:/.test(path)||(path=(DOMAIN+"/"+path).replace(/([^:/])\/+/g,"$1/")),_.includes(data.assets,path)||(total+=1,pathQueue.add({type:"asset",path:path}))}else(_.isArray(obj)||_.isObject(obj))&&look_for_images(obj)})},retry=!0,fetchAssets=function(asset){"path"===asset.type?(requestCount+=1,$pwaRequest.get(asset.path,{cache:!$rootScope.isOverview}).then(function(data){_.isObject(data)&&look_for_images(data),updateProgress()},function(){retry?updateFailed(asset):updateProgress()})):"asset"===asset.type&&(requestCount+=1,$pwaRequest.cacheImage(asset.path).then(function(){updateProgress(),assets_done.push(asset.path)},function(){retry?updateFailed(asset):(updateProgress(),assets_done.push(asset.path))})),requestCount>=maxRequest&&pathQueue.pause()},options={delay:delay,paused:!0,complete:function(){updateProgress(),retry=!1;var _retryQueue=retryQueue;retryQueue.length>0?((pathQueue=$queue.queue(fetchAssets,{delay:1e3,paused:!0,complete:function(){updateProgress(),endProgress()}})).addEach(_retryQueue),pathQueue.start()):endProgress()}};_.forEach(data.paths,function(path){fileQueue.push({type:"path",path:_replace_tokens(path)})}),_.forEach(data.assets,function(asset){var path=_replace_tokens(asset);_.includes(assets_done,path)||fileQueue.push({type:"asset",path:path})}),service.fileQueue=fileQueue,(pathQueue=$queue.queue(fetchAssets,options)).addEach(fileQueue),service.loaded.then(function(){forceMain?pathQueue.start():($ionicPlatform.on("pause",function(result){pathQueue.start()}),$ionicPlatform.on("resume",function(result){pathQueue.pause()}))})},function(){_updatingCache=!1})}},service}),angular.module("starter").service("ConnectionService",function($ionicPlatform,$rootScope,$translate,$window,$log,$http,Dialog){var service={},_isOnline=!0;return Object.defineProperty(service,"isOnline",{get:function(){return _isOnline}}),Object.defineProperty(service,"isOffline",{get:function(){return!service.isOnline}}),service.show_popup=null,service.callbackFromNative=function(data){service.isOnline!==data.isOnline&&(_isOnline=data.isOnline,service.show_popup||!$rootScope.isNativeApp||_isOnline||(service.show_popup=!0,$rootScope.onPause||Dialog.alert("Info","You have gone offline","OK",-1).then(function(){service.show_popup=null})),$rootScope.$broadcast("connectionStateChange",data),_isOnline?$log.info("App is now online."):$log.info("App is offline."))},$ionicPlatform.ready(function(){$rootScope.isNativeApp&&$window.OfflineMode&&!IS_PREVIEW&&($window.OfflineMode.setCheckConnectionURL(DOMAIN+"/ping.txt"),$window.OfflineMode.registerCallback(service.callbackFromNative))}),service}),angular.module("starter").service("ContextualMenu",function($ionicSideMenuDelegate,$timeout,HomepageLayout){var _exists,_templateURL,_width,_is_enabled_function,self={};return Object.defineProperty(self,"exists",{get:function(){return _exists}}),Object.defineProperty(self,"templateURL",{get:function(){return _templateURL}}),Object.defineProperty(self,"width",{get:function(){return angular.isNumber(_width)&&_width>0&&_width||275}}),Object.defineProperty(self,"isEnabled",{get:function(){return(angular.isFunction(_is_enabled_function)&&_is_enabled_function||function(){return self.exists})()}}),Object.defineProperty(self,"direction",{get:function(){return"right"===HomepageLayout.properties.menu.position?"left":"right"}}),self.reset=function(){$timeout(function(){_exists=!1,_is_enabled_function=function(){return self.exists},_width=null,_templateURL=null})},self.reset(),self.set=function(templateURL,width,is_enabled_function){return angular.isString(templateURL)&&templateURL.length>0?(_exists=!0,_templateURL=templateURL,_width=width,_is_enabled_function=is_enabled_function):self.reset(),function(){_templateURL===templateURL&&self.reset()}},self.toggle=function(open){var direction=self.direction.slice(0,1).toUpperCase()+self.direction.slice(1);!0!==open&&!1!==open&&(open=!$ionicSideMenuDelegate["isOpen"+direction]()),self.exists&&self.isEnabled&&$ionicSideMenuDelegate["toggle"+direction](open)},self.open=function(){self.toggle(!0)},self.close=function(){self.toggle(!1)},self}),angular.module("starter").service("Country",function($pwaRequest,$q){var service={lastError:null,fetched:!1,countries:[],findAll:function(){var defer=$q.defer();return service.fetched?defer.resolve(service.countries):$pwaRequest.get("/application/mobile_country/findall").then(function(countries){service.countries=countries,service.fetched=!0,defer.resolve(service.countries)},function(error){defer.reject(error)}),defer.promise}};return service}),angular.module("starter").service("DatetimePicker",function($ocLazyLoad,$translate,$q){var service={loadedPromise:$q.defer(),defaults:{headers:!0,months:[$translate.instant("January","datepicker"),$translate.instant("February","datepicker"),$translate.instant("March","datepicker"),$translate.instant("April","datepicker"),$translate.instant("May","datepicker"),$translate.instant("June","datepicker"),$translate.instant("July","datepicker"),$translate.instant("September","datepicker"),$translate.instant("October","datepicker"),$translate.instant("November","datepicker"),$translate.instant("December","datepicker")],monthsShort:[$translate.instant("Jan","datepicker"),$translate.instant("Feb","datepicker"),$translate.instant("Mar","datepicker"),$translate.instant("Apr","datepicker"),$translate.instant("May","datepicker"),$translate.instant("Jun","datepicker"),$translate.instant("Jul","datepicker"),$translate.instant("Sep","datepicker"),$translate.instant("Oct","datepicker"),$translate.instant("Nov","datepicker"),$translate.instant("Dec","datepicker")],text:{title:$translate.instant("Pick a date and time","datepicker"),cancel:$translate.instant("Cancel","datepicker"),confirm:$translate.instant("OK","datepicker"),year:$translate.instant("Year","datepicker"),month:$translate.instant("Month","datepicker"),day:$translate.instant("Day","datepicker"),hour:$translate.instant("Hour","datepicker"),minute:$translate.instant("Minute","datepicker"),second:$translate.instant("Second","datepicker"),millisecond:$translate.instant("Millisecond","datepicker")}}};return $ocLazyLoad.load(["./dist/lazy/picker/picker.min.css","./dist/lazy/picker/picker.js"]).then(function(){Picker.setDefaults(service.defaults),service.loadedPromise.resolve()}),service.isLoaded=function(){return service.loadedPromise.promise},service}),angular.module("starter").service("Dialog",function($ionicPopup,$timeout,$translate,$q){var service={is_open:!1,stack:[],unStack:function(){service.is_open=!1,service.stack.length>=1&&$timeout(function(){var dialog=service.stack.shift();switch(dialog.type){case"alert":service.renderAlert(dialog.data);break;case"prompt":service.renderPrompt(dialog.data);break;case"confirm":service.renderConfirm(dialog.data);break;case"ionicPopup":service.renderIonicPopup(dialog.data)}},250)},alert:function(title,message,button,dismiss,context){var deferred=$q.defer();return service.stack.push({type:"alert",data:{title:title,message:message,button:button,dismiss:dismiss,context:context,promise:deferred}}),1!==service.stack.length||service.is_open||service.unStack(),deferred.promise},renderAlert:function(data){service.is_open=!0;var alertPromise=null,message=$translate.instant(data.title),cssClass=""===data.title?"popup-no-title":"";if(alertPromise=$ionicPopup.alert({title:$translate.instant(data.title,data.context),template:$translate.instant(data.message,data.context),cssClass:cssClass,okText:$translate.instant(data.button,data.context)}),data.promise.resolve(alertPromise),alertPromise.then(function(){service.unStack()}),"number"==typeof data.dismiss){var duration=data.dismiss;-1===data.dismiss&&(duration=Math.min(Math.max(50*message.length,2e3),7e3)+400),$timeout(function(){alertPromise.close()},duration)}},prompt:function(title,message,type,value){var deferred=$q.defer(),localType=void 0===type?"text":type,localValue=void 0===value?"":value;return service.stack.push({type:"prompt",data:{title:title,message:message,type:localType,value:localValue,promise:deferred}}),1!==service.stack.length||service.is_open||service.unStack(),deferred.promise},renderPrompt:function(data){service.is_open=!0;var cssClass=""===data.title?"popup-no-title":"";return $ionicPopup.prompt({title:$translate.instant(data.title,data.context),template:$translate.instant(data.message,data.context),okText:$translate.instant(data.button,data.context),cssClass:cssClass,inputType:data.type,inputPlaceholder:$translate.instant(data.value,data.context)}).then(function(result){void 0===result?data.promise.reject(result):data.promise.resolve(result),service.unStack()})},confirm:function(title,message,buttonsArray,cssClass,context){var deferred=$q.defer();return service.stack.push({type:"confirm",data:{title:title,message:message,buttons_array:buttonsArray,css_class:cssClass,context:context,promise:deferred}}),1!==service.stack.length||service.is_open||service.unStack(),deferred.promise},renderConfirm:function(data){service.is_open=!0;var cssClass=""===data.title?"popup-no-title":"";return $ionicPopup.confirm({title:$translate.instant(data.title,data.context),cssClass:data.css_class+" "+cssClass,template:data.message,okText:$translate.instant(data.buttons_array[0],data.context),cancelText:$translate.instant(data.buttons_array[1],data.context)}).then(function(result){data.promise.resolve(result),service.unStack()})},ionicPopup:function(config){var deferred=$q.defer();return service.stack.push({type:"ionicPopup",data:{config:config,promise:deferred}}),1!==service.stack.length||service.is_open||service.unStack(),deferred.promise},renderIonicPopup:function(data){return service.is_open=!0,$ionicPopup.show(data.config).then(function(result){data.promise.resolve(result),service.unStack()})}};return service}),angular.module("starter").service("SafePopups",function(Dialog){var service={show:function(type,params){var button={};switch(type){case"alert":return 1===params.buttons.length&&(button=params.buttons[0]),Dialog.alert(params.title,params.template,button);case"confirm":return Dialog.confirm(params.title,params.template,params.buttons,"");default:return Dialog.ionicPopup(params)}}};return service}),angular.module("starter").service("FacebookConnect",function($cordovaOauth,$rootScope,$timeout,$window,$pwaRequest,Customer,Dialog,SB,Loader){var _this=this;return _this.app_id=null,_this.version="v2.7",_this.is_initialized=!1,_this.is_logged_in=!1,_this.access_token=null,_this.permissions=null,_this.fb_login=null,_this.login=function(){if(!$rootScope.isNotAvailableInOverview()){var scope=_this.permissions?_this.permissions.join(","):"",redirectUri=encodeURIComponent(DOMAIN+"/"+APP_KEY+"?login_fb=true"),fbLocation="https://graph.facebook.com/oauth/authorize?client_id="+_this.app_id+"&scope="+scope+"&response_type=token&redirect_uri=";if(DEVICE_TYPE===SB.DEVICE.TYPE_BROWSER)$window.location=fbLocation+redirectUri;else{Loader.show();var options={redirect_uri:"https://localhost/callback"};$pwaRequest.get(fbLocation+options.redirect_uri,{refresh:!0,cache:!1}).then(function(success){},function(error){options.redirect_uri="http://localhost/callback"}).then(function(){$cordovaOauth.facebook(_this.app_id,_this.permissions,options).then(function(result){Customer.loginWithFacebook(result.access_token).then(function(){Customer.login_modal.hide()}).finally(function(){Loader.hide()})},function(error){Dialog.alert("Login error",error,"OK",-1).then(function(){Customer.login_modal.hide(),Loader.hide()})})})}}},_this.logout=function(){_this.is_logged_in=!1,_this.access_token=null},$rootScope.$on(SB.EVENTS.AUTH.logoutSuccess,function(){$timeout(function(){_this.logout()})}),_this}),angular.module("starter").service("GoogleMaps",function($cordovaGeolocation,$location,$q,$rootScope,$translate,$window,Application){"use strict";var __self={is_loaded:!1,reset:function(){service.directionsRenderer&&(service.directionsRenderer.setPanel(null),service.directionsRenderer.setMap(null));for(var i=0;i<service.markers;i++)google.maps.event.removeListener(service.markers[i],"click"),service.markers[i].setMap(null);service.map=null,service.panel_id=null,service.directionsRenderer=null,service.markers=[],__self.is_loaded=!1},_calculateRoute:function(origin,destination,params,rejectWithResponseAndStatus){var deferred=$q.defer();_.isObject(params)||(params={mode:google.maps.DirectionsTravelMode.WALKING,unitSystem:google.maps.UnitSystem.METRIC}),_.isObject(params.request)||(params.request={}),this.directionsService||(this.directionsService=new google.maps.DirectionsService);var request=_.merge({origin:new google.maps.LatLng(origin.latitude,origin.longitude),destination:new google.maps.LatLng(destination.latitude,destination.longitude),travelMode:params.mode,unitSystem:params.unitSystem},params.request);return this.directionsService.route(request,function(response,status){if(status==google.maps.DirectionsStatus.OK)deferred.resolve(response);else{var errorMessage=$translate.instant("ZERO_RESULTS"===status?"There is no route available with these informations.":"An unexpected error occurred while calculating the route.");console.error(errorMessage,status),!0===rejectWithResponseAndStatus?deferred.reject([response,status]):deferred.reject(errorMessage)}}),deferred.promise},_updateBoundsFromPoints:function(bounds,p){var latitude=parseFloat(p.latitude),longitude=parseFloat(p.longitude);return(null===bounds[0][0]||bounds[0][0]>latitude)&&(bounds[0][0]=latitude),(null===bounds[1][0]||bounds[1][0]<latitude)&&(bounds[1][0]=latitude),(null===bounds[0][1]||bounds[0][1]>longitude)&&(bounds[0][1]=longitude),(null===bounds[1][1]||bounds[1][1]<longitude)&&(bounds[1][1]=longitude),bounds},_extendBounds:function(bounds,margin){if(margin){var latitudeMargin=(bounds[1][0]-bounds[0][0])*margin;0===latitudeMargin&&(latitudeMargin=.02),bounds[0][0]-=latitudeMargin,bounds[1][0]+=latitudeMargin;var longitudeMargin=(bounds[1][1]-bounds[0][1])*margin;0===longitudeMargin&&(longitudeMargin=.01),bounds[0][1]-=longitudeMargin,bounds[1][1]+=longitudeMargin}return bounds}},gmap_callbacks=[],gmap_script_appended=!1,gmap_loaded=!1,_init_called=!1;$window.initGMapCallback=function(){if(gmap_script_appended)for(gmap_loaded=!0;gmap_callbacks.length>0;){var func=gmap_callbacks.shift();_.isFunction(func)&&func.apply($window,arguments)}};var service={USER_INTERACTED_EVENT:"GoogleMaps.UserInteracted",map:null,directionsRenderer:null,panel_id:null,markers:[],markerCluster:null,lastInfoWindow:null,init:function(){if("undefined"==typeof GoogleMaps&&!gmap_script_appended){if(_init_called)return;_init_called=!0,Application.loaded.then(function(){var google_maps=document.createElement("script");google_maps.type="text/javascript",google_maps.src="https://maps.googleapis.com/maps/api/js?libraries=geometry,places&key="+Application.googlemaps_key+"&callback=initGMapCallback",document.body.appendChild(google_maps),gmap_script_appended=!0})}gmap_loaded&&$window.initGMapCallback()},addCallback:function(func){gmap_callbacks.push(func),service.init()},createMap:function(element,options){angular.isObject(options)||(options={}),__self.is_loaded&&__self.reset(),options=_.merge({zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP},options),service.map=new google.maps.Map(document.getElementById(element),options),google.maps.event.addListener(service.map,"tilesloaded",function(){console.log("Maps is loaded"),__self.is_loaded=!0});var userInteracted=function(event_name){return function(){$rootScope.$broadcast(service.USER_INTERACTED_EVENT,event_name)}};return google.maps.event.addListener(service.map,"dblclick",userInteracted("dblclick")),google.maps.event.addListener(service.map,"dragend",userInteracted("dragend")),google.maps.event.addDomListener(service.map.getDiv(),"mousewheel",userInteracted("wheel"),!0),google.maps.event.addDomListener(service.map.getDiv(),"DOMMouseScroll",userInteracted("wheel"),!0),service.map},setCenter:function(coordinates){if(coordinates){var center=new google.maps.LatLng(coordinates.latitude,coordinates.longitude);return service.map.setCenter(center)}return $cordovaGeolocation.getCurrentPosition().then(function(position){service.setCenter(position.coords)})},setPanelId:function(panel_id){service.panel_id=panel_id},isLoaded:function(){return __self.is_loaded},addCluster:function(){service.markerCluster=new MarkerClusterer(service.map,service.markers,{maxZoom:16,minimumClusterSize:3,imagePath:"./img/cluster/m"})},addMarker:function(marker,index){var latlng=new google.maps.LatLng(marker.latitude,marker.longitude),icon=null;if(marker.icon&&marker.icon.url){var width=marker.icon.width?marker.icon.width:95,height=marker.icon.height?marker.icon.height:49;icon={url:marker.icon.url,scaledSize:new google.maps.Size(width,height)}}var options=_.merge({position:latlng,map:service.map,icon:icon},marker.markerOptions),mapMarker=new google.maps.Marker(options);return mapMarker.onClick=marker.onClick,mapMarker.config=marker.config,_.isFunction(marker.onClick)&&google.maps.event.addListener(mapMarker,"click",function(){mapMarker.onClick(mapMarker)}),marker.is_centered&&service.setCenter(marker),+index<0?service.markers.push(mapMarker):service.markers.splice(index,0,mapMarker),mapMarker},removeMarker:function(mapMarker){var index=service.markers.indexOf(mapMarker);return index>=0&&(service.markers[index].setMap(null),service.markers.splice(index,1),!0)},replaceMarker:function(mapMarker,marker){return!!service.removeMarker(mapMarker)&&service.addMarker(marker)},addRoute:function(route,custom_directions_renderer,custom_panel_div_id){var renderer=null;_.isObject(custom_directions_renderer)&&_.isFunction(custom_directions_renderer.setDirections)?renderer=custom_directions_renderer:(service.directionsRenderer||(service.directionsRenderer=new google.maps.DirectionsRenderer),renderer=service.directionsRenderer),renderer.setMap(service.map),renderer.setDirections(route);var panelDiv=document.getElementById(custom_panel_div_id||service.panel_id);panelDiv&&renderer.setPanel(panelDiv)},fitToBounds:function(bounds){var sw=new google.maps.LatLng(bounds.latitudeMin,bounds.longitudeMin),ne=new google.maps.LatLng(bounds.latitudeMax,bounds.longitudeMax),mapBounds=new google.maps.LatLngBounds(sw,ne);service.map.fitBounds(mapBounds)},geocode:function(address){var deferred=$q.defer();return this.geocoder||(this.geocoder=new google.maps.Geocoder),this.geocoder.geocode({address:address},function(results,status){if(status==google.maps.GeocoderStatus.OK){var latitude=results[0].geometry.location.lat(),longitude=results[0].geometry.location.lng();deferred.resolve({latitude:latitude,longitude:longitude})}else{var errorMessage=$translate.instant("The address you're looking for does not exist.");console.error(errorMessage),deferred.reject(errorMessage)}}),deferred.promise},reverseGeocode:function(position){var deferred=$q.defer();this.geocoder||(this.geocoder=new google.maps.Geocoder);var latlng={lat:position.latitude,lng:position.longitude};return this.geocoder.geocode({location:latlng},function(results,status){if(status==google.maps.GeocoderStatus.OK)deferred.resolve(results);else{var errorMessage=$translate.instant("The address you're looking for does not exists.");deferred.reject(errorMessage)}}),deferred.promise},calculateRoute:function(origin,destination,params,rejectWithResponseAndStatus){var deferred=$q.defer();return origin?__self._calculateRoute(origin,destination,params,rejectWithResponseAndStatus).then(function(route){deferred.resolve(route)},function(err){deferred.reject(err)}):$cordovaGeolocation.getCurrentPosition().then(function(position){__self._calculateRoute(position.coords,destination,params,rejectWithResponseAndStatus).then(function(route){deferred.resolve(route)},function(err){deferred.reject(err)})},function(err){angular.isObject(err)&&1===err.code&&angular.isString(err.message)&&err.message.indexOf("secure origin")&&deferred.reject("Your location could not be found because your application doesn't use SSL."),deferred.reject("gps_disabled")}),deferred.promise},getBoundsFromPoints:function(points,margin){if(points){var bounds=[[null,null],[null,null]];return points.reduce(function(output,p){return p.latitude||console.warn("Invalid latitude."),p.longitude||console.warn("Invalid longitude."),bounds=__self._updateBoundsFromPoints(bounds,p),output},[]),0!==points.length&&margin&&(bounds=__self._extendBounds(bounds,margin)),{latitudeMin:bounds[0][0],latitudeMax:bounds[1][0],longitudeMin:bounds[0][1],longitudeMax:bounds[1][1]}}return null}},ready=!1,readyResolver=$q.defer();return Object.defineProperty(service,"ready",{get:function(){return ready?$q.resolve():readyResolver.promise},set:function(value){!0===(ready=!!value)&&readyResolver.resolve()}}),service.init(),service}),angular.module("starter").service("layout_10",function($rootScope){var service={getTemplate:function(){return"templates/home/l10/view.html"},getModalTemplate:function(){return"templates/home/l10/modal.html"},onResize:function(){},features:function(features,moreButton){var thirdOption=features.overview.options[2],fourthOption=features.overview.options[3];return features.overview.options[2]=moreButton,features.overview.options[3]=thirdOption,features.overview.options[4]=fourthOption,features.options=features.options.slice(4,features.options.length),features}};return service}),angular.module("starter").service("layout_17",function($rootScope,$location,$timeout){var service={getTemplate:function(){return"templates/home/l17/view.html"},getModalTemplate:function(){return"templates/home/modal/view.html"},onResize:function(){$timeout(function(){service._resize(),$timeout(function(){service._resize()},500)},100)},features:function(features,more_button){var i,j,temparray,more_options=features.options.slice(12),chunks=[];for(i=0,j=more_options.length;i<j;i+=2)temparray=more_options.slice(i,i+2),chunks.push(temparray);return features.chunks=chunks,features},_resize:function(){var scrollview=document.getElementById("metro-scroll");if(scrollview&&(scrollview.style.display="block"),document.getElementById("metro-scroll")&&document.getElementById("metro-line-2")){var spacing=document.getElementById("metro-scroll").getBoundingClientRect().width/100*2.5,element=document.getElementById("metro-line-2");if(element){var positionInfo=element.getBoundingClientRect();element.style.height=(positionInfo.width-spacing)/4+"px"}for(var lines=document.getElementsByClassName("metro-line"),i=0;i<lines.length;i++)lines[i].style.marginBottom=spacing+"px"}}};return service}),angular.module("starter").service("layout_8",function(){var service={getTemplate:function(){return"templates/home/l8/view.html"},getModalTemplate:function(){return"templates/home/modal/view.html"},onResize:function(){},features:function(features,more_button){var first_option=null,options=[];return 0!==features.options.length&&(first_option=features.options[0],options=features.options.slice(1)),features.first_option=first_option,features.options=options,features}};return service}),angular.module("starter").service("LinkService",function($rootScope,$translate,$window,SB){return{openLink:function(url,options){if(!$rootScope.isNotAvailableInOverview()&&!$rootScope.isNotAvailableOffline()){void 0===options&&(options={hide_navbar:!0,use_external_app:!1});var target="_blank",inAppBrowserOptions=[];switch(!0){case/^(tel:).*/.test(url)&&DEVICE_TYPE===SB.DEVICE.TYPE_ANDROID:target="_self";break;case options.use_external_app:case/.*\.pdf($|\?)/.test(url):case options.hide_navbar&&DEVICE_TYPE===SB.DEVICE.TYPE_IOS:target="_system",inAppBrowserOptions.push("EnableViewPortScale=yes");break;default:options&&options.hide_navbar?(inAppBrowserOptions.push("location=no"),inAppBrowserOptions.push("toolbar=no")):(inAppBrowserOptions.push("location=yes"),inAppBrowserOptions.push("closebuttoncaption="+$translate.instant("Done")),inAppBrowserOptions.push("transitionstyle=crossdissolve"),inAppBrowserOptions.push("toolbar=yes"))}$window.open(url,target,inAppBrowserOptions.join(","))}}}}),angular.module("starter").service("Loader",function($ionicLoading,$translate,$state,$timeout,Dialog){var service={is_open:!1,last_config:"",promise:null,timeout:null,keep_timeout:!1,timeout_count:0,absolute_timeout:null,callTimeout:function(){service.timeout=$timeout(function(){service.timeout_count=service.timeout_count+1,service.keep_timeout=!0;var buttons=["Go back home","Continue"];service.timeout_count>=2&&(service.keep_timeout=!1,buttons=["Go back home"]),service.hide(),Dialog.confirm("Feature timeout","It seems the feature your are trying to load is taking too much time!<br />Would you like to continue?",buttons).then(function(result){result||service.timeout_count>=2?(service.keep_timeout=!1,service.hide(),$state.go("home")):(service.show(),service.callTimeout())})},1e3)},show:function(text,config,replace){if(void 0===replace&&(replace=!1),!service.is_open){service.is_open=!0;var template='<ion-spinner class="spinner-custom"></ion-spinner>';void 0!==text&&(template=replace?$translate.instant(text):'<ion-spinner class="spinner-custom"></ion-spinner><br /><span>'+$translate.instant(text)+"</span>"),null===service.last_config&&(service.last_config=angular.extend({template:template},config)),service.promise=$ionicLoading.show(service.last_config),service.timeout_count=0,!0===service.keep_timeout&&service.callTimeout(),service.startAbsoluteTimeout()}return service.promise},startAbsoluteTimeout:function(){service.absolute_timeout=$timeout(function(){service.hide()},3e4)},clearAbsoluteTimeout:function(){null!==service.absolute_timeout&&($timeout.cancel(service.absolute_timeout),service.absolute_timeout=null)},hide:function(){return service.is_open=!1,!1===service.keep_timeout&&null!==service.timeout&&($timeout.cancel(service.timeout),service.timeout=null,service.timeout_count=0,service.last_config=null),service.clearAbsoluteTimeout(),$ionicLoading.hide()}};return service}),angular.module("starter").service("Location",function($cordovaGeolocation,$q){var service={debug:!0,lastFetch:null,position:null,isEnabled:null,getLocation:function(config,force){var deferred=$q.defer(),isResolved=!1,localForce=void 0!==force,localConfig=angular.extend({enableHighAccuracy:!0,timeout:1e4,maximumAge:0},config),localRequestLocation=function(deferred){!localForce&&null!==service.lastFetch&&service.lastFetch+42e3>Date.now()&&(deferred.resolve(service.position),isResolved=!0),$cordovaGeolocation.getCurrentPosition(localConfig).then(function(position){service.lastFetch=Date.now(),service.position=position,service.debug&&console.log("position ok",position),isResolved||deferred.resolve(service.position)},function(){service.debug&&console.log("position ko"),isResolved||deferred.reject()})},localReject=function(deferred){service.isEnabled=!1,deferred.reject()};if(!1===service.isEnabled)service.debug&&console.log("service disabled"),deferred.reject();else if(void 0!==cordova.plugins.permissions){var permissions=cordova.plugins.permissions;permissions.checkPermission(permissions.ACCESS_FINE_LOCATION,function(status){status.hasPermission?localRequestLocation(deferred):permissions.requestPermission(permissions.ACCESS_FINE_LOCATION,function(success){localRequestLocation(deferred)},function(error){localReject(deferred)})},function(error){permissions.requestPermission(permissions.ACCESS_FINE_LOCATION,function(success){localRequestLocation(deferred)},function(error){localReject(deferred)})})}else localRequestLocation(deferred);return deferred.promise},getLatest:function(){var deferred=$q.defer();return null===service.lastFetch?service.getLocation().then(function(position){deferred.resolve(position)},function(){deferred.reject(!1)}):deferred.resolve(service.position),deferred.promise}};return service}),angular.module("starter").service("MediaPlayer",function($interval,$rootScope,$state,$log,$location,$ionicHistory,$stateParams,$timeout,$translate,$window,Application,HomepageLayout,Dialog,Modal,Loader,SB){var service={media:null,is_initialized:!1,is_minimized:!1,is_playing:!1,is_radio:!1,is_shuffling:!1,is_stream:!1,repeat_type:null,shuffle_tracks:[],tracks:[],current_index:0,current_track:null,duration:0,elapsed_time:0,playlistModal:null,value_id:null,use_music_controls:SB.DEVICE.TYPE_BROWSER!==DEVICE_TYPE,createModal:function(scope){service.playlistModal||Modal.fromTemplateUrl("templates/media/music/l1/player/playlist.html",{scope:scope}).then(function(modal){service.playlistModal=modal})},openPlaylist:function(){service.playlistModal&&service.playlistModal.show()},closePlaylist:function(){service.playlistModal&&service.playlistModal.hide()},loading:function(){var message=$translate.instant("Loading");service.is_radio&&(message=$translate.instant("Buffering")),Loader.show(message)}},music_controls_events=function(event){switch(event){case"music-controls-next":service.is_radio||service.next();break;case"music-controls-previous":service.is_radio||service.prev();break;case"music-controls-pause":case"music-controls-play":case"music-controls-toggle-play-pause":service.playPause();break;case"music-controls-destroy":service.destroy()}};return service.init=function(tracks_loader,is_radio,track_index){service.value_id!==$stateParams.value_id&&service.destroy(),service.media&&service.current_track.streamUrl!==tracks_loader.tracks[track_index].streamUrl&&service.destroy(),service.media||(service.value_id=$stateParams.value_id,service.is_radio=is_radio,service.current_index=track_index,tracks_loader&&(service.tracks=tracks_loader.tracks)),service.is_initialized=!0,service.openPlayer(),service.use_music_controls&&(MusicControls.subscribe(music_controls_events),MusicControls.listen())},service.play=function(){service.media.play(),service.is_playing=!0},service.pre_start=function(){service.media&&service.media.pause(),service.is_playing=!1,service.duration=0,service.elapsed_time=0,service.is_media_loaded=!1,service.is_media_stopped=!1},service.start=function(){if(service.current_track=service.tracks[service.current_index],$log.info(service.current_track,service.tracks),-1===service.current_track.streamUrl.indexOf("http://")&&-1===service.current_track.streamUrl.indexOf("https://"))return Loader.hide(),void Dialog.alert("Error","No current stream to load.","OK",-1);service.current_track.albumCover&&(service.current_track.albumCover=service.current_track.albumCover.replace("100x100bb",$window.innerWidth+"x"+$window.innerWidth+"bb")),service.is_stream=service.is_radio,$log.debug(service.current_track),service.media=new Audio(service.current_track.streamUrl),service.media.onended=function(){service.next()},service.play(),service.updateSeekBar(),Loader.hide(),service.updateMusicControls()},service.reset=function(){service.media=null,service.seekbarTimer=null,service.is_shuffling=!1,service.is_initialized=!1,service.is_minimized=!1,$rootScope.$broadcast(SB.EVENTS.MEDIA_PLAYER.HIDE),service.repeat_type=null,service.current_index=0,service.current_track=null,service.shuffle_tracks=[],service.use_music_controls&&(MusicControls.destroy(),MusicControls.subscribe(music_controls_events),MusicControls.listen())},service.destroy=function(){$interval.cancel(service.seekbarTimer),service.media&&service.is_playing&&service.media.pause(),service.reset()},service.openPlayer=function(){$state.go("media-player",{value_id:service.value_id}),service.is_minimized=!1,$rootScope.$broadcast(SB.EVENTS.MEDIA_PLAYER.HIDE),service.media||$timeout(function(){service.pre_start(),service.start()},1e3)},service.playPause=function(){service.is_playing?(service.media.pause(),$interval.cancel(service.seekbarTimer),service.use_music_controls&&MusicControls.updateIsPlaying(!1)):(service.media.play(),service.use_music_controls&&MusicControls.updateIsPlaying(!0)),service.is_playing=!service.is_playing,service.updateMusicControls()},service.prev=function(){"one"===service.repeat_type?service.seekTo(0):service.is_shuffling?(service.shuffle_tracks.length>=service.tracks.length&&"all"===service.repeat_type&&(service.shuffle_tracks=[]),service._randomSong()):"all"===service.repeat_type&&0===service.current_index?service.current_index=service.tracks.length-1:service.current_index>0&&(service.current_index=service.current_index-1),service.pre_start(),service.start()},service.next=function(){"one"===service.repeat_type?service.seekTo(0):(service.is_shuffling?(service.shuffle_tracks.length>=service.tracks.length&&"all"===service.repeat_type&&(service.shuffle_tracks=[]),service._randomSong()):"all"===service.repeat_type&&service.current_index>=service.tracks.length-1?service.current_index=0:service.current_index<service.tracks.length-1&&(service.current_index=service.current_index+1),service.pre_start(),service.start())},service._randomSong=function(){for(var random_index=Math.floor(Math.random()*service.tracks.length);-1!==service.shuffle_tracks.indexOf(random_index)||random_index===service.current_index;)-1!==service.shuffle_tracks.indexOf(random_index)?random_index=Math.floor(Math.random()*service.tracks.length):random_index+=1;service.shuffle_tracks.length>=service.tracks.length&&(random_index=0),service.shuffle_tracks.push(random_index),service.current_index=random_index,service.updateMusicControls()},service.backward=function(){var tmp_seekto=service.elapsed_time-10;tmp_seekto<0?service.prev():service.elapsed_time=tmp_seekto,service.seekTo(service.elapsed_time)},service.forward=function(){var tmp_seekto=service.elapsed_time+10;tmp_seekto>service.media.duration?service.next():service.elapsed_time=tmp_seekto,service.seekTo(service.elapsed_time)},service.willSeek=function(){service.is_playing&&(service.media.pause(),service.is_playing=!1)},service.seekTo=function(position){0===position&&(service.media.pause(),service.is_playing=!1),service.media.currentTime=position,service.is_playing||service.playPause()},service.repeat=function(){switch(service.repeat_type){case null:service.repeat_type="all";break;case"all":service.repeat_type="one";break;case"one":service.repeat_type=null}},service.shuffle=function(){service.shuffle_tracks=[],service.is_shuffling=!service.is_shuffling},service.updateMusicControls=function(){if(service.use_music_controls){var hasPrev=!0,hasNext=!0;service.is_radio&&(hasPrev=!1,hasNext=!1),0===service.current_index&&(hasPrev=!1),service.current_index===service.tracks.length-1&&(hasNext=!1),MusicControls.create({track:service.current_track.name,artist:service.current_track.artistName,cover:service.current_track.albumCover,isPlaying:!0,dismissable:!0,hasPrev:hasPrev,hasNext:hasNext,hasClose:!0,album:service.current_track.albumName,duration:service.media.duration,elapsed:service.media.currentTime,ticker:$translate.instant("Now playing ")+service.current_track.name},function(){$log.debug("success")},function(){$log.debug("error")})}},service.updateSeekBar=function(){service.seekbarTimer=$interval(function(){try{service.is_playing&&(service.elapsed_time=service.media.currentTime),!service.is_radio&&service.is_media_stopped&&service.is_media_loaded&&($interval.cancel(service.seekbarTimer),service.is_media_stopped=!1,service.next())}catch(e){$interval.cancel(service.seekbarTimer)}},100)},service.goBack=function(radio,destroy){radio&&void 0!==destroy?HomepageLayout.getFeatures().then(function(features){var localFeatures=features;if(!Application.is_customizing_colors&&HomepageLayout.properties.options.autoSelectFirst&&localFeatures&&!1!==localFeatures.first_option){for(var featIndex=0,fi=0;fi<localFeatures.options.length;fi+=1){var feat=localFeatures.options[fi];if("code_scan"!==feat.code&&"radio"!==feat.code&&"padlock"!==feat.code){featIndex=fi;break}}localFeatures.options[featIndex].path!=$location.path()&&($ionicHistory.nextViewOptions({historyRoot:!0,disableAnimate:!1}),$location.path(localFeatures.options[featIndex].path).replace())}else $timeout(function(){$ionicHistory.nextViewOptions({historyRoot:!0,disableAnimate:!1}),$state.go("home")})}):$ionicHistory.goBack(-1)},service}),angular.module("starter").service("Modal",function($rootScope,$ionicModal,$timeout,$q){var service={is_open:!1,stack:[],current_modal:null,modal_hidden_subscriber:null};return $rootScope.$on("modal.shown",function(){service.is_open=!0,service.modal_hidden_subscriber=$rootScope.$on("modal.hidden",function(){service.modal_hidden_subscriber(),service.current_modal.remove(),service.current_modal=null,service.is_open=!1,service.unStack()})}),service.unStack=function(){service.stack.length>=1?$timeout(function(){var modal=service.stack.shift();switch(modal.type){case"fromTemplateUrl":service.renderFromTemplateUrl(modal.data);break;case"fromTemplate":service.renderFromTemplate(modal.data)}},250):(service.current_modal=null,$timeout(function(){},250))},service.fromTemplateUrl=function(templateUrl,config){var deferred=$q.defer();return service.stack.push({type:"fromTemplateUrl",data:{templateUrl:templateUrl,config:config,promise:deferred}}),1!==service.stack.length||service.is_open||service.unStack(),deferred.promise},service.renderFromTemplateUrl=function(data){return $ionicModal.fromTemplateUrl(data.templateUrl,data.config).then(function(modal){service.current_modal=modal,data.promise.resolve(modal)})},service.fromTemplate=function(template,config){var deferred=$q.defer();return service.stack.push({type:"fromTemplate",data:{template:template,config:config,promise:deferred}}),1!==service.stack.length||service.is_open||service.unStack(),deferred.promise},service.renderFromTemplate=function(data){return $ionicModal.fromTemplate(data.template,data.config).then(function(modal){service.current_modal=modal,data.promise.resolve(modal)})},service}),angular.module("starter").service("MusicTracksLoader",function($q,$stateParams,MusicTrack){MusicTrack.value_id=$stateParams.value_id;var service={_filterDuplicatedAlbums:function(albums,albumsIds){return albumsIds||(albumsIds=[]),albums=albums.reduce(function(albums,album){return-1===albumsIds.indexOf(album.id)&&(albumsIds.push(album.id),albums.push(album)),albums},[])},loadTracksFromAlbums:function(albums){var deferred=$q.defer();albums=service._filterDuplicatedAlbums(albums,[]);var tracksLoader=service._buildTracksLoader(albums);return deferred.resolve(service.readNextTracks(tracksLoader,50)),deferred.promise},loadTracksFromPlaylists:function(playlists){var deferred=$q.defer(),albumsIds=[],albums=playlists.reduce(function(albums,playlist){var playlistAlbums=service._filterDuplicatedAlbums(playlist.albums,albumsIds);return albums=albums.concat(playlistAlbums)},[]),tracksLoader=service._buildTracksLoader(albums);return deferred.resolve(service.readNextTracks(tracksLoader,50)),deferred.promise},_buildTracksLoader:function(albums){return console.log("_buildTracksLoader",albums),{albums:albums,tracks:[],albumsLoaded:0,errorOccured:!1,fullyLoaded:function(){return this.errorOccured||this.albums.length===this.albumsLoaded},loadMore:function(quantity){return service.readNextTracks(this,quantity)}}},_buildTracksLoaderForSingleAlbum:function(album,tracks){var tracksLoader=service._buildTracksLoader([album]);return tracksLoader.tracks=tracks,tracksLoader.albumsLoaded=1,tracksLoader},loadSingleTrack:function(track){var tracksLoader=service._buildTracksLoader([]);return tracksLoader.tracks=[track],tracksLoader.albumsLoaded=0,tracksLoader},readNextTracks:function(tracksLoader,quantityToLoad){return service.readNextTracksRecursive([],tracksLoader,quantityToLoad)},readNextTracksRecursive:function(tracksLoaded,tracksLoader,quantityToLoad){var deferred=$q.defer(),maxAlbumsToLoadAtOnce=Math.ceil((quantityToLoad-tracksLoaded.length)/15);return 0===maxAlbumsToLoadAtOnce&&(maxAlbumsToLoadAtOnce=1),service.readNextAlbumsTracks(tracksLoader,maxAlbumsToLoadAtOnce).then(function(result){tracksLoaded=tracksLoaded.concat(result.tracksLoaded),!tracksLoader.fullyLoaded()&&tracksLoaded.length<quantityToLoad?deferred.resolve(service.readNextTracksRecursive(tracksLoaded,tracksLoader,quantityToLoad,maxAlbumsToLoadAtOnce)):deferred.resolve({tracksLoader:tracksLoader,tracksLoaded:tracksLoaded})},function(err){console.error("Error while loading tracks.",err),deferred.reject(err),tracksLoader.errorOccured=!0}),deferred.promise},readNextAlbumsTracks:function(tracksLoader,maxAlbumsToLoad){for(var deferred=$q.defer(),promises=[],i=0;i<maxAlbumsToLoad&&!tracksLoader.fullyLoaded();i++,tracksLoader.albumsLoaded++){var album=tracksLoader.albums[tracksLoader.albumsLoaded],param={};"album"==album.element?param.album_id=album.id:param.track_id=album.id,promises.push(MusicTrack.findByAlbum(param))}try{$q.all(promises).then(function(tracksResponses){var tracksLoaded=tracksResponses.reduce(function(tracks,tracksResponse){return tracks=tracks.concat(tracksResponse.tracks)},[]);tracksLoader.tracks=tracksLoader.tracks.concat(tracksLoaded),deferred.resolve({tracksLoader:tracksLoader,tracksLoaded:tracksLoaded})},function(err){console.error("Error while loading tracks.",err),deferred.reject(err)}).finally(function(){})}catch(e){console.error(e.message)}return deferred.promise}};return service}),angular.module("starter").service("Picture",function($cordovaCamera,$ionicActionSheet,$q,$rootScope,$translate,Dialog,SB){var service={isOpen:!1,sheetResolver:null,stack:[],takePicture:function(width,height,quality){if(service.isOpen)return $q.reject();if(void 0===Camera)return Dialog.alert("Error","Camera is not available.","OK",-1).then(function(){return $q.reject()}),$q.reject();service.isOpen=!0;var deferred=$q.defer(),localWidth=void 0===width?1200:width,localHeight=void 0===height?1200:height,localQuality=void 0===quality?90:quality,sourceType=Camera.PictureSourceType.CAMERA,_buttons=[{text:$translate.instant("Import from Library")}];return DEVICE_TYPE!==SB.DEVICE.TYPE_BROWSER&&_buttons.unshift({text:$translate.instant("Take a picture")}),service.sheetResolver=$ionicActionSheet.show({buttons:_buttons,cancelText:$translate.instant("Cancel"),cancel:function(){service.sheetResolver(),deferred.reject({message:$translate.instant("Cancelled")}),service.isOpen=!1},buttonClicked:function(index){0===index&&(sourceType=Camera.PictureSourceType.CAMERA),1===index&&(sourceType=Camera.PictureSourceType.PHOTOLIBRARY);var options={quality:localQuality,destinationType:Camera.DestinationType.DATA_URL,sourceType:sourceType,encodingType:Camera.EncodingType.JPEG,targetWidth:localWidth,targetHeight:localHeight,correctOrientation:!0,popoverOptions:CameraPopoverOptions,saveToPhotoAlbum:!1};if(DEVICE_TYPE===SB.DEVICE.TYPE_BROWSER){var input=angular.element('<input type="file" accept="image/*">'),selectedFile=function(selectEvent){var file=selectEvent.currentTarget.files[0],reader=new FileReader;reader.onload=function(onloadEvent){input.off("change",selectedFile),onloadEvent.target.result.length>0?(service.sheetResolver(),deferred.resolve({image:onloadEvent.target.result}),service.isOpen=!1):(service.sheetResolver(),service.isOpen=!1)},reader.onerror=function(){service.sheetResolver(),Dialog.alert("Error","An error occurred while loading the picture.","OK",-1).then(function(){service.isOpen=!1})},reader.readAsDataURL(file)};input.on("change",selectedFile),input[0].click()}else $cordovaCamera.getPicture(options).then(function(imageData){service.sheetResolver(),deferred.resolve({image:"data:image/jpeg;base64,"+imageData}),service.isOpen=!1},function(error){service.sheetResolver(),Dialog.alert("Error","An error occurred while taking a picture.","OK",-1).then(function(){service.isOpen=!1}),deferred.reject({message:error})}).catch(function(error){service.sheetResolver(),Dialog.alert("Error","An error occurred while taking a picture.","OK",-1).then(function(){service.isOpen=!1}),deferred.reject({message:error})});return!0}}),deferred.promise}};return service}),angular.module("starter").service("ProgressbarService",function($ocLazyLoad){var service={config:{trail:"#eee",bar_text:"#aaa"},progress_bar:null,init:function(config){return service.config=config,$ocLazyLoad.load("./dist/lazy/progressbar.min.js")},createCircle:function(container){service.progress_bar=new ProgressBar.Circle(container,{color:service.config.bar_text,strokeWidth:2.6,trailWidth:2,trailColor:service.config.trail,easing:"easeInOut",duration:1e3,text:{autoStyleContainer:!1},from:{color:service.config.bar_text,width:2.6},to:{color:service.config.bar_text,width:2.6},step:function(state,circle){circle.path.setAttribute("stroke",state.color),circle.path.setAttribute("stroke-width",state.width);var value=Math.round(100*circle.value());0===value?circle.setText(""):circle.setText(value)}})},updateProgress:function(progress){null!==service.progress_bar&&service.progress_bar.animate(progress)},remove:function(){null!==service.progress_bar&&(service.progress_bar.destroy(),service.progress_bar=null)}};return service}),angular.module("starter").service("PushService",function($cordovaLocalNotification,$location,$log,$q,$rootScope,$translate,$window,$session,Application,Dialog,LinkService,Pages,Push,SB){var service={push:null,isReady:null,isReadyPromise:null,settings:{android:{senderID:"01234567890",icon:"ic_icon",iconColor:"#0099C7"},ios:{clearBadge:!0,alert:!0,badge:!0,sound:!0},windows:{}},configure:function(senderID,iconColor){Push.device_type!==SB.DEVICE.TYPE_ANDROID||"01234567890"!==senderID&&""!==senderID?service.settings.android.senderID=senderID:($log.debug("Invalid senderId: "+senderID),service.settings.android.senderID=null),/^#[0-9A-F]{6}$/i.test(iconColor)?service.settings.android.iconColor=iconColor:$log.debug("Invalid iconColor: "+iconColor)},init:function(){$window.PushNotification&&(service.push=$window.PushNotification.init(service.settings))},register:function(){service.isReady=$q.defer(),service.isReadyPromise=service.isReady.promise,service.init(),service.push&&$rootScope.isNativeApp?(service.push.on("registration",function(data){$log.debug("device_token: "+data.registrationId),Push.device_token=data.registrationId,service.registerDevice(),service.isReady.resolve()}),service.onNotificationReceived(),service.push.on("error",function(error){$log.debug(error.message),service.isReady.reject()}),service.updateUnreadCount(),Application.loaded.then(function(){service.fetchMessagesOnStart(),$rootScope.$on(SB.EVENTS.PUSH.notificationReceived,function(event,data){var pushFeature=_.filter(Pages.getActivePages(),function(page){return"push_notification"===page.code});pushFeature.length>=1&&(Push.setValueId(pushFeature[0].value_id),Push.findAll(0,!0)),service.displayNotification(data)})})):($log.debug("Unable to initialize push service."),service.isReady.reject()),$rootScope.isNativeApp||(Application.loaded.then(function(){service.fetchMessagesOnStart()}),service.isReady.reject())},registerDevice:function(){switch(Push.device_type){case SB.DEVICE.TYPE_ANDROID:service.registerAndroid();break;case SB.DEVICE.TYPE_IOS:service.registerIos()}},registerAndroid:function(){var params={app_id:Application.app_id,app_name:Application.app_name,registration_id:btoa(Push.device_token)};Push.registerAndroidDevice(params)},registerIos:function(){cordova.getAppVersion.getVersionNumber().then(function(appVersion){var deviceName=null;try{deviceName=device.platform}catch(e){$log.debug(e.message)}var deviceModel=null;try{deviceModel=device.model}catch(e){$log.debug(e.message)}var deviceVersion=null;try{deviceVersion=device.version}catch(e){$log.debug(e.message)}var params={app_id:Application.app_id,app_name:Application.app_name,app_version:appVersion,device_token:Push.device_token,device_name:deviceName,device_model:deviceModel,device_version:deviceVersion,push_badge:"enabled",push_alert:"enabled",push_sound:"enabled"};Push.registerIosDevice(params)})},onNotificationReceived:function(){service.push.on("notification",function(data){$rootScope.$broadcast(SB.EVENTS.PUSH.notificationReceived,data),service.push.finish(function(){$log.debug("push finish success")},function(){$log.debug("push finish error")})})},updateUnreadCount:function(){Push.updateUnreadCount().then(function(data){Push.unread_count=data.unread_count,$rootScope.$broadcast(SB.EVENTS.PUSH.unreadPush)})},sendLocalNotification:function(messageId,title,message){$log.debug("-- Push-Service, sending a Local Notification --");var localMessage=angular.copy(message);Push.device_type===SB.DEVICE.TYPE_IOS&&(localMessage="");var params={id:messageId,title:title,text:localMessage};Push.device_type===SB.DEVICE.TYPE_ANDROID&&(params.icon="res://icon.png"),$cordovaLocalNotification.schedule(params),Push.markAsDisplayed(messageId)},fetchMessagesOnStart:function(){Push.getLastMessages(!1).then(function(data){var push=data.push_message;push&&service.displayNotification(push);var inappMessage=data.inapp_message;inappMessage&&(inappMessage.type="inapp",inappMessage.message=inappMessage.text,inappMessage.config={buttons:[{text:$translate.instant("OK"),type:"button-custom",onTap:function(){Push.markInAppAsRead()}}]},null!==inappMessage.cover&&void 0===inappMessage.additionalData&&(inappMessage.additionalData={cover:inappMessage.cover}),service.displayNotification(inappMessage))})},displayNotification:function(messagePayload){$log.debug("PUSH messagePayload",messagePayload),$session.getItem("pushMessageIds").then(function(pushMessageIds){var localPushMessageIds=pushMessageIds;null!==pushMessageIds&&Array.isArray(pushMessageIds)||(localPushMessageIds=[]);var messageId=parseInt(messagePayload.additionalData.message_id,10);if(-1===localPushMessageIds.indexOf(messageId)){localPushMessageIds.push(messageId),$session.setItem("pushMessageIds",localPushMessageIds);var extendedPayload=messagePayload.additionalData;if(void 0!==extendedPayload&&(extendedPayload.cover||extendedPayload.action_value)){var coverUri=extendedPayload.cover;try{0!==coverUri.indexOf("http")&&(coverUri=DOMAIN+extendedPayload.cover)}catch(e){}var isInAppMessage=void 0!==messagePayload.type&&"inapp"===messagePayload.type,config={buttons:[{text:$translate.instant("Cancel"),type:"button-custom",onTap:function(){isInAppMessage&&Push.markInAppAsRead()}},{text:$translate.instant("View"),type:"button-custom",onTap:function(){isInAppMessage&&Push.markInAppAsRead(),!0!==extendedPayload.open_webview&&"true"!==extendedPayload.open_webview?$location.path(extendedPayload.action_value):LinkService.openLink(extendedPayload.action_value)}}],cssClass:"push-popup",title:messagePayload.title,template:'<img src="#COVER_URI#" class="#KLASS#"><span>#MESSAGE#</span>'.replace("#COVER_URI#",coverUri).replace("#KLASS#",extendedPayload.cover?"":" ng-hide").replace("#MESSAGE#",messagePayload.message)};void 0!==messagePayload.config&&(config=angular.extend(config,messagePayload.config)),void 0!==extendedPayload.action_value&&""!==extendedPayload.action_value&&null!==extendedPayload.action_value||(config.buttons=[{text:$translate.instant("OK"),type:"button-custom",onTap:function(){}}]),$log.debug("Message payload (ionicPopup):",messagePayload,config),Dialog.ionicPopup(config)}else{var localTitle=void 0!==messagePayload.title?messagePayload.title:"Notification";$log.debug("Message payload (alert):",messagePayload),Dialog.alert(localTitle,messagePayload.message,"OK")}$rootScope.$broadcast(SB.EVENTS.PUSH.unreadPushs,messagePayload.count)}$log.debug("Will not display duplicated message: ",messagePayload)}).catch(function(err){$log.debug("We got an error with the localForage when trying to display push message: ",messagePayload),$log.debug(err)})}};return window.pushService=service,service}),angular.module("starter").service("$session",function($log,$pwaCache,$q,$window){$log.debug("Init once $session");var service={localstorage_key:"sb-auth-token",session_id:!1,device_uid:null,device_width:512,device_height:512,device_orientation:"portrait",is_loaded:!1,resolver:$q.defer()};return Object.defineProperty(service,"loaded",{get:function(){return service.is_loaded?$q.resolve():service.resolver.promise},set:function(value){service.is_loaded=!!value,!0===service.is_loaded&&service.resolver.resolve()}}),service.setId=function(sessionId){"undefined"!==sessionId&&void 0!==sessionId&&"null"!==sessionId&&null!==sessionId&&""!==sessionId?(service.session_id=sessionId,service.setItem(service.localstorage_key,sessionId),$window.localStorage.setItem("sb-auth-token",sessionId),service.setDeviceUid()):$log.error("Not saving invalid session_id: ",sessionId)},service.getId=function(){return"undefined"!==service.session_id&&void 0!==service.session_id&&"null"!==service.session_id&&null!==service.session_id&&""!==service.session_id&&service.session_id},service.setDeviceUid=function(){void 0===$window.device?service.device_uid="unknown_"+service.getId():"browser"===$window.device.platform?service.device_uid="browser_"+service.getId():service.device_uid=$window.device.uuid,'""'!==service.device_uid&&void 0!==service.device_uid||(service.device_uid="unknown_"+service.getId())},service.getDeviceUid=function(){return service.device_uid},service.clear=function(){service.session_id="",service.removeItem(service.localstorage_key)},service.setDeviceScreen=function(width,height){var orientation=$window.matchMedia("(orientation: portrait)").matches?"portrait":"landscape";return service.device_width=width,service.device_height=height,service.device_orientation=orientation,service.getDeviceScreen()},service.getDeviceScreen=function(){return{width:service.device_width,height:service.device_height,orientation:service.device_orientation}},service.setItem=function(key,value){return $pwaCache.getRegistryCache().setItem(key,value)},service.getItem=function(key){return $pwaCache.getRegistryCache().getItem(key)},service.removeItem=function(key){return $pwaCache.getRegistryCache().removeItem(key)},service.setDeviceScreen($window.innerWidth,$window.innerHeight),service.getItem(service.localstorage_key).then(function(value){var fallback=$window.localStorage.getItem("sb-auth-token");null!=value?($log.debug("Set once $session from pwaRegistry on start: ",value),service.setId(value)):null!=fallback&&($log.debug("Set once $session from fallback localstorage on start: ",fallback),service.setId(fallback)),null===service.device_uid&&service.setDeviceUid(),service.loaded=!0}),service}),angular.module("starter").service("SocialSharing",function($cordovaSocialSharing,$translate,$q,Application){var service={is_sharing:!1,share:function(content,message,subject,link,file){if(service.is_sharing)return $q.reject();service.is_sharing=!0,void 0===content&&(content="this");var download_app_link=DOMAIN+"/application/device/downloadapp/app_id/"+Application.app_id,generic_message=$translate.instant("Hi. I just found $1 in the $2 app.").replace("$1",content).replace("$2",Application.app_name);void 0!==message&&(message=$translate.instant(message).replace("$1",content).replace("$2",Application.app_name));var _link=void 0===link?download_app_link:link,_file=void 0===file?"":file,_message=void 0===message?generic_message:message,_subject=void 0===subject?"":subject,deferred=$q.defer();return $cordovaSocialSharing.share(_message,_subject,_file,_link).then(function(result){deferred.resolve(result),service.is_sharing=!1},function(error){deferred.reject(error),service.is_sharing=!1}),deferred.promise}};return service}),function(root,factory){"function"==typeof define&&define.amd?define([],function(){return factory()}):"object"==typeof exports?module.exports=factory():factory()}(0,function(){"use strict";return angular.module("tmh.dynamicLocale",[]).config(["$provide",function($provide){function makeStateful($delegate){return $delegate.$stateful=!0,$delegate}$provide.decorator("dateFilter",["$delegate",makeStateful]),$provide.decorator("numberFilter",["$delegate",makeStateful]),$provide.decorator("currencyFilter",["$delegate",makeStateful])}]).constant("tmhDynamicLocale.STORAGE_KEY","tmhDynamicLocale.locale").provider("tmhDynamicLocale",["tmhDynamicLocale.STORAGE_KEY",function(STORAGE_KEY){var defaultLocale,nodeToAppend,storage,activeLocale,localeLocationPattern="angular/i18n/angular-locale_{{locale}}.js",storageFactory="tmhDynamicLocaleStorageCache",storageKey=STORAGE_KEY,promiseCache={},extraProperties={};function loadLocale(localeUrl,$locale,localeId,$rootScope,$q,localeCache,$timeout){function overrideValues(oldObject,newObject){activeLocale===localeId&&(angular.forEach(oldObject,function(value,key){newObject[key]?angular.isArray(newObject[key])&&(oldObject[key].length=newObject[key].length):delete oldObject[key]}),angular.forEach(newObject,function(value,key){angular.isArray(newObject[key])||angular.isObject(newObject[key])?(oldObject[key]||(oldObject[key]=angular.isArray(newObject[key])?[]:{}),overrideValues(oldObject[key],newObject[key])):oldObject[key]=newObject[key]}))}if(promiseCache[localeId])return activeLocale=localeId,promiseCache[localeId];var cachedLocale,deferred=$q.defer();return localeId===activeLocale?deferred.resolve($locale):(cachedLocale=localeCache.get(localeId))?(activeLocale=localeId,$rootScope.$evalAsync(function(){overrideValues($locale,cachedLocale),storage.put(storageKey,localeId),$rootScope.$broadcast("$localeChangeSuccess",localeId,$locale),deferred.resolve($locale)})):(activeLocale=localeId,promiseCache[localeId]=deferred.promise,function(url,callback,errorCallback,$timeout){var script=document.createElement("script"),element=nodeToAppend||document.getElementsByTagName("body")[0],removed=!1;script.type="text/javascript",script.readyState?script.onreadystatechange=function(){"complete"!==script.readyState&&"loaded"!==script.readyState||(script.onreadystatechange=null,$timeout(function(){removed||(removed=!0,element.removeChild(script),callback())},30,!1))}:(script.onload=function(){removed||(removed=!0,element.removeChild(script),callback())},script.onerror=function(){removed||(removed=!0,element.removeChild(script),errorCallback())}),script.src=url,script.async=!0,element.appendChild(script)}(localeUrl,function(){var externalLocale=angular.injector(["ngLocale"]).get("$locale");overrideValues($locale,externalLocale),localeCache.put(localeId,externalLocale),delete promiseCache[localeId],$rootScope.$applyAsync(function(){storage.put(storageKey,localeId),$rootScope.$broadcast("$localeChangeSuccess",localeId,$locale),deferred.resolve($locale)})},function(){delete promiseCache[localeId],$rootScope.$applyAsync(function(){activeLocale===localeId&&(activeLocale=$locale.id),$rootScope.$broadcast("$localeChangeError",localeId),deferred.reject(localeId)})},$timeout)),deferred.promise}this.localeLocationPattern=function(value){return value?(localeLocationPattern=value,this):localeLocationPattern},this.appendScriptTo=function(nodeElement){nodeToAppend=nodeElement},this.useStorage=function(storageName){storageFactory=storageName},this.useCookieStorage=function(){this.useStorage("$cookieStore")},this.defaultLocale=function(value){defaultLocale=value},this.storageKey=function(value){return value?(storageKey=value,this):storageKey},this.addLocalePatternValue=function(key,value){extraProperties[key]=value},this.$get=["$rootScope","$injector","$interpolate","$locale","$q","tmhDynamicLocaleCache","$timeout",function($rootScope,$injector,interpolate,locale,$q,tmhDynamicLocaleCache,$timeout){var localeLocation=interpolate(localeLocationPattern);return storage=$injector.get(storageFactory),$rootScope.$evalAsync(function(){var initialLocale;(initialLocale=storage.get(storageKey)||defaultLocale)&&loadLocaleFn(initialLocale)}),{set:loadLocaleFn,get:function(){return activeLocale}};function loadLocaleFn(localeId){var baseProperties={locale:localeId,angularVersion:angular.version.full};return loadLocale(localeLocation(angular.extend({},extraProperties,baseProperties)),locale,localeId,$rootScope,$q,tmhDynamicLocaleCache,$timeout)}}]}]).provider("tmhDynamicLocaleCache",function(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("tmh.dynamicLocales")}]}).provider("tmhDynamicLocaleStorageCache",function(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("tmh.dynamicLocales.store")}]}).run(["tmhDynamicLocale",angular.noop]),"tmh.dynamicLocale"}),angular.module("starter").service("$translate",function($injector){var service={translations:[],extractBulk:[],instant:function(text,context){service.debugExtract(text,context);var translated=text;return void 0===context?(angular.isDefined(service.translations[text])&&(translated=service.translations[text]),translated):(angular.isDefined(service.translations._context[context])&&angular.isDefined(service.translations._context[context][text])?translated=service.translations._context[context][text]:angular.isDefined(service.translations[text])&&(translated=service.translations[text]),translated)},debugExtract:function(text,context){try{if(!0===window.extractI18n){if(void 0===context)return;var _t=btoa(text),_c=void 0===context?"":btoa(context);service.extractBulk.push({text:_t,context:_c})}}catch(e){}},debugPost:function(){$injector.get("$pwaRequest").post("/translation/extract/index",{data:service.extractBulk,cache:!1}).then(function(){service.extractBulk=[]})}};return window.debugPost=service.debugPost,service}),angular.module("starter").service("Url",function($location){this.__sanitize=function(str){return str.startsWith("/")&&(str=str.substr(1,str.length-1)),str};var _that=this;return{get:function(uri,params){angular.isDefined(params)||(params={});var add_language=params.add_language;delete params.add_language;var remove_key=params.remove_key;delete params.remove_key,uri=_that.__sanitize(uri);var url=DOMAIN.split("/");for(var i in add_language&&url.push(CURRENT_LANGUAGE),APP_KEY&&!remove_key&&url.push(APP_KEY),url.push(uri),params)angular.isDefined(params[i])&&(url.push(i),url.push(params[i]));return url=url.join("/")},build:function(uri,params){angular.isDefined(params)||(params={});var url=_that.__sanitize(uri),p=[];for(var i in params)angular.isDefined(params[i])&&p.push(i+"="+params[i]);return url=url+"?"+p.join("&")}}}),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(str){return this.substring(0,str.length)===str}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(str){return this.substring(this.length-str.length,this.length)===str}),angular.module("starter").service("YouTubeAutoPauser",function($ionicPlatform,$window){var iframes=[],players=[],initialized=!1,loaded=!1,service={};return service.register=function(iframe){var localIframe=angular.element(iframe)[0];loaded?players.push(new YT.Player(localIframe,{})):(initialized||function(){initialized=!0,$window.onYouTubeIframeAPIReady=function(){loaded=!0,players=players.concat(iframes.map(function(iframe){return new YT.Player(iframe,{})})),$ionicPlatform.on("pause",function(result){var filtered_players=[];players.forEach(function(item){angular.isObject(item)&&angular.isFunction(item.pauseVideo)&&angular.isObject(item.a)&&angular.isObject(item.a.parentElement)&&(item.pauseVideo(),filtered_players.push(item))}),players=filtered_players})};var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag)}(),iframes.push(localIframe))},service}),angular.module("starter").directive("datetime",function($ionicPlatform){return{restrict:"A",scope:{date:"="},link:function(scope,element){$ionicPlatform.is("android")&&element.bind("blur",function(){scope.date=this.value,scope.$parent.$apply()})}}}),angular.module("starter").directive("repeatDone",function(){return function(scope,element,attrs){scope.$last&&scope.$eval(attrs.repeatDone)}}),angular.module("starter").directive("sbAClick",function($filter,$rootScope,$timeout,$window,$state,LinkService,Customer){return{restrict:"A",scope:{},link:function(scope,element){$timeout(function(){var collection=angular.element(element).find("a");angular.forEach(collection,function(elem){if(void 0!==elem.attributes["data-state"]){var params=elem.attributes["data-params"].value;params=params.replace(/(^\?)/,"").split(",").map(function(n){return this[(n=n.split(":"))[0].trim()]=n[1],this}.bind({}))[0];var state=elem.attributes["data-state"].value,offline=void 0!==elem.attributes["data-offline"]&&"true"===elem.attributes["data-offline"].value;angular.element(elem).bind("click",function(e){e.preventDefault(),"my-account"===state?Customer.loginModal():!offline&&$rootScope.isOffline?$rootScope.onlineOnly():$state.go(state,params)})}else angular.element(elem).bind("click",function(e){e.preventDefault();LinkService.openLink(elem.href,{hide_navbar:!1,use_external_app:!1})})})})}}}),angular.module("starter").directive("sbAlbumsBoxes",function(){return{restrict:"A",templateUrl:"templates/media/music/l1/album/boxes.html",scope:{paged_albums:"=pagedAlbums",onAlbumSelected:"&"}}}),angular.module("starter").directive("sbAppLocked",function(){return{restrict:"E",replace:!0,scope:{},templateUrl:"templates/html/l1/app_locked.html",controller:function($ionicHistory){$ionicHistory.clearHistory()}}}),angular.module("starter").directive("sbCmsText",function(){return{restrict:"A",scope:{block:"="},template:'<div class="item item-text-wrap item-custom sb-cms-text">   <img width="{{block.size}}%" ng-src="{{ block.image_url }}" ng-if="block.image.length" class="{{ block.alignment }}" />   <div class="content" ng-bind-html="block.content | trusted_html" sb-a-click></div>   <div class="cb"></div></div>'}}).directive("sbCmsImage",function(){return{restrict:"A",scope:{block:"=",gallery:"="},template:'<div class="sb-cms-block-image">    <div class="item item-image-gallery item-custom">        <ion-scroll direction="y">           <ion-gallery ion-gallery-items="block.gallery"                         ng-if="!is_loading"></ion-gallery>       </ion-scroll>    </div>    <div ng-if="block.description"          class="item item-custom padding description">{{ block.description }}</div></div>'}}).directive("sbPlaceImage",function(){return{restrict:"A",scope:{block:"=",gallery:"="},template:'<div class="sb-place-block-image">    <div ng-if="block.description"          class="item item-custom padding description">{{ block.description }}</div>    <div class="item item-image-gallery item-custom">        <ion-scroll direction="y">           <ion-gallery ion-gallery-items="block.gallery"                         ng-if="!is_loading"></ion-gallery>       </ion-scroll>    </div></div>'}}).directive("sbCmsCover",function(){return{restrict:"A",scope:{block:"="},template:'<img width="100%" ng-src="{{ block.gallery[0].src }}" alt="{{block.name}}">'}}).directive("sbCmsSlider",function(){return{restrict:"A",scope:{block:"=",gallery:"="},template:'<div class="item item-image-gallery item-custom sb-cms-image">   <ul rn-carousel        rn-carousel-index="carouselIndex"        class="image">       <li ng-repeat="image in block.gallery">           <div sb-image                 image-src="image.src"                 ng-click="showFullscreen($index)"></div>       </li>   </ul>   <div rn-carousel-indicators         ng-if="block.gallery.length > 1"         slides="block.gallery"         rn-carousel-index="carouselIndex"></div></div><div ng-if="block.description"      ng-style="lineReturn"      class="item item-custom padding description">{{ block.description }}</div><script id="zoom-modal.html"         type="text/ng-template">   <div class="sb-cms-image modal fullscreen">       <ion-header-bar class="bar-dark">           <button class="button button-clear pull-right"                    ng-click="hideFullscreen()">{{ "Done" | translate }}           </button>       </ion-header-bar>       <ion-content>           <ul rn-carousel                rn-carousel-index="carouselIndexModal"                class="image"                id="zoomedImage">               <li ng-repeat="image in block.gallery">                   <ion-scroll delegate-handle="slide-{{ $index }}"                                overflow-scroll="false"                                direction="xy"                                zooming="true"                                ng-swipe-left="setCarouselIndex($index+1)"                                ng-swipe-right="setCarouselIndex($index-1)">                       <div class="image"                             sb-image                             image-src="image.src"></div>                   </ion-scroll>               </li>           </ul>           <div rn-carousel-indicators                 ng-if="block.gallery.length > 1"                 slides="block.gallery"                 rn-carousel-index="carouselIndexModal"></div>       </ion-content>   </div><\/script>',controller:function($ionicGesture,Modal,$ionicScrollDelegate,$scope){$scope.carouselIndex=0,$scope.is_fullscreen=!1,$scope.lineReturn={},1==$scope.block.allow_line_return&&($scope.lineReturn={"word-wrap":"normal","white-space":"normal"}),$scope.setCarouselIndex=function(index){var localIndex=index;localIndex<0?localIndex=0:localIndex>=$scope.block.gallery.length&&(localIndex-=1),$scope.carouselIndexModal=localIndex},$scope.showFullscreen=function(index){Modal.fromTemplateUrl("zoom-modal.html",{scope:$scope,animation:"block"}).then(function(modal){$scope.modal=modal,$scope.carouselIndexModal=index,$scope.modal.show(),$scope.modal.is_zoomed=!1,$scope.modal.scale_to_original_size=!1;var element=angular.element(document.getElementById("zoomedImage"));$scope.modal.release=$ionicGesture.on("release",function(){$scope.modal.scale_to_original_size&&($ionicScrollDelegate.$getByHandle("slide-"+$scope.carouselIndexModal).zoomTo(1,!0),$scope.modal.scale_to_original_size=!1)},element),$scope.modal.pinch=$ionicGesture.on("pinch",function(event,o,t,l){event.gesture.scale<1&&($scope.modal.scale_to_original_size=!0)},element),$scope.modal.doubleTap=$ionicGesture.on("doubletap",function(event){$scope.modal.is_zoomed?$ionicScrollDelegate.$getByHandle("slide-"+$scope.carouselIndexModal).zoomTo(1,!0):$ionicScrollDelegate.$getByHandle("slide-"+$scope.carouselIndexModal).zoomTo(3,!0,event.gesture.touches[0].pageX,event.gesture.touches[0].pageY),$scope.modal.is_zoomed=!$scope.modal.is_zoomed},element)})},$scope.hideFullscreen=function(){$scope.carouselIndex=$scope.carouselIndexModal,$scope.modal.remove()}}}}).directive("sbCmsVideo",function(){return{restrict:"A",scope:{block:"="},template:'<div class="cms_block">   <div sb-video video="block"></div></div>'}}).directive("sbCmsAddress",function(){return{restrict:"A",scope:{block:"=",onShowMap:"&",onAddToContact:"&"},template:'<div class="sb-cms-block-address">   <div class="item item-text-wrap item-icon-left item-custom sb-cms-block-address-locate"         ng-if="block.show_address || block.show_geolocation_button"         ng-click="openIntent()">       <i class="icon ion-sb-turn-right"></i>       <h2 class="sb-cms-address-label"            ng-if="block.label">{{ block.label}}</h2>       <p class="sb-cms-address-address"           ng-if="block.address">{{ block.address }}</p>   </div>   <div class="item item-text-wrap item-icon-left item-custom sb-cms-block-address-phone"         ng-if="block.phone.length && block.show_phone">       <i class="icon ion-android-call"></i>       <p>           <a href="tel:{{ block.phone }}">{{ block.phone }}</a>       </p>   </div>   <div class="item item-text-wrap item-icon-left item-custom sb-cms-block-address-website"         ng-if="block.website.length && block.show_website">       <i class="icon ion-earth"></i>       <p>           <a ng-click="openWebsite(block.website)">{{ block._label }}</a>       </p>   </div></div>',link:function(scope){scope.$watch("block",function(){scope.block._label=scope.block.website.replace(/^https?:\/\//i,"").replace(/\/$/,"").replace(/(\?.*)$/,"").replace(/(\#.*)$/,"")})},controller:function(Location,Loader,LinkService,$rootScope,$scope,$timeout){$scope.showMap=function(){$rootScope.isNotAvailableInOverview()||$rootScope.isNotAvailableOffline()||(Loader.show(),Location.getLocation().then(function(position){$scope.getItineraryLink(position.coords,$scope.block)},function(){$scope.getItineraryLink({latitude:null,longitude:null},$scope.block)}).then(function(){Loader.hide()}))},$scope.openIntent=function(){$scope.itinerary_link?$scope.itinerary_link&&$scope.openItinary():$scope.showMap()},$scope.openItinary=function(){LinkService.openLink($scope.itinerary_link,{use_external_app:!0})},$scope.openWebsite=function(url){LinkService.openLink(url,{use_external_app:!0})},$scope.addToContact=function(){$scope.onAddToContact&&angular.isFunction($scope.onAddToContact)&&$scope.onAddToContact($scope.block)},$scope.getItineraryLink=function(point1,point2){var link="https://www.google.com/maps/dir/";point1.latitude&&(link=link+(point1.latitude+",")+point1.longitude),point2.latitude&&(link=link+"/"+point2.latitude+","+point2.longitude),LinkService.openLink(link,{use_external_app:!0})}}}}).directive("sbCmsButton",function(){return{restrict:"A",scope:{block:"="},template:'<a href="{{ url }}" target="{{ target }}" class="item item-text-wrap item-icon-left item-custom">   <i class="icon" ng-class="icon" ng-if="show_icon"></i>   <i class="icon flex-button-icon" ng-if="!show_icon">       <img ng-src="{{ icon_src }}" style="width: 32px; height: 32px;" />   </i>   {{ label | translate }}</a>',controller:function($scope,LinkService){$scope.openLink=function(){LinkService.openLink($scope.block.content,{hide_navbar:"1"===$scope.block.hide_navbar,use_external_app:"1"===$scope.block.use_external_app})}},link:function(scope,element){var a=angular.element(element).find("a");switch(scope.block.type_id){case"phone":scope.icon="ion-ios-telephone-outline",scope.label=null!==scope.block.label&&scope.block.label.length>0?scope.block.label:"Phone",scope.block.content.startsWith("tel:")||(scope.block.content="tel:"+scope.block.content),scope.url=scope.block.content,scope.target="_self";break;case"link":scope.icon="ion-ios-world-outline",scope.label=null!==scope.block.label&&scope.block.label.length>0?scope.block.label:"Website",a.on("click",function(e){return e.preventDefault(),scope.openLink(),!1}),scope.$on("$destroy",function(){a.off("click")});break;case"email":scope.block.content.startsWith("mailto:")||(scope.block.content="mailto:"+scope.block.content),scope.icon="ion-ios-email",scope.label=null!==scope.block.label&&scope.block.label.length>0?scope.block.label:"Email",scope.url=scope.block.content,scope.target="_self",scope.$on("$destroy",function(){a.off("click")})}scope.show_icon=!0,scope.block.icon.length&&(scope.show_icon=!1,scope.icon_src=scope.block.icon)}}}).directive("sbCmsFile",function(){return{restrict:"A",scope:{block:"="},template:'<div class="item item-text-wrap item-icon-left item-custom" ng-click="openFile()">   <i class="icon ion-paperclip"></i>   {{ block.display_name }}</div>',controller:function($scope,LinkService){$scope.openFile=function(){LinkService.openLink($scope.block.file_url,{use_external_app:"true"})}}}}),angular.module("starter").directive("sbDatetimePicker",function(DatetimePicker){return{restrict:"A",scope:{format:"=?",headers:"=?",model:"=?",title:"=?"},link:function(scope,element){DatetimePicker.isLoaded().then(function(){var options=angular.extend({},DatetimePicker.defaults,{headers:scope.headers||!0,format:scope.format||"YYYY-MM-DD HH:mm",pick:function(e){scope.model=scope.pickerInstance.getDate(!0),scope.$apply()}});void 0!==scope.title&&(options.text.title=scope.title),scope.pickerInstance=new Picker(element[0],options)})}}}),EventToDirective(angular.module("starter"),"sbError","error"),EventToDirective(angular.module("starter"),"sbLoad","load"),angular.module("starter").directive("sbGoogleAutocomplete",function(GoogleMaps,$timeout){return{scope:{location:"=?",address:"=?",place:"=?",options:"=?",onAddressChange:"&?"},require:"?ngModel",link:function(scope,element,attrs,ngModel){var options=angular.extend({types:[]},scope.options);element.on("keydown",function(e){13===e.which&&""===_.get(document.getElementsByClassName("pac-container"),"[0].style.display")&&e.preventDefault()}),GoogleMaps.addCallback(function(){scope.googleAutocomplete=new google.maps.places.Autocomplete(element[0],options),google.maps.event.addListener(scope.googleAutocomplete,"place_changed",function(data){var place=scope.googleAutocomplete.getPlace();scope.place=place,place.geometry&&(angular.isObject(scope.location)||(scope.location={}),scope.location.latitude=place.geometry.location.lat(),scope.location.longitude=place.geometry.location.lng());var val=element.val();angular.isObject(ngModel)&&angular.isFunction(ngModel.$setViewValue)&&ngModel.$setViewValue(val,"keyup"),$timeout(function(){scope.location.address=val,scope.onAddressChange(scope),console.log("address changed ...... fuck")})})})}}}),angular.module("starter").directive("sbImage",function($timeout){return{restrict:"A",scope:{image_src:"=imageSrc"},template:'<div class="image_loader relative scale-fade" ng-hide="is_hidden"><span class="loader block"></span></div>',link:function(scope,element){scope.setBackgroundImageStyle=function(){$timeout(function(){element.css("background-image","url("+img.src+")"),scope.is_hidden=!0})};var img=new Image;img.src=scope.image_src,img.onload=function(){scope.setBackgroundImageStyle()},img.onerror=function(){scope.setBackgroundImageStyle()},img.complete&&scope.setBackgroundImageStyle()},controller:function($scope){$scope.is_hidden=!1}}}),angular.module("starter").directive("sbInputNumber",function($timeout){return{restrict:"E",scope:{changeQty:"&",step:"=?",min:"=?",max:"=?",value:"=?",params:"=?"},template:'<div class="item item-input item-custom input-number-sb">   <div class="input-label"><i class="ion-plus"></i> {{ label }}</div>   <div class="input-container text-right">       <button class="button button-small button-custom button-left"                ng-click="down()">-</button>       <div class="item-input-wrapper">           <input type="text"                   value="{{ dirValue }}"                   class="text-center input"                   readonly />       </div>       <button class="button button-small button-custom button-right"                ng-click="up()">+</button>   </div></div>',replace:!0,link:function(scope,element,attrs){scope.step=scope.step?scope.step:1,scope.min=scope.min?scope.min:0,scope.max=scope.max?scope.max:999,scope.value=scope.value?angular.copy(scope.value):0,scope.dirValue=scope.value,scope.params=scope.params?scope.params:{},scope.label=attrs.label?attrs.label+":":"",scope.$watch("params",function(){scope.params=scope.params?scope.params:{}}),scope.$watch("value",function(){scope.value=scope.value?angular.copy(scope.value):0})},controller:function($scope){$scope.up=function(){$scope.dirValue<$scope.max&&($scope.dirValue=$scope.dirValue+1,$scope.callBack($scope.dirValue))},$scope.down=function(){$scope.dirValue>$scope.min&&($scope.dirValue=$scope.dirValue-1,$scope.callBack($scope.dirValue))},$scope.callBack=function(value){"function"==typeof $scope.changeQty&&$timeout(function(){$scope.changeQty({qty:value,params:$scope.params})},500)}}}}),angular.module("starter").directive("sbMaps",function(){return{restrict:"A",scope:{map:"=",config:"="},controller:function($scope,GoogleMaps){GoogleMaps.addCallback(function(){if($scope.map=GoogleMaps.createMap("google-maps"),$scope.config.coordinates){if(!($scope.config.coordinates.origin&&($scope.config.coordinates.origin.latitude&&$scope.config.coordinates.origin.longitude||$scope.config.coordinates.origin.address)))return void console.error("An origin (latitude / longitude or address) is required to use Maps");if(!($scope.config.coordinates.destination&&($scope.config.coordinates.destination.latitude&&$scope.config.coordinates.destination.longitude||$scope.config.coordinates.destination.address)))return void console.error("A destination (latitude / longitude or address) is required to use Maps");GoogleMaps.calculateRoute($scope.config.coordinates.origin,$scope.config.coordinates.destination).then(function(route){GoogleMaps.addRoute(route)})}if($scope.config.markers&&$scope.config.markers.constructor===Array){for(var i=0;i<$scope.config.markers.length;i++){var marker=$scope.config.markers[i];GoogleMaps.addMarker(marker)}if(void 0!==$scope.config.cluster&&GoogleMaps.addCluster(),$scope.config.bounds_to_marker){var bounds=GoogleMaps.getBoundsFromPoints($scope.config.markers);GoogleMaps.fitToBounds(bounds)}}})}}}),angular.module("starter").directive("sbMediaPlayerControls",function(){return{restrict:"A",controller:function($scope,$state,$timeout,$filter,MediaPlayer){angular.extend($scope,{player:MediaPlayer}),MediaPlayer.createModal($scope),$scope.openPlayer=function(){MediaPlayer.openPlayer()},$scope.duration=function(){return $scope.player&&$scope.player.media&&$scope.player.media.duration?$filter("seconds_to_minutes")($scope.player.media.duration):"0:00"},$scope.playPause=function(){MediaPlayer.playPause()},$scope.prev=function(){MediaPlayer.is_minimized||MediaPlayer.loading(),MediaPlayer.prev()},$scope.next=function(){MediaPlayer.is_minimized||MediaPlayer.loading(),MediaPlayer.next()},$scope.willSeek=function(){MediaPlayer.willSeek()},$scope.seekTo=function(position){MediaPlayer.seekTo(position)},$scope.backward=function(){MediaPlayer.backward()},$scope.forward=function(){MediaPlayer.forward()},$scope.repeat=function(){MediaPlayer.repeat()},$scope.shuffle=function(){MediaPlayer.shuffle()},$scope.openPlaylist=function(){MediaPlayer.openPlaylist()},$scope.goBackMedia=function(){MediaPlayer.goBack(MediaPlayer.is_radio,!0)},$scope.closePlaylist=function(){MediaPlayer.closePlaylist()},$scope.destroy=function(origin){MediaPlayer.destroy(),"player"===origin&&MediaPlayer.goBack(MediaPlayer.is_radio,!0)},$scope.selectTrack=function(index){MediaPlayer.closePlaylist(),$timeout(function(){MediaPlayer.loading(),MediaPlayer.current_index=index,MediaPlayer.pre_start(),MediaPlayer.start()},500)}}}}),angular.module("starter").directive("miniElapsed",function($interval,$filter,$timeout){return{restrict:"E",replace:!0,template:'<span class="mini-elapsed">{{ elapsedTime }}</span>',scope:{seconds:"=elapsedTime"},link:function(scope,element){scope.elapsedTime=$filter("seconds_to_minutes")(scope.seconds);var stopTime=$interval(function(){$timeout(function(){scope.elapsedTime=$filter("seconds_to_minutes")(scope.seconds)},0)},1e3);element.on("$destroy",function(){$interval.cancel(stopTime)})}}}),angular.module("starter").directive("sbMediaMiniPlayer",function(){return{restrict:"E",templateUrl:"templates/media/music/l1/player/mini.html"}}),angular.module("starter").directive("sbNavView",function($rootScope,SB){return{restrict:"E",replace:!0,template:"<ion-nav-view></ion-nav-view>",link:function(scope,element){$rootScope.$on(SB.EVENTS.MEDIA_PLAYER.SHOW,function(event,args){element.addClass("has-mini-player-controls"),args.isRadio?element.addClass("mini-radio"):element.addClass("mini-audio")}),$rootScope.$on(SB.EVENTS.MEDIA_PLAYER.HIDE,function(){element.removeClass("has-mini-player-controls"),element.removeClass("mini-radio"),element.removeClass("mini-audio")})}}}),angular.module("starter").directive("miniPlayer",function($rootScope,SB){return{restrict:"A",link:function(scope,element){$rootScope.$on(SB.EVENTS.MEDIA_PLAYER.SHOW,function(event,args){element.addClass("has-mini-player-controls"),args.isRadio?element.addClass("mini-radio"):element.addClass("mini-audio")}),$rootScope.$on(SB.EVENTS.MEDIA_PLAYER.HIDE,function(){element.removeClass("has-mini-player-controls"),element.removeClass("mini-radio"),element.removeClass("mini-audio")})}}}),angular.module("starter").directive("sbPad",function(){return{restrict:"E",scope:{card:"="},controller:function($scope,Modal){Modal.fromTemplateUrl("templates/loyaltycard/l1/pad.html",{scope:$scope}).then(function(modal){$scope.modal=modal}),$scope.openPad=function(){$scope.modal.show()},$scope.closeModal=function(){$scope.modal.hide()}}}}),angular.module("starter").directive("sbPadlock",function(Application){return{restrict:"A",controller:function($cordovaBarcodeScanner,$ionicHistory,Modal,$rootScope,$scope,$state,$stateParams,$timeout,$translate,$window,Application,Customer,Dialog,Padlock,SB){$scope.is_webview=Application.is_webview,Application.is_locked&&$ionicHistory.clearHistory(),$rootScope.$on(SB.EVENTS.AUTH.loginSuccess,function(){$scope.is_logged_in=!0}),$rootScope.$on(SB.EVENTS.AUTH.logoutSuccess,function(){$scope.is_logged_in=!1}),$scope.is_logged_in=Customer.isLoggedIn(),$scope.value_id=Padlock.value_id=$stateParams.value_id,Padlock.findUnlockTypes().then(function(data){$scope.unlock_by_account_type=data.unlock_by_account,$scope.unlock_by_qrcode_type=data.unlock_by_qrcode}),$scope.padlock_login=function(){Customer.display_account_form=!1,Customer.loginModal($scope,function(){$rootScope.$broadcast(SB.EVENTS.PADLOCK.unlockFeatures),Application.is_locked?($ionicHistory.clearHistory(),$state.go("home")):$ionicHistory.goBack()})},$scope.padlock_signup=function(){Customer.display_account_form=!0,Customer.loginModal($scope)},$scope.padlock_logout=function(){$scope.is_loading=!0,Customer.logout().then(function(){$scope.is_loading=!1})},$scope.openScanCamera=function(){$scope.scan_protocols=["sendback:"],$cordovaBarcodeScanner.scan().then(function(barcodeData){barcodeData.cancelled||""===barcodeData.text||$timeout(function(){for(var i=0;i<$scope.scan_protocols.length;i++)if(0==barcodeData.text.toLowerCase().indexOf($scope.scan_protocols[i])){$scope.is_loading=!0;var qrcode=barcodeData.text.replace($scope.scan_protocols[i],"");Padlock.unlockByQRCode(qrcode).then(function(){Padlock.unlocked_by_qrcode=!0,$scope.is_loading=!1,$window.localStorage.setItem("sb-uc",qrcode),$rootScope.$broadcast(SB.EVENTS.PADLOCK.unlockFeatures),Application.is_locked?($ionicHistory.clearHistory(),$state.go("home")):$ionicHistory.goBack()},function(data){var message_text=$translate.instant("An error occurred while reading the code.");angular.isObject(data)&&(message_text=data.message),Dialog.alert("Error",message_text,"OK",-1)}).then(function(){$scope.is_loading=!1});break}})},function(error){Dialog.alert("Error","An error occurred while reading the code.","OK",-1)})}}}}),angular.module("starter").directive("sbPageBackground",function($rootScope,$state,$stateParams,$pwaRequest,$session,$timeout,$window,Application){var init=!1,isUpdating=!1,deviceScreen=$session.getDeviceScreen(),deffered=$pwaRequest.defer(),backgroundImages=deffered.promise,catched=!1,orientationChange=$window.matchMedia("(orientation: portrait)");return $session.loaded.then(function(){var loadBackgrounds=function(refresh){$pwaRequest.get("front/assets/backgroundimages",{urlParams:{device_width:deviceScreen.width,device_height:deviceScreen.height},refresh:refresh}).then(function(data){deffered.resolve(data)}).catch(function(){catched||(catched=!0,$timeout(loadBackgrounds(!1),1))})};loadBackgrounds(!0)}),{restrict:"A",controller:function($scope){$scope.valueId="home"===$state.current.name?"home":$stateParams.value_id},link:function(scope,element){var networkDone=!1;scope.setBackgroundImageStyle=function(src,color){if(!isUpdating){isUpdating=!0;var el=angular.element(element);el.addClass("has-background-image"),void 0!==color?el.css({"background-image":"linear-gradient("+color+", "+color+"), url('"+src+"')"}):el.css({"background-image":"url('"+src+"')"}),$timeout(function(){void 0!==navigator.splashscreen&&navigator.splashscreen.hide()},20)}isUpdating=!1},Application.ready.then(function(){networkDone||scope.setBackgroundImageStyle(Application.default_background)});var updateBackground=function(){"tabbar_account"===angular.element(element).attr("code")&&(scope.valueId="account"),backgroundImages.then(function(data){Application.ready.then(function(){networkDone=!0;var valueId=angular.copy(scope.valueId);"landscape"===deviceScreen.orientation&&(valueId="landscape_"+valueId);var exists=angular.isDefined(valueId)&&angular.isDefined(data.backgrounds)&&angular.isDefined(data.backgrounds[valueId]),fallback=(Application.homepage_background||"home"===valueId||"landscape_home"===valueId)&&angular.isDefined(data.backgrounds)&&angular.isDefined(data.backgrounds.home);if(exists||fallback){var backgroundImage=data.backgrounds[valueId];window.tmpImg=new Image,window.tmpImg.src=backgroundImage,window.tmpImg.onload=function(){scope.setBackgroundImageStyle(backgroundImage)},(window.tmpImg.complete||$rootScope.isOffline)&&scope.setBackgroundImageStyle(backgroundImage),delete window.tmpImg}else scope.setBackgroundImageStyle("./img/placeholder/white-1.png",Application.colors.background.rgba);$timeout(function(){void 0!==navigator.splashscreen&&navigator.splashscreen.hide()},20)})})};init||($rootScope.$on("$stateChangeStart",function(evt,toState,toParams){scope.valueId="home"===toState.name?"home":toParams.value_id,updateBackground()}),orientationChange.addListener(function(){deviceScreen=$session.setDeviceScreen(),updateBackground()}),init=!0),scope.valueId="home"===$state.current.name?"home":$stateParams.value_id,updateBackground()}}}),angular.module("starter").directive("sbSideMenu",function($rootElement,$rootScope,$ionicHistory,$translate,$timeout,HomepageLayout,ContextualMenu,Application){return{restrict:"E",replace:!0,scope:{},templateUrl:"templates/page/side-menu.html",link:function(scope,element){HomepageLayout.getFeatures().then(function(features){scope.layout=HomepageLayout.properties,scope.layout_id=HomepageLayout.properties.layoutId,angular.element($rootElement).addClass(("layout-"+scope.layout_id).replace(/[^a-zA-Z0-9_\-]+/,"-").replace(".","-").replace(/\-\-*/,"-"))}),scope.goBack=function(){$ionicHistory.goBack()},scope.checkForUpdate=function(){$rootScope.checkForUpdate()},scope.showLeft=function(){return scope.layout_id&&"left"===scope.layout.menu.position},scope.showRight=function(){return scope.layout_id&&"right"===scope.layout.menu.position},scope.showBottom=function(){return scope.layout_id&&"bottom"===scope.layout.menu.position&&"homepage"===scope.layout.menu.visibility},scope.showAlways=function(){return scope.layout_id&&"bottom"===scope.layout.menu.position&&"always"===scope.layout.menu.visibility},scope.contextualMenuSideWidth=function(){return ContextualMenu.width},scope.contextualMenuIsEnabled=function(){return ContextualMenu.isEnabled},scope.contextualMenuExists=function(){return ContextualMenu.exists},scope.contextualMenu=function(){return ContextualMenu.templateURL}}}}),angular.module("starter").directive("sbTabbar",function($pwaRequest,$ionicHistory,Modal,$ionicSlideBoxDelegate,$ionicSideMenuDelegate,$location,$rootScope,$session,$timeout,$translate,$window,$ionicPlatform,Analytics,Application,Customer,Dialog,HomepageLayout,LinkService,Pages,Url,SB){return{restrict:"A",templateUrl:function(){return HomepageLayout.getTemplate()},scope:{},link:function($scope,element,attrs){$scope.tabbar_is_visible=Pages.is_loaded,$scope.tabbar_is_transparent=HomepageLayout.properties.tabbar_is_transparent,$scope.animate_tabbar=!$scope.tabbar_is_visible,$scope.pages_list_is_visible=!1,$scope.active_page=0,$scope.card_design=!1,$scope.layout=HomepageLayout,$scope.loadContent=function(){HomepageLayout.getOptions().then(function(options){$scope.options=options}),HomepageLayout.getData().then(function(data){$scope.data=data,$scope.push_badge=data.push_badge}),HomepageLayout.getFeatures().then(function(features){if($scope.features=features,$timeout(function(){Pages.is_loaded||(Pages.is_loaded=!0,$scope.tabbar_is_visible=!0)},500),!0===$rootScope.loginFeature)!0===$rootScope.loginFeatureBack?$ionicHistory.goBack():$rootScope.loginFeatureBack=!1,$rootScope.loginFeature=null;else if(!Application.is_customizing_colors&&HomepageLayout.properties.options.autoSelectFirst&&!1!==features.first_option){for(var feat_index=0,fi=0;fi<features.options.length;fi+=1){var feat=features.options[fi];if("code_scan"!==feat.code&&"radio"!==feat.code&&"padlock"!==feat.code){feat_index=fi;break}}features.options[feat_index].path!==$location.path()&&($ionicHistory.nextViewOptions({historyRoot:!0,disableAnimate:!1}),$location.path(features.options[feat_index].path).replace())}})},$scope.closeList=function(){$scope.tabbar_is_visible=!0,$scope.pages_list_is_visible=!1},$scope.gotoPage=function(index){$ionicSlideBoxDelegate.$getByHandle("slideBoxLayout").slide(index)},$scope.closePreviewer=function(){$window.location="app:closeApplication"},$scope.login=function($scope){$rootScope.loginFeature=null,Customer.loginModal($scope)},$scope.loadContent(),$rootScope.isOverview&&$scope.$on("tabbarStatesChanged",function(){$scope.loadContent()}),$rootScope.$on(SB.EVENTS.CACHE.layoutReload,function(){$scope.loadContent()}),$rootScope.$on(SB.EVENTS.PUSH.unreadPushs,function(event,args){$timeout(function(){$scope.push_badge=args})}),$rootScope.$on(SB.EVENTS.PUSH.readPushs,function(){$scope.push_badge=0});var rebuildOptions=function(){$timeout(function(){HomepageLayout.setNeedToBuildTheOptions(!0),$scope.loadContent()})};$rootScope.$on(SB.EVENTS.AUTH.logoutSuccess,function(){rebuildOptions()}),$rootScope.$on(SB.EVENTS.AUTH.loginSuccess,function(){rebuildOptions()}),$rootScope.$on(SB.EVENTS.PADLOCK.unlockFeatures,function(){rebuildOptions()}),$rootScope.$on(SB.EVENTS.CACHE.pagesReload,function(){rebuildOptions()}),Application.loaded.then(function(){rebuildOptions()}),$rootScope.isOverview&&($window.changeIcon=function(id,url){angular.forEach($scope.features.options,function(option){option.id==id&&$timeout(function(){option.icon_url=url})})})}}}),angular.module("starter").directive("tabbarItems",function($rootScope,$timeout,$log,HomepageLayout){return{restrict:"A",scope:{option:"="},link:function(scope,element){element.on("click",function(){$rootScope.$broadcast("OPTION_POSITION",scope.option.position),$timeout(function(){HomepageLayout.openFeature(scope.option,scope)})})}}}),angular.module("starter").directive("sbTooltip",function(){return{restrict:"A",scope:{},replace:!1,bindToController:{show_tooltip:"=showTooltip",collection:"=",current_item:"=currentItem",button_label:"=buttonLabel",button_icon:"=buttonIcon",onItemClicked:"&"},controllerAs:"tooltip",template:'<button class="button button-clear"         ng-click="toggleTooltip()">{{ tooltip.button_label | translate }}   <i ng-if="tooltip.button_icon"      ng-class="tooltip.button_icon"></i></button><div class="tooltip tooltip-custom"      ng-show="tooltip.collection.length && tooltip.show_tooltip">    <i class="icon ion-arrow-up-b dark"></i>    <div style="overflow-y: scroll; overflow-x: hidden; max-height: 250px;">        <ul>            <li ng-repeat="item in tooltip.collection">                <span class="block"                       ng-click="itemClicked(item);"                       ng-class="{ \'active\': tooltip.current_item.id == item.id }">{{ item.name | translate }}</span>                <ul ng-show="item.show_children">                    <li ng-repeat="child in item.children">                        <span class="block"                               ng-click="itemClicked(child)"                               ng-class="{ \'active\': tooltip.current_item.id == child.id }">{{ child.name | translate }}</span>                    </li>                </ul>            </li>        </ul>    </div></div>',controller:function($scope){var tooltip=this;$scope.toggleTooltip=function(){tooltip.show_tooltip=!tooltip.show_tooltip},$scope.itemClicked=function(item){item.children||(tooltip.show_tooltip=!1),tooltip.onItemClicked({object:item})}}}}),angular.module("starter").directive("sbVideo",function($timeout,$window,YouTubeAutoPauser){return{restrict:"A",replace:!0,scope:{video:"="},template:'<div class="card"><div class="item item-image" ng-click="play()"><div ng-hide="use_iframe || use_video_element" ng-style="height_style"><img ng-src="{{ video.cover_url }}" /><div class="sprite"></div></div><div ng-if="use_iframe"><iframe type="text/html" width="100%" height="200" src="" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div><div ng-if="use_video_element"><div id="video_player_view" class="player"><video src="" type="video/mp4" controls preload="none" width="100%" height="200px"></video></div></div></div><div ng-if="video.title" class="item item-text-wrap item-custom"><p>{{ video.title }}</p></div></div>',link:function(scope,element){scope.height_style=null,scope.video.cover_url||(scope.height_style={"min-height":"200px",width:"100%"}),scope.play=function(){"Android"==device.platform&&parseInt(device.version.substr(0,1))<5?$window.open(scope.video.url,"_system"):/^https?:\/\/(www.|player.)?(youtube|vimeo)\./.test(scope.video.url)?(scope.use_iframe=!0,$timeout(function(){var iframe=element.find("iframe");iframe.attr("src",scope.video.url_embed+"?autoplay=1&autopause=1&enablejsapi=1"),YouTubeAutoPauser.register(iframe)})):(scope.use_video_element=!0,$timeout(function(){element.find("video").attr("src",scope.video.url_embed)}))}},controller:function($scope){$scope.use_iframe=!1,$scope.use_video_element=!1}}});var slidingTabsDirective=angular.module("ionic").directive("ionSlideTabs",["$timeout","$compile","$interval","$ionicSlideBoxDelegate","$ionicScrollDelegate","$ionicGesture",function($timeout,$compile,$interval,$ionicSlideBoxDelegate,$ionicScrollDelegate,$ionicGesture){return{require:"^ionSlideBox",restrict:"A",link:function(scope,element,attrs,parent){var ionicSlideBoxDelegate,ionicScrollDelegate,ionicScrollDelegateID,slideTabs,indicator,slider,tabsBar,options={slideTabsScrollable:!0},addEvents=function(){ionic.onGesture("dragleft",scope.onSlideMove,slider[0]),ionic.onGesture("dragright",scope.onSlideMove,slider[0]),ionic.onGesture("release",scope.onSlideChange,slider[0])},setTabBarWidth=function(){if(!angular.isDefined(slideTabs)||0==slideTabs.length)return!1;tabsList=tabsBar.find("ul");var tabsWidth=0;angular.forEach(slideTabs,function(currentElement,index){var currentLi=angular.element(currentElement);tabsWidth+=currentLi[0].offsetWidth}),options.slideTabsScrollable?angular.element(tabsBar[0].querySelector(".scroll")).css("width",tabsWidth+1+"px"):slideTabs.css("width",tabsList[0].offsetWidth/slideTabs.length+"px"),slideToCurrentPosition()},slideToCurrentPosition=function(){if(!angular.isDefined(slideTabs)||0==slideTabs.length)return!1;var targetSlideIndex=ionicSlideBoxDelegate.currentIndex(),targetTab=angular.element(slideTabs[targetSlideIndex]),targetLeftOffset=targetTab.prop("offsetLeft"),targetWidth=targetTab[0].offsetWidth;if(indicator.css({"-webkit-transition-duration":"300ms","-webkit-transform":"translate("+targetLeftOffset+"px,0px)",width:targetWidth+"px"}),options.slideTabsScrollable&&ionicScrollDelegate){ionicScrollDelegate.scrollTo(targetLeftOffset-40,0,!0)}slideTabs.removeClass("tab-active"),targetTab.addClass("tab-active")};scope.onTabTabbed=function(event,index){!function(event,currentElement){var ink=angular.element(currentElement[0].querySelector(".ink"));angular.isDefined(ink)&&0!=ink.length||(ink=angular.element("<span class='ink'></span>"),currentElement.prepend(ink)),ink.removeClass("animate"),ink.offsetHeight||ink.offsetWidth||(d=Math.max(currentElement[0].offsetWidth,currentElement[0].offsetHeight),ink.css("height",d+"px"),ink.css("width",d+"px")),x=event.offsetX-ink[0].offsetWidth/2,y=event.offsetY-ink[0].offsetHeight/2,ink.css("top",y+"px"),ink.css("left",x+"px"),ink.addClass("animate")}(event,angular.element(event.currentTarget)),ionicSlideBoxDelegate.slide(index),slideToCurrentPosition()},scope.tabs=[],scope.addTabContent=function($content){scope.tabs.push($content),scope.$apply(),$timeout(function(){slideTabs=angular.element(tabsBar[0].querySelector("ul").querySelectorAll(".slider-slide-tab")),slideToCurrentPosition(),setTabBarWidth()})},scope.onSlideChange=function(slideIndex){slideToCurrentPosition()},scope.onSlideMove=function(){var scrollDiv=slider[0].getElementsByClassName("slider-slide"),currentSlideIndex=ionicSlideBoxDelegate.currentIndex(),currentSlideLeftOffset=angular.element(scrollDiv[currentSlideIndex]).css("-webkit-transform").replace(/[^0-9\-.,]/g,"").split(",")[0],targetSlideIndex=(currentSlideIndex+1)%scrollDiv.length;currentSlideLeftOffset>slider.prop("offsetLeft")&&(targetSlideIndex=currentSlideIndex-1)<0&&(targetSlideIndex=scrollDiv.length-1);angular.element(scrollDiv[targetSlideIndex]);var position=currentSlideLeftOffset/slider[0].offsetWidth,slideDirection=position>0?"right":"left";!function(currentSlideIndex,targetSlideIndex,position,slideDirection){var targetTab=angular.element(slideTabs[targetSlideIndex]),currentTab=angular.element(slideTabs[currentSlideIndex]),targetLeftOffset=targetTab.prop("offsetLeft"),currentLeftOffset=currentTab.prop("offsetLeft"),offsetLeftDiff=Math.abs(targetLeftOffset-currentLeftOffset);if(!(0==currentSlideIndex&&targetSlideIndex==ionicSlideBoxDelegate.slidesCount()-1&&"right"==slideDirection||0==targetSlideIndex&&currentSlideIndex==ionicSlideBoxDelegate.slidesCount()-1&&"left"==slideDirection)){var targetWidth=targetTab[0].offsetWidth,widthDiff=targetWidth-currentTab[0].offsetWidth,indicatorPos=0,indicatorWidth=0;currentSlideIndex>targetSlideIndex?(indicatorPos=targetLeftOffset-offsetLeftDiff*(position-1),indicatorWidth=targetWidth-widthDiff*(1-position)):targetSlideIndex>currentSlideIndex&&(indicatorPos=targetLeftOffset+offsetLeftDiff*(position-1),indicatorWidth=targetWidth+widthDiff*(position-1)),indicator.css({"-webkit-transition-duration":"0ms","-webkit-transform":"translate("+indicatorPos+"px,0px)",width:indicatorWidth+"px"}),options.slideTabsScrollable&&ionicScrollDelegate&&ionicScrollDelegate.scrollTo(indicatorPos-40,0,!1)}}(currentSlideIndex,targetSlideIndex,position=Math.abs(position),slideDirection)},function(){angular.isDefined(attrs.slideTabsScrollable)&&"false"===attrs.slideTabsScrollable&&(options.slideTabsScrollable=!1);var tabItems='<li ng-repeat="(key, value) in tabs" ng-click="onTabTabbed($event, {{key}})" class="slider-slide-tab" ng-bind-html="value"></li>';options.slideTabsScrollable?(ionicScrollDelegateID="ion-slide-tabs-handle-"+Math.floor(1e4*Math.random()+1),tabsBar=angular.element('<ion-scroll delegate-handle="'+ionicScrollDelegateID+'" class="slidingTabs" direction="x" scrollbar-x="false"><ul>'+tabItems+'</ul> <div class="tab-indicator-wrapper"><div class="tab-indicator"></div></div> </ion-scroll>')):tabsBar=angular.element('<div class="slidingTabs"><ul>'+tabItems+'</ul> <div class="tab-indicator-wrapper"><div class="tab-indicator"></div></div> </div>'),slider=angular.element(element);var compiled=$compile(tabsBar);slider.parent().prepend(tabsBar),compiled(scope),indicator=angular.element(tabsBar[0].querySelector(".tab-indicator"));var slideHandle=slider.attr("delegate-handle"),scrollHandle=tabsBar.attr("delegate-handle");ionicSlideBoxDelegate=$ionicSlideBoxDelegate,slideHandle&&(ionicSlideBoxDelegate=ionicSlideBoxDelegate.$getByHandle(slideHandle)),options.slideTabsScrollable&&(ionicScrollDelegate=$ionicScrollDelegate,scrollHandle&&(ionicScrollDelegate=ionicScrollDelegate.$getByHandle(scrollHandle))),addEvents(),setTabBarWidth(),slideToCurrentPosition()}()},controller:["$scope",function($scope){this.addTab=function($content){$timeout(function(){$scope.addTabContent&&$scope.addTabContent($content)})}}]}}]);slidingTabsDirective.directive("ionSlideTabLabel",[function(){return{require:"^ionSlideTabs",link:function($scope,$element,$attrs,$parent){$parent.addTab($attrs.ionSlideTabLabel)}}}]),angular.module("starter").provider("HomepageLayout",function(){var self=this;self.layout_ids={},self.getLayoutIdForValueId=function(valueId){var layoutId=1;try{if(self.layout_ids.hasOwnProperty(valueId))return 1*self.layout_ids[valueId];self.pages.forEach(function(page){if(page.value_id==valueId)return 1*page.layout_id;"folder_v2"===currentPage.code&&currentPage.embed_payload&&currentPage.embed_payload.collection.forEach(function(subPage){if(subPage.value_id==valueId)return 1*(layoutId=subPage.layout_id)})})}catch(e){layoutId=1}return layoutId},self.setLayoutIdForValueId=function(value_id,layout_id){for(var i in self.layout_ids[value_id]=layout_id,self.pages)self.pages[i].value_id==value_id&&(self.pages[i].layout_id=layout_id)},self.$get=function($injector,$ionicSlideBoxDelegate,$ionicPlatform,$ionicHistory,$ionicSideMenuDelegate,$location,$log,$q,$rootScope,$stateParams,$timeout,$window,LinkService,Analytics,Customer,Pages,Padlock,Modal){var HomepageLayout={load_hooks:[],more_modal:null,openFeature:function(feature,scope){void 0===scope&&(scope=$rootScope),HomepageLayout.more_modal&&(HomepageLayout.more_modal.hide(),scope.tabbar_is_visible=!0,scope.pages_list_is_visible=!1),Modal.is_open&&Modal.current_modal.hide();var doClearHistory=!1;switch(Pages.data.layout.position){case"left":case"right":$ionicSideMenuDelegate.isOpenLeft()&&$ionicSideMenuDelegate.toggleLeft(),$ionicSideMenuDelegate.isOpenRight()&&$ionicSideMenuDelegate.toggleRight();var isPadlock="padlock"===feature.code,isSubFolder=void 0!==feature.is_subfolder&&feature.is_subfolder,hasParentFolder=void 0!==feature.has_parent_folder&&feature.has_parent_folder;isPadlock||isSubFolder||hasParentFolder||feature.path===$location.path()||(doClearHistory=!0)}switch(!0){case"tabbar_account"===feature.code:Analytics.storePageOpening({id:0}),Customer.loginModal(scope);break;case"tabbar_more"===feature.code:HomepageLayout.getFeatures().then(function(features){scope.tabbar_is_visible=!1,scope.pages_list_is_visible=!0,scope.features=features,scope.closeMore=function(){HomepageLayout.more_modal.hide(),scope.tabbar_is_visible=!0,scope.pages_list_is_visible=!1},scope.goTo=function(goToFeature){HomepageLayout.openFeature(goToFeature,scope)},Modal.fromTemplateUrl(HomepageLayout.getModalTemplate(),{scope:scope}).then(function(modal){HomepageLayout.more_modal=modal,HomepageLayout.more_modal.show(),$ionicPlatform.onHardwareBackButton(function(e){scope.pages_list_is_visible&&scope.closeMore()})})});break;case $rootScope.isOffline&&!feature.offline_mode&&$rootScope.isNotAvailableOffline():break;case feature.is_link:LinkService.openLink(feature.url,{hide_navbar:!!feature.hide_navbar,use_external_app:!!feature.use_external_app}),Analytics.storePageOpening(feature);break;default:Analytics.storePageOpening(feature),!$injector.get("Application").is_customizing_colors&&HomepageLayout.properties.options.autoSelectFirst?feature.path!==$location.path()&&(doClearHistory&&$ionicHistory.nextViewOptions({historyRoot:!0,disableAnimate:!1}),$location.path(feature.path).replace()):$location.path(feature.path)}},registerHook:function(hook){"function"==typeof hook&&HomepageLayout.load_hooks.push(hook)},callHooks:function(){for(var i=0;i<HomepageLayout.load_hooks.length;i++)HomepageLayout.load_hooks[i]();$timeout(function(){$ionicSlideBoxDelegate.update()},800)},getTemplate:function(){var layout_code=HomepageLayout.properties.layoutCode,layout_id=HomepageLayout.properties.layoutId;return $injector.has(layout_code)?$injector.get(layout_code).getTemplate():"templates/home/"+layout_id+"/view.html"},getModalTemplate:function(){var layout_code=HomepageLayout.properties.layoutCode;return $injector.has(layout_code)?$injector.get(layout_code).getModalTemplate():"templates/home/modal/view.html"},_initData:function(){HomepageLayout.data=null,HomepageLayout.need_to_build_the_options=!0,HomepageLayout.options=null,HomepageLayout.is_initialized=!1,HomepageLayout.dataLoading=!1,HomepageLayout.properties={options:{autoSelectFirst:!1,isRootPage:!1,current:null},menu:{position:"normal",visibility:"homepage",isVisible:!1,sidebarLeftWidth:"120",sidebarRightWidth:"120"}}},getData:function(){var deferred=$q.defer();return null===HomepageLayout.data?HomepageLayout.dataLoading?$timeout(function(){deferred.resolve(HomepageLayout.getData())}):Pages.ready.then(function(){if(HomepageLayout.dataLoading=!0,HomepageLayout.data=Pages.data,self.pages=Pages.data.pages,self.layout_ids=Pages.data.layouts,HomepageLayout.properties.layoutId=Pages.data.layout_id,HomepageLayout.properties.layoutCode=Pages.data.layout_code,HomepageLayout.properties.layoutOptions=Pages.data.layout.layout_options,HomepageLayout.properties.tabbar_is_transparent=Pages.data.tabbar_is_transparent,void 0!==HomepageLayout.properties.layoutOptions&&void 0!==HomepageLayout.properties.layoutOptions.sidebarWidth)switch(HomepageLayout.properties.layoutOptions.sidebarWidthUnit){case"pixel":HomepageLayout.properties.menu.sidebarLeftWidth=HomepageLayout.properties.layoutOptions.sidebarWidthPixel;break;case"percentage":var width=$window.innerWidth;HomepageLayout.properties.menu.sidebarLeftWidth=width/100*HomepageLayout.properties.layoutOptions.sidebarWidth}HomepageLayout._init(),HomepageLayout.dataLoading=!1,deferred.resolve(HomepageLayout.data)}):(HomepageLayout.need_to_build_the_options&&HomepageLayout._buildOptions(),deferred.resolve(HomepageLayout.data)),deferred.promise},getOptions:function(){var deferred=$q.defer();return null===HomepageLayout.options?HomepageLayout.getData().then(function(data){deferred.resolve(HomepageLayout.options)},function(err){deferred.reject(err)}):deferred.resolve(HomepageLayout.options),deferred.promise},getActiveOptions:function(){var deferred=$q.defer();return HomepageLayout.getOptions().then(function(options){options=options.reduce(function(options,option){return option.is_active&&options.push(option),options},[]),HomepageLayout.data.customer_account.url=Customer.isLoggedIn()?HomepageLayout.data.customer_account.edit_url:HomepageLayout.data.customer_account.login_url,HomepageLayout.data.customer_account.path=Customer.isLoggedIn()?HomepageLayout.data.customer_account.edit_path:HomepageLayout.data.customer_account.login_path,deferred.resolve(options)}),deferred.promise},getFeatures:function(){var deferred=$q.defer();return HomepageLayout.getActiveOptions().then(function(options){var features={layoutId:HomepageLayout.data.layout_id,layoutCode:HomepageLayout.data.layout_code,layoutOptions:HomepageLayout.data.layout.layout_options,options:options,overview:{hasMore:!1,options:[],paged_options:[],limit:HomepageLayout.data.limit_to},data:HomepageLayout.data},limit=features.overview.limit;if(null!==limit&&limit>0&&features.options.length>limit)if(HomepageLayout.data.layout.use_horizontal_scroll){for(var paged_options=[],i=0;i<features.options.length;i++)paged_options.push(features.options[i]),(i+1)%limit==0&&(features.overview.paged_options.push(paged_options),paged_options=[]);paged_options.length&&features.overview.paged_options.push(paged_options)}else{for(i=0;i<limit-1;i++)features.overview.options.push(features.options[i]);features.overview.hasMore=!0}else HomepageLayout.data.layout.use_horizontal_scroll?features.overview.paged_options=[features.options]:features.overview.options=features.options;var more_button={name:features.data.more_items.name,icon_url:features.data.more_items.icon_url,icon_is_colorable:features.data.more_items.icon_is_colorable,code:features.data.more_items.code,url:"tabbar_more"},layout_code=HomepageLayout.data.layout_code;$injector.has(layout_code)?(features=$injector.get(layout_code).features(features,more_button),HomepageLayout.registerHook(function(){$injector.get(layout_code).onResize()}),window.addEventListener("orientationchange",function(){$injector.get(layout_code).onResize()})):features.overview.hasMore&&features.overview.options.push(more_button),$timeout(function(){$ionicSlideBoxDelegate.update()},200),features.first_option=!1,HomepageLayout.properties.options.autoSelectFirst&&0!==features.options.length&&(features.first_option=features.options[0]),deferred.resolve(features)}),deferred.promise},_updateFromUrl:function(url){if(null!==HomepageLayout.options){if($stateParams.value_id){var optionId=parseInt($stateParams.value_id),currentOption=HomepageLayout.options.reduce(function(currentOption,option){return option.id===optionId&&(option.url===url?(HomepageLayout.properties.options.isRootPage=!0,HomepageLayout.properties.menu.isVisible="always"===HomepageLayout.properties.menu.visibility):(HomepageLayout.properties.options.isRootPage=!1,HomepageLayout.properties.menu.isVisible="always"===HomepageLayout.properties.menu.visibility||!1),currentOption=option),currentOption},null);return null===currentOption?HomepageLayout.properties.options.isRootPage=!1:HomepageLayout.properties.options.current!==currentOption&&(HomepageLayout.properties.options.current=currentOption),currentOption}if(!/customer\/mobile_account/.test(url)&&!/cms\/mobile_privacypolicy/.test(url))return null;HomepageLayout.properties.options.isRootPage=/customer\/mobile_account_login/.test(url),HomepageLayout.properties.menu.isVisible="always"===HomepageLayout.properties.menu.visibility,HomepageLayout.properties.options.current=null}},fireLocationChanged:function(){HomepageLayout._updateFromUrl($location.absUrl())},_init:function(){HomepageLayout._buildOptions();HomepageLayout.properties.menu.position=HomepageLayout.data.layout.position,HomepageLayout.properties.menu.visibility=HomepageLayout.data.layout.visibility,HomepageLayout.properties.options.autoSelectFirst="homepage"!==HomepageLayout.properties.menu.visibility,HomepageLayout._updateFromUrl($location.absUrl()),HomepageLayout.is_initialized=!0},setLayoutId:function(value_id,layout_id){self.setLayoutIdForValueId(value_id,layout_id)},_buildOptions:function(){return HomepageLayout.options=HomepageLayout.data.pages.reduce(function(options,option){return(!option.is_locked||Customer.can_access_locked_features||Padlock.unlocked_by_qrcode)&&((Customer.isLoggedIn()||Padlock.unlocked_by_qrcode)&&"padlock"===option.code||options.push(option)),options},[]),HomepageLayout.need_to_build_the_options=!1,HomepageLayout.options}};return HomepageLayout._initData(),{leftAreaSize:150,openFeature:function(feature,scope){return HomepageLayout.openFeature(feature,scope)},registerHook:function(hook){return HomepageLayout.registerHook(hook)},callHooks:function(){return HomepageLayout.callHooks()},getTemplate:function(){return HomepageLayout.getTemplate()},getModalTemplate:function(){return HomepageLayout.getModalTemplate()},getData:function(){return HomepageLayout.getData()},unsetData:function(){HomepageLayout._initData(),$rootScope.$broadcast("tabbarStatesChanged")},getOptions:function(){return HomepageLayout.getOptions()},getActiveOptions:function(){return HomepageLayout.getActiveOptions()},getFeatures:function(){return HomepageLayout.getFeatures()},isInitialized:function(){return HomepageLayout.is_initialized},unlockByQRCode:function(qrcode){return HomepageLayout.unlockByQRCode(qrcode)},setNeedToBuildTheOptions:function(need_to_build_the_options){HomepageLayout.options=null,HomepageLayout.need_to_build_the_options=need_to_build_the_options},rebuildOptions:function(){HomepageLayout._buildOptions()},setLayoutId:function(value_id,layout_id){HomepageLayout.setLayoutId(value_id,layout_id)},properties:HomepageLayout.properties,app:{fireLocationChanged:HomepageLayout.fireLocationChanged}}}}),angular.module("starter").provider("$pwaCache",function(){this.$get=function(){var provider={};return void 0===window.localforage?provider={isEnabled:!1}:((provider={isEnabled:!0,defaultDrivers:[window.localforage.INDEXEDDB,window.localforage.LOCALSTORAGE],defaultStoreName:"content-cache",valueidStoreName:"valueid-index",registryStoreName:"registry-index",cacheKey:"pwa-cache-"+APP_KEY,cacheMaxSize:64e6,defaultCache:null,valueidCache:null,registryCache:null,backgroundImages:[]}).defaultCache=window.localforage.createInstance({driver:provider.defaultDrivers,name:provider.cacheKey,storeName:provider.defaultStoreName,size:provider.cacheMaxSize}),provider.valueidCache=window.localforage.createInstance({driver:provider.defaultDrivers,name:provider.cacheKey,storeName:provider.valueidStoreName,size:provider.cacheMaxSize/16}),provider.registryCache=window.localforage.createInstance({driver:window.localforage.LOCALSTORAGE,name:provider.cacheKey,storeName:provider.registryStoreName,size:provider.cacheMaxSize/16}),provider.getDefaultCache=function(){return provider.defaultCache},provider.getValueidCache=function(){return provider.valueidCache},provider.getRegistryCache=function(){return provider.registryCache},provider)}}),angular.module("starter").factory("FallbackPromise",function($q){return{resolved:!1,decorate:function(promise){promise.success=function(callback){return promise.then(callback),promise},promise.error=function(callback){return promise.then(null,callback),promise}},defer:function(){var deferred=$q.defer();return this.decorate(deferred.promise),deferred}}}),angular.module("starter").provider("$pwaRequest",function(){var provider={debug:!0,queue:null,defaultCache:null,valueidCache:null,registryCache:null,cacheIsEnabled:!1};return provider.$get=["$pwaCache","$injector","$rootScope","$session","$translate","$http","$log","$q","$queue","FallbackPromise","Url",function($pwaCache,$injector,$rootScope,$session,$translate,$http,$log,$q,$queue,FallbackPromise,Url){provider.cacheIsEnabled=$pwaCache.isEnabled,provider.defaultCache=$pwaCache.getDefaultCache(),provider.valueidCache=$pwaCache.getValueidCache(),provider.registryCache=$pwaCache.getRegistryCache();var httpCacheLayerConfig={debug:provider.debug};return provider.handleRequest=function(options){options=angular.extend({},options,{cache:!1}),$http(options).then(function(response){var cachedResponse={expires_at:options.expires_at,touched_at:options.touched_at,data:angular.copy(response.data)};provider.defaultCache.setItem(options.cacheKey,cachedResponse),options.network_promise.resolve(angular.copy(response.data)),(options.return_response||options.pullToRefresh)&&options.deferred_promise.resolve(angular.copy(response.data))},function(response){var data={error:!0,message:$translate.instant("The request returned a 400 HTTP Code, with no message.")};_.isObject(response)&&_.isObject(response.data)&&(data=response.data),_.isObject(response)&&410===response.status&&provider.defaultCache.removeItem(options.cacheKey),options.network_promise.reject(data),options.return_response&&options.deferred_promise.reject(data),options.pullToRefresh&&(data.message=$translate.instant("Unable to refresh content, please try again later."),options.deferred_promise.reject(data))}).catch(function(errrrrr){$log.error("Caught error: "+errrrrr)})},null===provider.queue&&(provider.queue=$queue.queue(provider.handleRequest,{delay:100,paused:!1,persistent:!0,max_concurrent:5}),provider.queue.start()),new function(httpCacheLayerConfig){var httpWrapper=function(requestOptions){var current=Math.trunc((new Date).getTime()/1e3),options=_.extend(requestOptions,{method:_.upperCase(_.trim(_.get(requestOptions,"method","GET"))),cache:!!_.get(requestOptions,"cache",!0),url:_.trim(_.get(requestOptions,"url")),pullToRefresh:!!_.get(requestOptions,"refresh",!1),imageProxy:!!_.get(requestOptions,"imageProxy",!1),requestData:_.get(requestOptions,"data",{}),expires_at:_.get(requestOptions,"expires_at",current+3600),touched_at:_.get(requestOptions,"touched_at",current),network_promise:_.get(requestOptions,"network_promise",$q.defer()),timeout:_.get(requestOptions,"timeout",3e4),deferred_promise:FallbackPromise.defer()});if(options.deferred_promise.promise.__name__="pwa-"+Math.random(),!provider.cacheIsEnabled||!options.cache){if($rootScope.isOnline)$http(requestOptions).then(function(response){options.deferred_promise.resolve(response.data)},function(response){if(response&&response.data)void 0===response.data.message&&(response.data.message=$translate.instant("An unknown error occurred.")),options.deferred_promise.reject(response.data);else{var error={error:!0,message:$translate.instant("The resource is not reachable, check your network connection.")};options.deferred_promise.reject(error)}}).catch(function(err){var error={error:!0,message:$translate.instant("[Network] The resource is not reachable, check your network connection.")};options.deferred_promise.reject(error)});else{var error={error:!0,message:$translate.instant("[Network] Device is offline, aborting request.")};options.deferred_promise.reject(error)}return options.deferred_promise.promise}var cacheKey=options.url;if(options.imageProxy&&void 0===(cacheKey=options.requestData.resource))return $q.reject({error:!0,message:$translate.instant("Resource is `undefined`.")});var value_id=_.get(options.urlParams,"value_id",!1),valueidCachekey="valueid_"+value_id;!1!==value_id&&provider.valueidCache.getItem(valueidCachekey).then(function(cached_array){var copy=angular.copy(cached_array);null===copy?provider.valueidCache.setItem(valueidCachekey,[cacheKey]):options.pullToRefresh?(options.timeout=6e4,angular.forEach(copy,function(uri){provider.defaultCache.removeItem(uri)}),provider.valueidCache.setItem(valueidCachekey,[cacheKey])):-1===copy.indexOf(cacheKey)&&(copy.push(cacheKey),provider.valueidCache.setItem(valueidCachekey,copy))});var touched=$injector.get("Pages").getForValueId(value_id),data_break=null;return-1!==touched.touched_at&&(options=angular.extend({},options,{touched_at:touched.touched_at,expires_at:touched.expires_at})),options=angular.extend({},options,{cacheKey:cacheKey}),provider.defaultCache.getItem(cacheKey).then(function(cached_object){if(null===cached_object)options.return_response=!0,options.first_cache=!0,provider.queue.addFirst(options);else{if(data_break=angular.copy(cached_object),options.first_cache=!1,options.imageProxy)return angular.extend(cached_object,{expires_at:options.expires_at,touched_at:options.touched_at}),provider.defaultCache.setItem(cacheKey,cached_object),options.network_promise.resolve(data_break.data),void options.deferred_promise.resolve(data_break.data);options.pullToRefresh?(options.timeout=6e4,provider.queue.globalPause(),options.return_response=!0,provider.handleRequest(options),options.deferred_promise.promise.then(function(){provider.queue.globalStart()})):(options.return_response=!1,provider.queue.add(options)),options.pullToRefresh||options.deferred_promise.resolve(data_break.data)}}).catch(function(error){options.deferred_promise.reject({error:!0,message:$translate.instant("The given resource is not reachable")+" "+cacheKey,exception:error})}),options.deferred_promise.promise};return httpWrapper.get=function(url,config){return 0!==url.indexOf("http")&&(url=Url.get(url,_.get(config,"urlParams",{}))),$rootScope.isOffline&&(void 0===config?config={refresh:!1}:config.refresh=!1),httpWrapper(_.extend({method:"GET",url:url,cache:!$rootScope.isOverview,responseType:"json"},config||{}))},httpWrapper.post=function(url,config){return 0!==url.indexOf("http")&&(url=Url.get(url,_.get(config,"urlParams",{}))),$rootScope.isOffline&&(void 0===config?config={refresh:!1}:config.refresh=!1),httpWrapper(_.extend({method:"POST",url:url,cache:!$rootScope.isOverview,responseType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"}},config||{}))},httpWrapper.head=$http.head,httpWrapper.put=$http.put,httpWrapper.delete=$http.delete,httpWrapper.jsonp=$http.jsonp,httpWrapper.patch=$http.patch,Object.defineProperty(httpWrapper,"postForm",{get:function(){return $http.postForm}}),httpWrapper.cache=function(uri,config){return httpWrapper.get(uri,{cache:!$rootScope.isOverview})},httpWrapper.cacheImage=function(uri){return isNativeApp&&window.OfflineMode?$q(function(resolve,reject){window.OfflineMode.cacheURL(uri,function(){resolve()},function(){reject()})}):$q.reject()},httpWrapper.getItem=function(key,dataCallback){if("function"!=typeof dataCallback)throw new Error("dataCallback must be a function.");var deferred=$q.defer();return provider.registryCache.getItem(key).then(function(cachedData){null===cachedData?provider.registryCache.setItem(key,dataCallback.call(this)).then(function(resolve){deferred.resolve(resolve)},function(reject){deferred.reject(reject)}):(provider.registryCache.setItem(key,dataCallback.call(this)),deferred.resolve(cachedData))}).catch(function(error){deferred.reject(null)}),deferred.promise},httpWrapper.reject=function(message){return message=void 0!==message?message:$translate.instant("The request is probably missing some parameters."),$q.reject({error:!0,message:message})},httpWrapper.resolve=function(data){return $q.resolve(data)},httpWrapper.defer=function(){return $q.defer()},httpWrapper.getPayloadForValueId=function(value_id){return $injector.get("Pages").getPayloadForValueId(value_id)},httpWrapper.clearValueId=function(value_id){var deferred=$q.defer();return provider.valueidCache.getItem("valueid_"+value_id).then(function(cached_uris){var copy=angular.copy(cached_uris);null!==copy&&angular.forEach(copy,function(uri){provider.defaultCache.removeItem(uri)}),provider.valueidCache.removeItem("valueid_"+value_id).then(function(){deferred.resolve()})}).catch(function(){deferred.resolve()}),deferred.promise},httpWrapper.removeCached=function(uri){return $pwaCache.getDefaultCache().removeItem(uri)},httpWrapper}(httpCacheLayerConfig)}],provider}),angular.module("starter").provider("$sbhttp",function(){var b={alwaysCache:!1,neverCache:!1,debug:!1};return b.$get=["$rootScope","$http","$log","$q","$window","_",function(c,d,e,f,g,h){var j,i={alwaysCache:b.alwaysCache,neverCache:!b.alwaysCache&&b.neverCache,debug:!0===b.debug};return(j={}).getItem=j.setItem=j.removeItem=function(){return f.reject("no offline mode cache in webview")},(ionic.Platform.isIOS()||ionic.Platform.isAndroid())&&window.localforage&&(window.localforage.config({name:"sb-offline-mode",storeName:"keyvaluepairs",size:262144e3}),j=window.localforage),new function(a){var b=function(b){var g=h.upperCase(h.trim(h.get(b,"method"))),i=h.trim(h.get(b,"url"));if(e.debug(new Error("Stacktrace following").stack),"GET"===g&&i.length>0){e.debug("GET "+i);var k=c.isOnline,l=!a.neverCache||a.alwaysCache,m=h.get(b,"cache",l),n=[angular.noop],o=[angular.noop],p=!1,q=!1,r=f(function(a,c){var f=function(f){try{for(;h.isString(f)&&h.trim(f).length>0;)f=JSON.parse(f)}catch(a){e.info("Error parsing data :",a,data),f=null}var g=m&&f,l=h.extend({},b,{}),r=function(b){if(e.debug("Processing http response ("+i+") with status code "+h.get(b,"status")),h.isObject(b)&&0===b.status&&h.isObject(g))return k=!1,e.debug("request failed for "+i+": using cache"),r(g);p=!0;var d=(q=!((g=b).status>=200&&g.status<=299))?o:n,f=q?c:a,s=function(){h.isFunction(g.headers)&&"true"===g.headers("X-From-Native-Cache")&&(g=h.extend({},g,{fromCache:!0})),h.forEach(d,function(a){a(g.data,g.status,g.headers,l)}),f(g)};if(h.isObject(g)&&(k||!0!==g.fromCache)&&m&&!q){e.debug("caching response for URL "+i+" and status "+h.get(b,"status"));var t=JSON.stringify(h.extend({},g,{fromCache:!0}));try{t=JSON.stringify(t)}catch(a){e.info("Error stringifying data :",a,t)}return j.setItem(i,t).then(s,function(a){e.debug("LOCAL FORAGE ERROR : ",a),s()})}return s()};h.isObject(g)&&!k?(e.debug("we're offline: using cache"),r(g)):(e.debug("sending http call with config: ",l),d(l).then(r,r))};j.getItem(i).then(f,function(a){return e.debug("Error retrieving data from cache data :",a),f(null)})});return r.success=function(a){return h.isFunction(a)&&n.push(a),p&&!q&&a(response.data,response.status,response.headers,config),r},r.error=function(a){return h.isFunction(a)&&o.push(a),p&&q&&a(response.data,response.status,response.headers,config),r},r}return d(b)};return b.get=function(a,c){return b(h.extend({},c||{},{method:"GET",url:a}))},b.head=d.head,b.post=d.post,b.put=d.put,b.delete=d.delete,b.jsonp=d.jsonp,b.patch=d.patch,Object.defineProperty(b,"postForm",{get:function(){return d.postForm}}),b.cache=function(a){return!c.is_webview&&window.OfflineMode?f(function(b,c){window.OfflineMode.cacheURL(a,function(){e.info("cached URL succesfully : ",a),b()},function(){e.info("Failed to cache URL : ",a),c()})}):f.reject()},b.removeCached=function(a){return j.removeItem(a)},b}(i)}],b}),angular.module("starter").service("httpCache",function($sbhttp,$cacheFactory,ConnectionService){return{remove:function(url){var sid=localStorage.getItem("sb-auth-token");return sid&&-1==url.indexOf(".html")&&ConnectionService.isOnline&&(url=url+"?sb-token="+sid),angular.isDefined($cacheFactory.get("$http").get(url))&&$cacheFactory.get("$http").remove(url),$sbhttp.removeCached(url),this}}}),angular.module("starter").config(function($stateProvider){$stateProvider.state("colors-view",{url:BASE_PATH+"/application/mobile_customization_colors/",controller:"ApplicationColorsController",templateUrl:"templates/application/l1/colors/view.html",resolve:lazyLoadResolver(["application","homepage"]),cache:!1}).state("tc-view",{url:BASE_PATH+"/application/mobile_tc_view/index/tc_id/:tc_id",controller:"ApplicationTcController",templateUrl:"templates/application/l1/tc/view.html",resolve:lazyLoadResolver("application"),cache:!1})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("booking-view",{url:BASE_PATH+"/booking/mobile_view/index/value_id/:value_id",controller:"BookingController",templateUrl:"templates/booking/l1/view.html",cache:!1,resolve:lazyLoadResolver("booking")})}),angular.module("starter").config(function($stateProvider,HomepageLayoutProvider){$stateProvider.state("catalog-category-list",{url:BASE_PATH+"/catalog/mobile_category_list/index/value_id/:value_id",controller:"CategoryListController",templateUrl:function(param){var layout_id=HomepageLayoutProvider.getLayoutIdForValueId(param.value_id);switch(HomepageLayoutProvider.getLayoutIdForValueId(param.value_id)){case 2:layout_id="l5";break;case 3:layout_id="l6";break;default:layout_id="l3"}return"templates/html/"+layout_id+"/list.html"},cache:!1,resolve:lazyLoadResolver("catalog")}).state("catalog-product-view",{url:BASE_PATH+"/catalog/mobile_category_product_view/index/value_id/:value_id/product_id/:product_id",controller:"CategoryProductViewController",templateUrl:"templates/catalog/category/l1/product/view.html",cache:!1,resolve:lazyLoadResolver("catalog")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("cms-view",{url:BASE_PATH+"/cms/mobile_page_view/index/value_id/:value_id",controller:"CmsViewController",templateUrl:"templates/cms/page/l1/view.html",cache:!1,resolve:lazyLoadResolver(["cms","places"])}).state("cms-view-map",{url:BASE_PATH+"/cms/mobile_page_view_map/index/value_id/:value_id/page_id/:page_id/block_id/:block_id",params:{page_id:0},controller:"CmsViewMapController",templateUrl:"templates/html/l1/maps.html",cache:!1,resolve:lazyLoadResolver(["cms","places"])})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("codescan",{url:BASE_PATH+"/codescan/mobile_view/index/value_id/:value_id",controller:"CodeScanController",templateUrl:"templates/html/l1/loading.html",cache:!1,resolve:lazyLoadResolver("codescan")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("contact-view",{url:BASE_PATH+"/contact/mobile_view/index/value_id/:value_id",templateUrl:"templates/contact/l1/view.html",controller:"ContactViewController",cache:!1,resolve:lazyLoadResolver("contact")}).state("contact-form",{url:BASE_PATH+"/contact/mobile_form/index/value_id/:value_id",templateUrl:"templates/contact/l1/form.html",controller:"ContactFormController",cache:!1,resolve:lazyLoadResolver("contact")}).state("contact-map",{url:BASE_PATH+"/contact/mobile_map/index/value_id/:value_id",templateUrl:"templates/html/l1/maps.html",controller:"ContactMapController",cache:!1,resolve:lazyLoadResolver("contact")})}),angular.module("starter").config(function($stateProvider,HomepageLayoutProvider){$stateProvider.state("discount-list",{url:BASE_PATH+"/promotion/mobile_list/index/value_id/:value_id",controller:"DiscountListController",cache:!1,resolve:lazyLoadResolver("discount"),templateUrl:function(param){switch(HomepageLayoutProvider.getLayoutIdForValueId(param.value_id)){case 2:return"templates/html/l2/list.html";case 3:return"templates/html/l5/list.html";case 4:return"templates/html/l6/list.html";case 5:return"templates/discount/l5/list.html";default:return"templates/discount/l1/list.html"}}}).state("discount-view",{url:BASE_PATH+"/promotion/mobile_view/index/value_id/:value_id/promotion_id/:promotion_id",controller:"DiscountViewController",templateUrl:"templates/discount/l1/view.html",cache:!1,resolve:lazyLoadResolver("discount")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("event-list",{url:BASE_PATH+"/event/mobile_list/index/value_id/:value_id",controller:"EventListController",templateUrl:"templates/event/l1/list.html",cache:!1,resolve:lazyLoadResolver("event")}).state("event-view",{url:BASE_PATH+"/event/mobile_view/index/value_id/:value_id/event_id/:event_id",controller:"EventViewController",templateUrl:"templates/event/l1/view.html",cache:!1,resolve:lazyLoadResolver("event")}).state("event-map",{url:BASE_PATH+"/event/mobile_map/index/value_id/:value_id/event_id/:event_id",templateUrl:"templates/html/l1/maps.html",controller:"EventMapController",cache:!1,resolve:lazyLoadResolver("event")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("facebook-list",{url:BASE_PATH+"/social/mobile_facebook_list/index/value_id/:value_id",controller:"FacebookListController",templateUrl:"templates/html/l1/list.html",resolve:lazyLoadResolver("facebook"),cache:!1}).state("facebook-view",{url:BASE_PATH+"/social/mobile_facebook_view/index/value_id/:value_id/post_id/:post_id",controller:"FacebookViewController",templateUrl:"templates/facebook/l1/view.html",resolve:lazyLoadResolver("facebook"),cache:!1})}),angular.module("starter").config(function($stateProvider,HomepageLayoutProvider){$stateProvider.state("folder-category-list",{url:BASE_PATH+"/folder/mobile_list/index/value_id/:value_id",controller:"FolderListController",cache:!1,templateUrl:function(param){var layoutId=HomepageLayoutProvider.getLayoutIdForValueId(param.value_id);switch(layoutId){case 2:layoutId="l2";break;case 3:layoutId="l3";break;case 4:layoutId="l4";break;default:layoutId="l1"}return"templates/folder/"+layoutId+"/list.html"},resolve:lazyLoadResolver("folder")}).state("folder-subcategory-list",{url:BASE_PATH+"/folder/mobile_list/index/value_id/:value_id/category_id/:category_id",controller:"FolderListController",cache:!1,templateUrl:function(param){var layoutId=HomepageLayoutProvider.getLayoutIdForValueId(param.value_id);switch(layoutId){case 2:layoutId="l2";break;case 3:layoutId="l3";break;case 4:layoutId="l4";break;default:layoutId="l1"}return"templates/folder/"+layoutId+"/list.html"},resolve:lazyLoadResolver("folder")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("form-view",{url:BASE_PATH+"/form/mobile_view/index/value_id/:value_id",controller:"FormViewController",templateUrl:"templates/form/l1/view.html",cache:!1,resolve:lazyLoadResolver("form")})}),angular.module("starter").config(function($stateProvider,$urlRouterProvider){$stateProvider.state("home",{url:BASE_PATH,templateUrl:"templates/home/view.html",controller:"HomeController",cache:!1,resolve:lazyLoadResolver("homepage")}),$urlRouterProvider.otherwise(BASE_PATH)}),angular.module("starter").config(function($stateProvider){$stateProvider.state("image-list",{url:BASE_PATH+"/media/mobile_gallery_image_list/index/value_id/:value_id",templateUrl:"templates/media/image/l1/list.html",controller:"ImageListController",cache:!1,resolve:lazyLoadResolver("image")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("links-view",{url:BASE_PATH+"/weblink/mobile_multi/index/value_id/:value_id",controller:"LinksViewController",templateUrl:"templates/links/l1/view.html",code:"weblink",cache:!1,resolve:lazyLoadResolver("links")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("locked",{url:BASE_PATH+"/locked/mobile_view/index",controller:"LockedController",templateUrl:"templates/locked/l1/view.html",cache:!1,resolve:lazyLoadResolver("locked")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("loyaltycard-view",{url:BASE_PATH+"/loyaltycard/mobile_view/index/value_id/:value_id",cache:!1,controller:"LoyaltyViewController",templateUrl:"templates/loyalty-card/l1/view.html",resolve:lazyLoadResolver("loyalty_card")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("maps-view",{url:BASE_PATH+"/maps/mobile_view/index/value_id/:value_id",controller:"MapsController",templateUrl:"templates/maps/l1/view.html",cache:!1,resolve:lazyLoadResolver("maps")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("mcommerce-cart-view",{url:BASE_PATH+"/mcommerce/mobile_cart/index/value_id/:value_id",controller:"MCommerceCartViewController",templateUrl:"templates/mcommerce/l1/cart.html",cache:!1,resolve:lazyLoadResolver("m_commerce")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("mcommerce-category-list",{url:BASE_PATH+"/mcommerce/mobile_category/index/value_id/:value_id",controller:"MCommerceListController",templateUrl:"templates/html/l3/list.html",cache:!1,resolve:lazyLoadResolver("m_commerce")}).state("mcommerce-subcategory-list",{url:BASE_PATH+"/mcommerce/mobile_category/index/value_id/:value_id/category_id/:category_id",controller:"MCommerceListController",templateUrl:"templates/html/l3/list.html",cache:!1,resolve:lazyLoadResolver("m_commerce")}).state("mcommerce-redirect",{url:BASE_PATH+"/mcommerce/redirect/index/value_id/:value_id",controller:"MCommerceRedirectController",cache:!1,resolve:lazyLoadResolver("m_commerce")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("mcommerce-product-view",{url:BASE_PATH+"/mcommerce/mobile_product/index/value_id/:value_id/product_id/:product_id",controller:"MCommerceProductViewController",templateUrl:"templates/mcommerce/l1/product.html",cache:!1,resolve:lazyLoadResolver("m_commerce")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("mcommerce-sales-confirmation",{url:BASE_PATH+"/mcommerce/mobile_sales_confirmation/index/value_id/:value_id",controller:"MCommerceSalesConfirmationViewController",templateUrl:"templates/mcommerce/l1/sales/confirmation.html",cache:!1,resolve:lazyLoadResolver("m_commerce")}).state("mcommerce-sales-confirmation-cancel",{url:BASE_PATH+"/mcommerce/mobile_sales_confirmation/cancel/value_id/:value_id",controller:"MCommerceSalesConfirmationCancelController",templateUrl:"templates/mcommerce/l1/sales/confirmation.html",cache:!1,resolve:lazyLoadResolver("m_commerce")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("mcommerce-sales-customer",{url:BASE_PATH+"/mcommerce/mobile_sales_customer/index/value_id/:value_id",controller:"MCommerceSalesCustomerViewController",templateUrl:"templates/mcommerce/l1/sales/customer.html",cache:!1,resolve:lazyLoadResolver("m_commerce")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("mcommerce-sales-delivery",{url:BASE_PATH+"/mcommerce/mobile_sales_delivery/index/value_id/:value_id",controller:"MCommerceSalesDeliveryViewController",templateUrl:"templates/mcommerce/l1/sales/delivery.html",cache:!1,resolve:lazyLoadResolver("m_commerce")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("mcommerce-sales-error",{url:BASE_PATH+"/mcommerce/mobile_sales_error/index/value_id/:value_id",controller:"MCommerceSalesErrorViewController",templateUrl:"templates/mcommerce/l1/sales/error.html",cache:!1,resolve:lazyLoadResolver("m_commerce")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("mcommerce-sales-history",{url:BASE_PATH+"/mcommerce/mobile_sales_customer/history/value_id/:value_id",controller:"MCommerceSalesHistoryViewController",templateUrl:"templates/mcommerce/l1/sales/history.html",cache:!1,resolve:lazyLoadResolver("m_commerce")}).state("mcommerce-sales-history-details",{url:BASE_PATH+"/mcommerce/mobile_sales_customer/history_details/value_id/:value_id/order_id/:order_id",controller:"MCommerceSalesHistoryDetailsController",templateUrl:"templates/mcommerce/l1/sales/history_details.html",cache:!1,resolve:lazyLoadResolver("m_commerce")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("mcommerce-sales-payment",{url:BASE_PATH+"/mcommerce/mobile_sales_payment/index/value_id/:value_id",controller:"MCommerceSalesPaymentViewController",templateUrl:"templates/mcommerce/l1/sales/payment.html",cache:!1,resolve:lazyLoadResolver("m_commerce")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("mcommerce-sales-store",{url:BASE_PATH+"/mcommerce/mobile_sales_storechoice/index/value_id/:value_id",controller:"MCommerceSalesStoreChoiceController",templateUrl:"templates/mcommerce/l1/sales/store.html",cache:!1,resolve:lazyLoadResolver("m_commerce")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("mcommerce-sales-stripe",{url:BASE_PATH+"/mcommerce/mobile_sales_stripe/index/value_id/:value_id",controller:"MCommerceSalesStripeViewController",templateUrl:"templates/mcommerce/l1/sales/stripe.html",cache:!1,resolve:lazyLoadResolver("m_commerce")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("mcommerce-sales-success",{url:BASE_PATH+"/mcommerce/mobile_sales_success/index/value_id/:value_id",controller:"MCommerceSalesSuccessViewController",templateUrl:"templates/mcommerce/l1/sales/success.html",cache:!1,resolve:lazyLoadResolver("m_commerce")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("media-player",{url:BASE_PATH+"/media/mobile_gallery_music_player/index/value_id/:value_id",controller:"MediaPlayerController",templateUrl:"templates/media/music/l1/player/view.html",resolve:lazyLoadResolver("media")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("music-playlist-list",{url:BASE_PATH+"/media/mobile_gallery_music_playlists/index/value_id/:value_id",controller:"MusicPlaylistsController",templateUrl:"templates/media/music/l1/playlist/list.html",cache:!1,resolve:lazyLoadResolver("media")}).state("music-playlist-albums",{url:BASE_PATH+"/media/mobile_gallery_music_playlistalbums/index/value_id/:value_id/playlist_id/:playlist_id",controller:"MusicPlaylistAlbumsController",templateUrl:"templates/media/music/l1/playlist/albums.html",cache:!1,resolve:lazyLoadResolver("media")}).state("music-album-list",{url:BASE_PATH+"/media/mobile_gallery_music_albums/index/value_id/:value_id",controller:"MusicAlbumsListController",templateUrl:"templates/media/music/l1/album/list.html",cache:!1,resolve:lazyLoadResolver("media")}).state("music-album-view",{url:BASE_PATH+"/media/mobile_gallery_music_album/index/value_id/:value_id/album_id/:album_id",controller:"MusicAlbumViewController",templateUrl:"templates/media/music/l1/album/view.html",cache:!1,resolve:lazyLoadResolver("media")}).state("music-album-view-track",{url:BASE_PATH+"/media/mobile_gallery_music_album/index/value_id/:value_id/track_id/:track_id",controller:"MusicAlbumViewController",templateUrl:"templates/media/music/l1/album/view.html",cache:!1,resolve:lazyLoadResolver("media")}).state("music-track-list",{url:BASE_PATH+"/media/mobile_gallery_music_playlisttracks/index/value_id/:value_id/playlist_id/:playlist_id",controller:"MusicTrackListController",templateUrl:"templates/media/music/l1/track/list.html",cache:!1,resolve:lazyLoadResolver("media")})}),angular.module("starter").config(function($stateProvider,HomepageLayoutProvider){$stateProvider.state("newswall-list",{url:BASE_PATH+"/comment/mobile_list/index/value_id/:value_id",templateUrl:function(param){var layout_id=HomepageLayoutProvider.getLayoutIdForValueId(param.value_id);switch(layout_id){case 2:layout_id="l2";break;case 3:layout_id="l5";break;case 4:layout_id="l6";break;default:layout_id="l1"}return"templates/html/"+layout_id+"/list.html"},controller:"NewswallListController",cache:!1,resolve:lazyLoadResolver("newswall")}).state("newswall-view",{url:BASE_PATH+"/comment/mobile_view/index/value_id/:value_id/comment_id/:comment_id",templateUrl:"templates/html/l1/view.html",controller:"NewswallViewController",cache:!1,resolve:lazyLoadResolver("newswall")}).state("newswall-comment",{url:BASE_PATH+"/comment/mobile_comment/index/value_id/:value_id/comment_id/:comment_id",templateUrl:"templates/html/l1/comment.html",controller:"NewswallCommentController",cache:!1,resolve:lazyLoadResolver("newswall")}).state("fanwall-gallery",{url:BASE_PATH+"/comment/mobile_gallery/index/value_id/:value_id",templateUrl:"templates/fanwall/l1/gallery.html",controller:"NewswallGalleryController",cache:!1,resolve:lazyLoadResolver("newswall")}).state("fanwall-map",{url:BASE_PATH+"/comment/mobile_map/index/value_id/:value_id",templateUrl:"templates/html/l1/maps.html",controller:"NewswallMapController",cache:!1,resolve:lazyLoadResolver("newswall")}).state("fanwall-edit",{url:BASE_PATH+"/comment/mobile_edit/value_id/:value_id",templateUrl:"templates/fanwall/l1/edit.html",controller:"NewswallEditController",cache:!1,resolve:lazyLoadResolver("newswall")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("padlock-view",{url:BASE_PATH+"/padlock/mobile_view/index/value_id/:value_id",params:{value_id:0},controller:"PadlockController",templateUrl:"templates/padlock/l1/view.html",cache:!1,resolve:lazyLoadResolver("padlock")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("privacy-policy",{url:BASE_PATH+"/cms/privacy_policy/index/value_id/:value_id",controller:"PrivacyPolicyController",templateUrl:"templates/cms/privacypolicy/l1/privacy-policy.html",cache:!1,resolve:lazyLoadResolver("privacy_policy")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("push-list",{url:BASE_PATH+"/push/mobile_list/index/value_id/:value_id",controller:"PushController",templateUrl:"templates/html/l1/list.html",cache:!1,resolve:lazyLoadResolver("push")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("radio",{url:BASE_PATH+"/radio/mobile_radio/index/value_id/:value_id",controller:"RadioController",templateUrl:"templates/html/l1/loading.html",cache:!1,resolve:lazyLoadResolver(["media","radio"])})}),angular.module("starter").config(function($stateProvider,HomepageLayoutProvider){$stateProvider.state("rss-group",{url:BASE_PATH+"/rss/mobile_feed_group/index/value_id/:value_id",templateUrl:function(param){switch(HomepageLayoutProvider.getLayoutIdForValueId(param.value_id)){case 2:return"templates/rss/l2/group.html";case 3:return"templates/rss/l3/group.html";case 1:default:return"templates/rss/l1/group.html"}},controller:"RssGroupController",cache:!1,resolve:lazyLoadResolver("rss")}).state("rss-list",{url:BASE_PATH+"/rss/mobile_feed_list/index/value_id/:value_id/feed_id/:feed_id",templateUrl:function(param){switch(HomepageLayoutProvider.getLayoutIdForValueId(param.value_id)){case 2:return"templates/rss/l2/list.html";case 3:return"templates/rss/l3/list.html";case 1:default:return"templates/rss/l1/list.html"}},controller:"RssListController",cache:!1,resolve:lazyLoadResolver("rss")}).state("rss-view",{url:BASE_PATH+"/rss/mobile_feed_view/index/value_id/:value_id/item_id/:item_id",templateUrl:function(param){switch(HomepageLayoutProvider.getLayoutIdForValueId(param.value_id)){case 2:return"templates/rss/l2/view.html";case 3:return"templates/rss/l3/view.html";case 1:default:return"templates/rss/l1/view.html"}},controller:"RssViewController",cache:!1,resolve:lazyLoadResolver("rss")})}),angular.module("starter").config(function($stateProvider,HomepageLayoutProvider){$stateProvider.state("set-meal-list",{url:BASE_PATH+"/catalog/mobile_setmeal_list/index/value_id/:value_id",controller:"SetMealListController",templateUrl:function(param){var layout_id=HomepageLayoutProvider.getLayoutIdForValueId(param.value_id);switch(layout_id){case 2:layout_id="l5";break;case 3:layout_id="l6";break;default:layout_id="l3"}return"templates/html/"+layout_id+"/list.html"},resolve:lazyLoadResolver("catalog"),cache:!1}).state("set-meal-view",{url:BASE_PATH+"/catalog/mobile_setmeal_view/index/value_id/:value_id/set_meal_id/:set_meal_id",controller:"SetMealViewController",templateUrl:"templates/catalog/setmeal/l1/view.html",cache:!1,resolve:lazyLoadResolver("catalog")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("socialgaming-view",{url:BASE_PATH+"/socialgaming/mobile_view/index/value_id/:value_id",controller:"SocialgamingViewController",templateUrl:"templates/socialgaming/l1/view.html",cache:!1,resolve:lazyLoadResolver("social_gaming")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("sourcecode-view",{url:BASE_PATH+"/sourcecode/mobile_view/index/value_id/:value_id",controller:"SourcecodeViewController",templateUrl:"templates/sourcecode/l1/view.html",cache:!1,resolve:lazyLoadResolver("source_code")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("tip-view",{url:BASE_PATH+"/tip/mobile_view/index/value_id/:value_id",controller:"TipController",templateUrl:"templates/tip/l1/view.html",cache:!1,resolve:lazyLoadResolver("tip")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("topic-list",{url:BASE_PATH+"/topic/mobile_list/index/value_id/:value_id",controller:"TopicController",templateUrl:"templates/topic/l1/list.html",cache:!1,resolve:lazyLoadResolver("topic")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("twitter-list",{url:BASE_PATH+"/twitter/mobile_twitter_list/index/value_id/:value_id",controller:"TwitterListController",templateUrl:"templates/twitter/l1/list.html",cache:!1,resolve:lazyLoadResolver("twitter")})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("video-list",{url:BASE_PATH+"/media/mobile_gallery_video_list/index/value_id/:value_id",controller:"VideoListController",templateUrl:"templates/media/video/l1/list.html",cache:!1,resolve:lazyLoadResolver(["youtube","video"])})}),angular.module("starter").config(function($stateProvider){$stateProvider.state("weather-view",{url:BASE_PATH+"/weather/mobile_view/index/value_id/:value_id",controller:"WeatherController",templateUrl:"templates/weather/l1/view.html",cache:!0,resolve:lazyLoadResolver("weather")})}),angular.module("starter").config(function($stateProvider,HomepageLayoutProvider){$stateProvider.state("wordpress-list",{url:BASE_PATH+"/wordpress/mobile_list/index/value_id/:value_id",templateUrl:function(param){var layout_id=HomepageLayoutProvider.getLayoutIdForValueId(param.value_id);switch(layout_id){case 2:layout_id="l5";break;case 3:layout_id="l6";break;default:layout_id="l3"}return"templates/html/"+layout_id+"/list.html"},controller:"WordpressListController",cache:!1,resolve:lazyLoadResolver("wordpress")}).state("wordpress-view",{url:BASE_PATH+"/wordpress/mobile_view/index/value_id/:value_id/post_id/:post_id/offset/:offset",templateUrl:"templates/wordpress/l1/view.html",controller:"WordpressViewController",cache:!1,resolve:lazyLoadResolver("wordpress")})}),angular.module("starter").factory("Facebook",function($cacheFactory,$pwaRequest,Url){var factory={value_id:null,token:null,username:null,page_urls:[],displayed_per_page:22,cache:$cacheFactory("facebook"),host:"https://graph.facebook.com/v2.7/",host_img:"https://graph.facebook.com/v2.7/",setValueId:function(value_id){factory.value_id=value_id},preFetch:function(){factory.loadData().then(function(){factory.findUser().then(function(){factory.findPosts()})})},getPictureUrl:function(picture_id,size){return factory.host_img+picture_id+"/picture?width="+size+"&access_token="+factory.token},loadData:function(refresh){return this.value_id?(Math.ceil(Date.now()/1e3)>153342e4&&console.error("Facebook API v2.7 will shutdown 5 October 2018, please upgrade to latest API Version."),$pwaRequest.get("social/mobile_facebook_list/find",{urlParams:{value_id:this.value_id,need_token:!this.token},withCredentials:!1,refresh:refresh}).then(function(response){return factory.username=response.username,response.token&&(factory.token=response.token),response})):$pwaRequest.reject("[Factory::Facebook.loadData] missing value_id")},findUser:function(){var url=Url.build(factory.host+factory.username,{fields:"id,about,name,genre,cover,fan_count,likes,talking_about_count",access_token:this.token});return factory.get(url)},findPosts:function(){var url=Url.build(factory.host+factory.username,{fields:"posts.fields(from,message,full_picture,picture,created_time,likes,comments,type,object_id,name,link)",access_token:factory.token});return angular.isDefined(factory.page_urls.posts)&&(url=factory.page_urls.posts),factory.get(url)},findPost:function(post_id){var url=Url.build(factory.host+post_id,{fields:"from,message,description,full_picture,created_time,likes,comments,object_id,type,name,link",access_token:factory.token});return factory.get(url)},findComments:function(){return factory.get(factory.page_urls.comments)},get:function(url){return $pwaRequest.get(url,{withCredentials:!1})}};return factory}),angular.module("starter").factory("Padlock",function($pwaRequest){var factory={value_id:null,events:{},setValueId:function(value_id){factory.value_id=value_id},onStatusChange:function(id,urls){factory.events[id]=urls},flushData:function(){for(var i in factory.events)if(angular.isArray(factory.events[i]))for(var data=factory.events[i],j=0;j<data.length;j++)$pwaRequest.cache(data[j])},findUnlockTypes:function(){return this.value_id?$pwaRequest.get("padlock/mobile_view/findunlocktypes",{urlParams:{value_id:this.value_id}}):$pwaRequest.reject("[Factory::Padlock.findUnlockTypes] missing value_id")},find:function(){return this.value_id?$pwaRequest.get("padlock/mobile_view/find",{urlParams:{value_id:this.value_id}}):$pwaRequest.reject("[Factory::Padlock.find] missing value_id")},unlockByQRCode:function(qrcode){return qrcode?$pwaRequest.post("padlock/mobile_view/unlockByQRCode",{data:{qrcode:qrcode},cache:!1}):$pwaRequest.reject("[Factory::Padlock.unlockByQRCode] missing value_id")}};return factory}),angular.module("starter").factory("Pages",function($pwaRequest,$rootScope,$q,$log,SB){var factory={data:null,features:[],touched:[],last_refresh:-1,refresh_interval:$rootScope.isOverview?0:300,is_refreshing:!1},_ready=!1,_ready_resolver=$q.defer();return Object.defineProperty(factory,"ready",{get:function(){return _ready?$q.resolve():_ready_resolver.promise},set:function(value){!0===(_ready=!!value)&&_ready_resolver.resolve()}}),factory.populate=function(data){return factory.data=angular.copy(data),factory.features=angular.copy(data.pages),factory.data.pages=_.filter(data.pages,{homepage:!0}),data.hasOwnProperty("touched")&&(factory.touched=data.touched,factory.last_refresh=Math.trunc(Date.now()/1e3)),$rootScope.$broadcast(SB.EVENTS.CACHE.pagesReload),factory.ready=!0,$q.resolve(data)},factory.getActivePages=function(){return _.filter(factory.features,{is_active:!0})},factory.refresh=function(){$pwaRequest.get("front/mobile/pagesv2",{refresh:!0}).then(function(data){factory.features=angular.copy(data.pages),factory.data.pages=_.filter(data.pages,{homepage:!0})})},factory.updateTouched=function(){var deferred=$q.defer(),past_refresh=factory.last_refresh+factory.refresh_interval,now=Math.trunc(Date.now()/1e3);return!factory.is_refreshing&&past_refresh<now?(factory.is_refreshing=!0,$pwaRequest.get("front/mobile/touched",{refresh:!0}).then(function(data){var will_refresh=!1;angular.forEach(data.touched,function(feature,value_id){factory.touched.hasOwnProperty(value_id)&&(factory.touched[value_id].touched_at<feature.touched_at||feature.expires_at<now)&&(will_refresh=!0)}),factory.touched=data.touched,factory.last_refresh=now,deferred.resolve(factory.touched),will_refresh&&factory.refresh(),factory.is_refreshing=!1})):deferred.resolve(factory.touched),deferred.promise},factory.getForValueId=function(value_id){return factory.updateTouched(),factory.touched.hasOwnProperty(value_id)?factory.touched[value_id]:{touched_at:-1,expires_at:-1}},factory.getLayoutIdForValueId=function(value_id){return _.get(_.filter(factory.features,function(feature){return feature.value_id==value_id})[0],"layout_id",1)},factory.getTouchedAt=function(value_id){return factory.getForValueId(value_id).touched_at},factory.getExpiresAt=function(value_id){return factory.getForValueId(value_id).expires_at},factory.getLayoutIdForValueId=function(value_id){return _.get(_.filter(factory.features,{value_id:1*value_id})[0],"layout_id",1)},factory.getPayloadForValueId=function(value_id){return _.get(_.filter(factory.features,{value_id:1*value_id})[0],"embed_payload",!1)},factory}),angular.module("starter").factory("Tc",function($pwaRequest){var factory={id:null,extendedOptions:{},setId:function(id){factory.id=id},find:function(tc_id,refresh){return factory.id&&tc_id||$pwaRequest.reject("[Factory::Tc.find] missing factory.id or tc_id"),$pwaRequest.get("application/mobile_tc_view/find",{urlParams:{tc_id:tc_id||factory.id},refresh:refresh})}};return factory}),angular.module("starter").factory("Cms",function($pwaRequest){var factory={value_id:null,extendedOptions:{},setValueId:function(value_id){factory.value_id=value_id},setExtendedOptions:function(options){factory.extendedOptions=options},preFetch:function(){factory.findAll()},findAll:function(page_id,refresh){return this.value_id?$pwaRequest.get("cms/mobile_page_view/findall",angular.extend({urlParams:{value_id:this.value_id,page_id:page_id},refresh:refresh},factory.extendedOptions)):$pwaRequest.reject("[Factory::Cms.findAll] missing value_id")},find:function(page_id,refresh){return this.value_id?$pwaRequest.get("cms/mobile_page_view/find",{urlParams:{value_id:this.value_id,page_id:page_id},refresh:refresh}):$pwaRequest.reject("[Factory::Cms.find] missing value_id")},findBlock:function(block_id,page_id,refresh){return this.value_id?$pwaRequest.get("cms/mobile_page_view/findblock",{urlParams:{block_id:block_id,page_id:page_id,value_id:this.value_id},refresh:refresh}):$pwaRequest.reject("[Factory::Cms.findBlock] missing value_id")}};return factory}),angular.module("starter").factory("Push",function($pwaRequest,$session,SB){var factory={value_id:null,device_type:DEVICE_TYPE,device_token:null,unread_count:0,extendedOptions:{},setValueId:function(valueId){factory.value_id=valueId},setExtendedOptions:function(options){factory.extendedOptions=options},preFetch:function(page){factory.findAll()},registerAndroidDevice:function(params){$pwaRequest.post("/push/android/registerdevice",{data:angular.extend(params,{device_uid:$session.getDeviceUid(),provider:"fcm"}),cache:!1})},registerIosDevice:function(params){$pwaRequest.post("/push/iphone/registerdevice",{data:angular.extend(params,{device_uid:$session.getDeviceUid()}),cache:!1})},findAll:function(offset,refresh){return this.value_id||$pwaRequest.reject("[Factory::Push.findAll] missing value_id"),$pwaRequest.get("push/mobile_list/findall",angular.extend({urlParams:{value_id:this.value_id,device_uid:$session.getDeviceUid(),offset:offset},refresh:!0},factory.extendedOptions))},updateUnreadCount:function(){return $pwaRequest.get("push/mobile/count",{urlParams:{device_uid:$session.getDeviceUid()}})},getInAppMessages:function(){return $pwaRequest.get("push/mobile/inapp",{urlParams:{device_uid:$session.getDeviceUid()}})},getLastMessages:function(cache){var localCache=void 0===cache||cache;return $pwaRequest.get("push/mobile/lastmessages",{urlParams:{device_uid:$session.getDeviceUid()},refresh:!0,cache:localCache})},markInAppAsRead:function(){return $pwaRequest.get("push/mobile/readinapp",{urlParams:{device_uid:$session.getDeviceUid(),device_type:factory.device_type},cache:!1})},markAsDisplayed:function(messageId){var url="";switch(factory.device_type){case SB.DEVICE.TYPE_ANDROID:url="push/android/markdisplayed";break;case SB.DEVICE.TYPE_IOS:url="push/iphone/markdisplayed";break;default:return $pwaRequest.reject()}return $pwaRequest.get(url,{data:{device_uid:$session.getDeviceUid(),message_id:messageId},cache:!1})}};return factory}),angular.module("starter").controller("PushController",function($location,$rootScope,$scope,$stateParams,LinkService,SB,Push){angular.extend($scope,{is_loading:!0,value_id:$stateParams.value_id,collection:[],toggle_text:!1,card_design:!1,load_more:!1,use_pull_refresh:!0}),Push.setValueId($stateParams.value_id),$scope.loadContent=function(loadMore){var offset=$scope.collection.length;Push.findAll(offset).then(function(data){data.collection&&($scope.collection=$scope.collection.concat(data.collection),$rootScope.$broadcast(SB.EVENTS.PUSH.readPush)),$scope.page_title=data.page_title,$scope.load_more=data.collection.length>=data.displayed_per_page}).then(function(){loadMore&&$scope.$broadcast("scroll.infiniteScrollComplete"),$scope.is_loading=!1})},$scope.pullToRefresh=function(){$scope.pull_to_refresh=!0,$scope.load_more=!1,Push.findAll(0,!0).then(function(data){data.collection&&($scope.collection=data.collection,$rootScope.$broadcast(SB.EVENTS.PUSH.readPush)),$scope.load_more=data.collection.length>=data.displayed_per_page}).then(function(){$scope.$broadcast("scroll.refreshComplete"),$scope.pull_to_refresh=!1})},$scope.showItem=function(item){if(item.url){if($rootScope.isNotAvailableOffline())return;LinkService.openLink(item.url)}else item.action_value?$location.path(item.action_value):$scope.toggle_text=!$scope.toggle_text},$scope.loadMore=function(){$scope.loadContent(!0)},$scope.loadContent()}),angular.module("starter").factory("Search",function($pwaRequest){var factory={url:null,agent:null,extendedOptions:{},setAgent:function(agent,valueId){agent.value_id=valueId,factory.agent=agent,factory.find=agent.find},findAll:function(parameters){return this.url&&this.agent?$pwaRequest.post(factory.url,{urlParams:{value_id:parameters.value_id},data:parameters,cache:!1,refresh:!0}):$pwaRequest.reject("[Factory::Search.findAll] missing url and agent")}};return factory}),angular.module("starter").controller("CustomerController",function($cordovaCamera,$ionicActionSheet,Loader,$ionicPopup,$ionicScrollDelegate,$rootScope,$scope,$timeout,$translate,Application,Customer,Dialog,FacebookConnect,HomepageLayout){angular.extend($scope,{customer:Customer.customer,card:{},is_logged_in:Customer.isLoggedIn(),app_name:Application.app_name,display_login_form:!$scope.is_logged_in&&!Customer.display_account_form,display_account_form:$scope.is_logged_in||Customer.display_account_form,can_connect_with_facebook:!!Customer.can_connect_with_facebook,page_title:$translate.instant("My account"),show_avatar:!0,avatar_loaded:!1,privacy_policy:Application.privacyPolicy.text,privacy_policy_gdpr:Application.privacyPolicy.gdpr,gdpr:{isEnabled:Application.gdpr.isEnabled},myAccount:{settings:{enable_facebook_login:!0,enable_registration:!0}}}),$scope.login=function(){Customer.loginModal($scope)},$scope.requestToken=function(){Customer.requestToken()},$scope.loginWithFacebook=function(){$rootScope.isNotAvailableInOverview()||FacebookConnect.login()},$scope.hideAvatar=function(){$scope.show_avatar=!1},$scope.avatarLoaded=function(){$scope.avatar_loaded=!0,$scope.show_avatar=!0},$scope.editAvatar=function(){var buttons=[{text:$translate.instant("Edit")}];if(null!==$scope.customer.avatar){var text="Cancel "+($scope.customer.delete_avatar?"delete":"edit");buttons.push({text:$translate.instant(text)})}else $scope.customer.is_custom_image&&buttons.push({text:$translate.instant("Delete")});var hideSheet=$ionicActionSheet.show({buttons:buttons,cancelText:$translate.instant("Cancel"),cancel:function(){hideSheet()},buttonClicked:function(index){return 0==index&&$timeout($scope.takePicture,600),1==index&&(null!=$scope.customer.avatar?($scope.customer.avatar=null,$scope.customer.delete_avatar=!1,$scope.avatar_url=Customer.getAvatarUrl($scope.customer.id)):($scope.customer.avatar=!1,$scope.customer.delete_avatar=!0,$scope.avatar_url=Customer.getAvatarUrl($scope.customer.id,{ignore_stored:!0})),$rootScope.$broadcast(SB.EVENTS.AUTH.editSuccess)),!0}})},$scope.takePicture=function(field){var gotImage=function(image_url){$scope.cropModal={original:image_url,result:null},$scope.popupShowing=!1,$ionicPopup.show({template:'<div style="position: absolute" class="cropper"><img-crop ng-if="popupShowing" image="cropModal.original" result-image="cropModal.result" area-type="square" result-image-size="256" result-image-format="image/jpeg" result-image-quality="0.9"></img-crop></div>',cssClass:"avatar-crop",scope:$scope,buttons:[{text:$translate.instant("Cancel"),type:"button-default",onTap:function(e){return!1}},{text:$translate.instant("OK"),type:"button-positive",onTap:function(e){return!0}}]}).then(function(result){result&&($scope.cropModalCtrl=null,$scope.avatar_url=$scope.cropModal.result,$scope.customer.avatar=$scope.cropModal.result,$scope.customer.delete_avatar=!1)}),$scope.popupShowing=!0},gotError=function(err){};if(Application.is_webview){var input=angular.element("<input type='file' accept='image/*'>"),selectedFile=function(evt){var file=evt.currentTarget.files[0],reader=new FileReader;reader.onload=function(onloadEvt){gotImage(onloadEvt.target.result),input.off("change",selectedFile)},reader.onerror=gotError,reader.readAsDataURL(file)};input.on("change",selectedFile),input[0].click()}else var source_type=Camera.PictureSourceType.CAMERA,hideSheet=$ionicActionSheet.show({buttons:[{text:$translate.instant("Take a picture")},{text:$translate.instant("Import from Library")}],cancelText:$translate.instant("Cancel"),cancel:function(){hideSheet()},buttonClicked:function(index){0==index&&(source_type=Camera.PictureSourceType.CAMERA),1==index&&(source_type=Camera.PictureSourceType.PHOTOLIBRARY);var options={quality:90,destinationType:Camera.DestinationType.DATA_URL,sourceType:source_type,encodingType:Camera.EncodingType.JPEG,targetWidth:256,targetHeight:256,correctOrientation:!0,popoverOptions:CameraPopoverOptions,saveToPhotoAlbum:!1};return $cordovaCamera.getPicture(options).then(function(imageData){gotImage("data:image/jpeg;base64,"+imageData)},gotError),!0}})},$scope.loadContent=function(){if($scope.is_logged_in)return $scope.displayAccountForm(),Loader.show(),$scope.customer=Customer.customer,$scope.customer.metadatas=_.isObject($scope.customer.metadatas)?$scope.customer.metadatas:{},$scope.avatar_url=Customer.getAvatarUrl($scope.customer.id),HomepageLayout.getActiveOptions().then(function(options){$scope.optional_fields={ranking:!!_.find(options,{use_ranking:"1"}),nickname:!!_.find(options,{use_nickname:"1"})},$scope.custom_fields=[],$scope.myAccount=_.find(options,function(option){return"tabbar_account"===option.code}),console.log("$scope.myAccount",$scope.myAccount),_.forEach(options,function(opt){var fields=_.get(opt,"custom_fields");_.isArray(fields)&&fields.length>0&&($scope.custom_fields.push(_.pick(opt,["name","code","custom_fields"])),_.forEach(fields,function(field){var mpath=opt.code+"."+field.key;_.set($scope.customer.metadatas,mpath,_.get($scope.customer.metadatas,mpath,field.default||null))}))}),Loader.hide()});HomepageLayout.getOptions().then(function(options){$scope.myAccount=_.find(options,function(option){return"tabbar_account"===option.code})})},$scope.save=function(){$scope.is_loading=!0,Loader.show(),Customer.save($scope.customer).then(function(data){return angular.isDefined(data.message)&&Dialog.alert("",data.message,"OK",-1).then(function(){Customer.login_modal.hide()}),data},function(data){return data&&angular.isDefined(data.message)&&Dialog.alert("Error",data.message,"OK",-1),data}).then(function(){$scope.is_loading=!1,Loader.hide()})},$scope.logout=function(){Customer.logout().then(function(data){FacebookConnect.logout(),data.success&&Customer.hideModal()})},$scope.displayLoginForm=function(){$scope.scrollTop(),$scope.display_forgot_password_form=!1,$scope.display_account_form=!1,$scope.display_privacy_policy=!1,$scope.display_login_form=!0},$rootScope.$on("displayLogin",function(){$scope.displayLoginForm()}),$scope.displayForgotPasswordForm=function(){$scope.scrollTop(),$scope.display_login_form=!1,$scope.display_account_form=!1,$scope.display_privacy_policy=!1,$scope.display_forgot_password_form=!0},$scope.displayAccountForm=function(){$scope.scrollTop(),$scope.myAccount.settings.enable_registration||$scope.displayLoginForm(),$scope.display_login_form=!1,$scope.display_forgot_password_form=!1,$scope.display_privacy_policy=!1,$scope.display_account_form=!0},$scope.displayPrivacyPolicy=function(from){$scope.scrollTop(),$scope.displayed_from=from||"",$scope.display_login_form=!1,$scope.display_forgot_password_form=!1,$scope.display_account_form=!1,$scope.display_privacy_policy=!0},$scope.scrollTop=function(){$ionicScrollDelegate.scrollTop(!1)},$scope.unloadcard=function(){Dialog.confirm("Confirmation","Do you confirm you want to remove your card?").then(function(result){result&&($scope.is_loading=!0,Loader.show(),Customer.removeCard().then(function(data){$scope.card={},$scope.customer.stripe={}},function(data){data&&angular.isDefined(data.message)&&Dialog.alert("Error",data.message,"OK",-1)}).then(function(){$scope.is_loading=!1,Loader.hide()}))})},$scope.loadContent()}),angular.module("starter").factory("Customer",function($sbhttp,$pwaRequest,$rootScope,$session,$timeout,$injector,Application,Loader,Modal,Dialog,Url,SB){var factory={events:[],customer:null,modal:null,login_modal:null,can_access_locked_features:!1,display_account_form:!1,login_modal_hidden_subscriber:null,is_logged_in:!1,facebook_login_enabled:!1,loginScope:null};return console.log("Application",Application),factory.populate=function(customer){factory.customer=customer,factory.is_logged_in=customer.isLoggedIn,factory.id=customer.id,factory.can_access_locked_features=customer.can_access_locked_features,factory.can_connect_with_facebook=customer.can_connect_with_facebook,factory.is_logged_in&&$rootScope.$broadcast(SB.EVENTS.AUTH.loginSuccess),factory.saveCredentials(customer.token)},factory.setFacebookLogin=function(facebook){factory.facebook_login_enabled=!(null===facebook.id||""===facebook.id)},factory.onStatusChange=function(id,urls){factory.events[id]=urls},factory.hideModal=function(){factory.login_modal.hide()},factory.loginModal=function(scope,loginCallback,logoutCallback,registerCallback){if($rootScope.isNotAvailableOffline())return!1;var localScope=scope;void 0===scope&&(localScope=$rootScope),factory.loginScope=localScope,localScope.card_design=!1,localScope.$on("modal.shown",function(){var loginSuccessSubscriber=localScope.$on(SB.EVENTS.AUTH.loginSuccess,function(){"function"==typeof loginCallback&&loginCallback(),$timeout(function(){factory.login_modal.hide()},600)}),logoutSuccessSubscriber=localScope.$on(SB.EVENTS.AUTH.logoutSuccess,function(){"function"==typeof logoutCallback&&logoutCallback(),$timeout(function(){factory.login_modal.hide()},600)}),registerSubscriber=localScope.$on(SB.EVENTS.AUTH.registerSuccess,function(){"function"==typeof registerCallback&&registerCallback(),$timeout(function(){factory.login_modal.hide()},600)});factory.login_modal_hidden_subscriber=localScope.$on("modal.hidden",function(){factory.login_modal_hidden_subscriber(),loginSuccessSubscriber(),logoutSuccessSubscriber(),registerSubscriber()})});return Modal.fromTemplateUrl("templates/customer/account/l1/login.html",{scope:angular.extend(localScope,{_pcustomer_close:function(){factory.login_modal.hide()},_pcustomer_login:function(data){factory.login(data)},_pcustomer_logout:function(){factory.logout()},_pcustomer_login_fb:function(){factory.facebookConnect()},_pcustomer_check_update:function(){$rootScope.checkForUpdate()},_pcustomer_register_or_save:function(data){factory.save(data)},_pcustomer_get_avatar:function(){factory.getAvatarUrl()},_pcustomer_forgotten_password:function(email){factory.forgotPassword(email)},_pcustomer_remove_card:function(){factory.removeCard()},_facebook_enabled:factory.facebook_login_enabled}),animation:"slide-in-up"}).then(function(modal){return factory.login_modal=modal,factory.login_modal.show(),modal})},factory.login=function(data){var localData=angular.extend({},data,{device_uid:$session.getDeviceUid()});Loader.show();var promise=$pwaRequest.post("customer/mobile_account_login/post",{data:localData,cache:!1});return promise.then(function(result){return factory.populate(result.customer),result},function(error){Dialog.alert("Error",error.message,"OK",-1)}).then(function(result){return Loader.hide(),result}),promise},factory.facebookConnect=function(){$rootScope.isNotAvailableInOverview()||$injector.get("FacebookConnect").login()},factory.loginWithFacebook=function(token){var data={device_uid:device.uuid,token:token},promise=$pwaRequest.post("customer/mobile_account_login/loginwithfacebook",{data:data,cache:!1});return promise.then(function(result){return factory.populate(result.customer),result},function(error){return Dialog.alert("Error",error.message,"OK",-1),error}),promise},factory.register=function(data){var localData=angular.extend({},data,{device_uid:$session.getDeviceUid()});Loader.show();var promise=$pwaRequest.post("customer/mobile_account_register/post",{data:localData,cache:!1});return promise.then(function(result){return factory.populate(result.customer),result},function(error){return Dialog.alert("Error",error.message,"OK",-1),error}).then(function(result){return Loader.hide(),result}),promise},factory.forgotPassword=function(email){try{Loader.show(),factory.forgottenpassword(email).then(function(data){data&&angular.isDefined(data.message)&&(Dialog.alert("",data.message,"OK",-1),data.success&&$rootScope.$broadcast("displayLogin"))},function(data){data&&angular.isDefined(data.message)&&Dialog.alert("Error",data.message,"OK",-1)}).then(function(){Loader.hide()})}catch(e){Loader.hide()}},factory.getAvatarUrl=function(customerId,options){var myOptions=angular.isObject(options)?options:{};return Url.get("/customer/mobile_account/avatar",angular.extend({},myOptions,{customer:customerId}))+($rootScope.isOffline?"":"?"+ +new Date)},factory.save=function(data){if(!factory.isLoggedIn())return factory.register(data);Loader.show();var promise=$pwaRequest.post("customer/mobile_account_edit/post",{data:data,cache:!1});return promise.then(function(result){return factory.populate(result.customer),result},function(error){return Dialog.alert("Error",error.message,"OK",-1),error}).then(function(result){return Loader.hide(),result}),promise},factory.forgottenpassword=function(email){Loader.show();var promise=$pwaRequest.post("customer/mobile_account_forgottenpassword/post",{data:{email:email},cache:!1});return promise.then(function(data){return Loader.hide(),data}),promise},factory.logout=function(){Loader.show();var promise=$pwaRequest.get("customer/mobile_account_login/logout",{cache:!1});return promise.then(function(result){return factory.clearCredentials(),result}).then(function(result){return Loader.hide(),result}),promise},factory.removeCard=function(){Loader.show();var promise=$pwaRequest.post("mcommerce/mobile_sales_stripe/removecard",{data:{customer_id:factory.id},cache:!1});return promise.then(function(){Loader.hide()}),promise},factory.find=function(){return $pwaRequest.get("customer/mobile_account_edit/find")},factory.isLoggedIn=function(){return factory.is_logged_in},factory.requestToken=function(){Loader.show();var promise=$pwaRequest.post("customer/mobile_account/request-token",{cache:!1});return promise.then(function(data){return angular.isDefined(data.message)&&Dialog.alert("",data.message,"OK",-1),data},function(data){return data&&angular.isDefined(data.message)&&Dialog.alert("Error",data.message,"OK",-1),data}).then(function(){Loader.hide()}),promise},factory.saveCredentials=function(token){$session.setId(token)},factory.clearCredentials=function(){factory.customer=null,factory.can_access_locked_features=!1,factory.is_logged_in=!1,$rootScope.$broadcast(SB.EVENTS.AUTH.logoutSuccess),$session.clear()},factory}),angular.module("starter").filter("parseUrlFilter",function(){var urlPattern=/(www|http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/gi;return function(text,target,otherProp){return"_blank",angular.forEach(text.match(urlPattern),function(url){var urlPos=text.indexOf(url);-1===text.substr(urlPos-6,4).indexOf("src")&&(text=text.replace(url,'<a target="_blank" href='+url+" style='color:#4682B4'>"+url+"</a>"))}),text}}).filter("chunk",function($log){return function(items,chunk_size){var chunks=[];if(angular.isArray(items)){isNaN(chunk_size)&&(chunk_size=4);for(var i=0;i<items.length;i+=chunk_size)chunks.push(items.slice(i,i+chunk_size))}else $log.error("items is not an array: "+angular.toJson(items));return chunks}}).filter("achunk",function($log){return function(items,size_a,size_b){var chunks=[],alternate=!0;if(angular.isArray(items)){isNaN(size_a)&&(size_a=2),isNaN(size_b)&&(size_b=1);for(var i=0;i<items.length;)chunks.push(items.slice(i,i+(alternate?size_a:size_b))),i+=alternate?size_a:size_b,alternate=!alternate}else $log.error("items is not an array: "+angular.toJson(items));return chunks}}).filter("numberFixedLen",function(){return function(n,len){var num=parseInt(n,10);if(len=parseInt(len,10),isNaN(num)||isNaN(len))return n;for(num=""+num;num.length<len;)num="0"+num;return num}}).filter("secondsToDateTime",[function(){return function(seconds){return new Date(1970,0,1).setSeconds(seconds)}}]).filter("translate",function($translate){return function(text,context){return void 0===context?$translate.instant(text):$translate.instant(text,context)}}).filter("seconds_to_minutes",function(){return function(seconds){if(Number.isNaN(seconds))return"0:00";var s=Math.ceil(seconds);return(s-(s%=60))/60+(s>9?":":":0")+s}}).filter("trusted_html",function($sce){return function(text){return $sce.trustAsHtml(text)}}).filter("html_linky",function($sce,$filter){return function(text_or_html){return text_or_html=$filter("linky")(text_or_html),text_or_html=angular.element("<div/>").html(text_or_html).text(),text_or_html=$sce.trustAsHtml(text_or_html)}}).filter("from_now",function(){return function(date,format){return window.momentjs_loaded&&moment(date).isValid()?void 0===format?moment(date).fromNow():moment(date,format).fromNow():date}}).filter("moment_calendar",function(){return function(date,format){var now=moment();return window.momentjs_loaded&&moment(date).isValid()?moment(date).isSame(now,"day")&&moment(date).isSame(now,"hour")?void 0===format?moment(date).fromNow():moment(date,format).fromNow():moment(date).isSame(now,"day")?void 0===format?moment(date).calendar():moment(date,format).calendar():void 0===format?moment(date).format("lll"):moment(date,format).format("lll"):date}}).filter("multiWordsFilter",function($filter){return function(inputArray,searchText,booleanOp){var result;booleanOp=booleanOp||"AND";var searchTerms=(searchText||"").toLowerCase().split(/\s+/);return"AND"===booleanOp?(result=inputArray,searchTerms.forEach(function(searchTerm){result=$filter("filter")(result,searchTerm)})):(result=[],searchTerms.forEach(function(searchTerm){result=result.concat($filter("filter")(inputArray,searchTerm))})),result}}).filter("moment",function(){return function(date){return window.momentjs_loaded?void 0===date?moment():moment(date):date}}).filter("emojify",function($sce){var EMOJIS={100:"💯",1234:"🔢",interrobang:"⁉️",tm:"™️",information_source:"ℹ️",left_right_arrow:"↔️",arrow_up_down:"↕️",arrow_upper_left:"↖️",arrow_upper_right:"↗️",arrow_lower_right:"↘️",arrow_lower_left:"↙️",keyboard:"⌨",sunny:"☀️",cloud:"☁️",umbrella:"☔️",showman:"☃",comet:"☄",ballot_box_with_check:"☑️",coffee:"☕️",shamrock:"☘",skull_and_crossbones:"☠",radioactive_sign:"☢",biohazard_sign:"☣",orthodox_cross:"☦",wheel_of_dharma:"☸",white_frowning_face:"☹",aries:"♈️",taurus:"♉️",sagittarius:"♐️",capricorn:"♑️",aquarius:"♒️",pisces:"♓️",spades:"♠️",clubs:"♣️",hearts:"♥️",diamonds:"♦️",hotsprings:"♨️",hammer_and_pick:"⚒",anchor:"⚓️",crossed_swords:"⚔",scales:"⚖",alembic:"⚗",gear:"⚙",scissors:"✂️",white_check_mark:"✅",airplane:"✈️",email:"✉️",envelope:"✉️",black_nib:"✒️",heavy_check_mark:"✔️",heavy_multiplication_x:"✖️",star_of_david:"✡",sparkles:"✨",eight_spoked_asterisk:"✳️",eight_pointed_black_star:"✴️",snowflake:"❄️",sparkle:"❇️",question:"❓",grey_question:"❔",grey_exclamation:"❕",exclamation:"❗️",heavy_exclamation_mark:"❗️",heavy_heart_exclamation_mark_ornament:"❣",heart:"❤️",heavy_plus_sign:"➕",heavy_minus_sign:"➖",heavy_division_sign:"➗",arrow_heading_up:"⤴️",arrow_heading_down:"⤵️",wavy_dash:"〰️",congratulations:"㊗️",secret:"㊙️",copyright:"©️",registered:"®️",bangbang:"‼️",leftwards_arrow_with_hook:"↩️",arrow_right_hook:"↪️",watch:"⌚️",hourglass:"⌛️",fast_forward:"⏩",rewind:"⏪",arrow_double_up:"⏫",arrow_double_down:"⏬",black_right_pointing_double_triangle_with_vertical_bar:"⏭",black_left_pointing_double_triangle_with_vertical_bar:"⏮",black_right_pointing_triangle_with_double_vertical_bar:"⏯",alarm_clock:"⏰",stopwatch:"⏱",timer_clock:"⏲",hourglass_flowing_sand:"⏳",double_vertical_bar:"⏸",black_square_for_stop:"⏹",black_circle_for_record:"⏺",m:"Ⓜ️",black_small_square:"▪️",white_small_square:"▫️",arrow_forward:"▶️",arrow_backward:"◀️",white_medium_square:"◻️",black_medium_square:"◼️",white_medium_small_square:"◽️",black_medium_small_square:"◾️",phone:"☎️",telephone:"☎️",point_up:"☝️",star_and_crescent:"☪",peace_symbol:"☮",yin_yang:"☯",relaxed:"☺️",gemini:"♊️",cancer:"♋️",leo:"♌️",virgo:"♍️",libra:"♎️",scorpius:"♏️",recycle:"♻️",wheelchair:"♿️",atom_symbol:"⚛",fleur_de_lis:"⚜",warning:"⚠️",zap:"⚡️",white_circle:"⚪️",black_circle:"⚫️",coffin:"⚰",funeral_urn:"⚱",soccer:"⚽️",baseball:"⚾️",snowman:"⛄️",partly_sunny:"⛅️",thunder_cloud_and_rain:"⛈",ophiuchus:"⛎",pick:"⛏",helmet_with_white_cross:"⛑",chains:"⛓",no_entry:"⛔️",shinto_shrine:"⛩",church:"⛪️",mountain:"⛰",umbrella_on_ground:"⛱",fountain:"⛲️",golf:"⛳️",ferry:"⛴",boat:"⛵️",sailboat:"⛵️",skier:"⛷",ice_skate:"⛸",person_with_ball:"⛹",tent:"⛺️",fuelpump:"⛽️",fist:"✊",hand:"✋",raised_hand:"✋",v:"✌️",writing_hand:"✍",pencil2:"✏️",latin_cross:"✝",x:"❌",negative_squared_cross_mark:"❎",arrow_right:"➡️",curly_loop:"➰",loop:"➿",arrow_left:"⬅️",arrow_up:"⬆️",arrow_down:"⬇️",black_large_square:"⬛️",white_large_square:"⬜️",star:"⭐️",o:"⭕️",part_alternation_mark:"〽️",mahjong:"🀄️",black_joker:"🃏",a:"🅰️",b:"🅱️",o2:"🅾️",parking:"🅿️",ab:"🆎",cl:"🆑",cool:"🆒",free:"🆓",id:"🆔",new:"🆕",ng:"🆖",ok:"🆗",sos:"🆘",up:"🆙",vs:"🆚",koko:"🈁",sa:"🈂️",u7121:"🈚️",u6307:"🈯️",u7981:"🈲",u7a7a:"🈳",u5408:"🈴",u6e80:"🈵",u6709:"🈶",u6708:"🈷️",u7533:"🈸",u5272:"🈹",u55b6:"🈺",ideograph_advantage:"🉐",accept:"🉑",cyclone:"🌀",foggy:"🌁",closed_umbrella:"🌂",night_with_stars:"🌃",sunrise_over_mountains:"🌄",sunrise:"🌅",city_sunset:"🌆",city_sunrise:"🌇",rainbow:"🌈",bridge_at_night:"🌉",ocean:"🌊",volcano:"🌋",milky_way:"🌌",earth_africa:"🌍",earth_americas:"🌎",earth_asia:"🌏",globe_with_meridians:"🌐",new_moon:"🌑",waxing_crescent_moon:"🌒",first_quarter_moon:"🌓",moon:"🌔",waxing_gibbous_moon:"🌔",full_moon:"🌕",waning_gibbous_moon:"🌖",last_quarter_moon:"🌗",waning_crescent_moon:"🌘",crescent_moon:"🌙",new_moon_with_face:"🌚",first_quarter_moon_with_face:"🌛",last_quarter_moon_with_face:"🌜",full_moon_with_face:"🌝",sun_with_face:"🌞",star2:"🌟",stars:"🌠",thermometer:"🌡",mostly_sunny:"🌤",sun_small_cloud:"🌤",barely_sunny:"🌥",sun_behind_cloud:"🌥",partly_sunny_rain:"🌦",sun_behind_rain_cloud:"🌦",rain_cloud:"🌧",snow_cloud:"🌨",lightning:"🌩",lightning_cloud:"🌩",tornado:"🌪",tornado_cloud:"🌪",fog:"🌫",wind_blowing_face:"🌬",hotdog:"🌭",taco:"🌮",burrito:"🌯",chestnut:"🌰",seedling:"🌱",evergreen_tree:"🌲",deciduous_tree:"🌳",palm_tree:"🌴",cactus:"🌵",hot_pepper:"🌶",tulip:"🌷",cherry_blossom:"🌸",rose:"🌹",hibiscus:"🌺",sunflower:"🌻",blossom:"🌼",corn:"🌽",ear_of_rice:"🌾",herb:"🌿",four_leaf_clover:"🍀",maple_leaf:"🍁",fallen_leaf:"🍂",leaves:"🍃",mushroom:"🍄",tomato:"🍅",eggplant:"🍆",grapes:"🍇",melon:"🍈",watermelon:"🍉",tangerine:"🍊",lemon:"🍋",banana:"🍌",pineapple:"🍍",apple:"🍎",green_apple:"🍏",pear:"🍐",peach:"🍑",cherries:"🍒",strawberry:"🍓",hamburger:"🍔",pizza:"🍕",meat_on_bone:"🍖",poultry_leg:"🍗",rice_cracker:"🍘",rice_ball:"🍙",rice:"🍚",curry:"🍛",ramen:"🍜",spaghetti:"🍝",bread:"🍞",fries:"🍟",sweet_potato:"🍠",dango:"🍡",oden:"🍢",sushi:"🍣",fried_shrimp:"🍤",fish_cake:"🍥",icecream:"🍦",shaved_ice:"🍧",ice_cream:"🍨",doughnut:"🍩",cookie:"🍪",chocolate_bar:"🍫",candy:"🍬",lollipop:"🍭",custard:"🍮",honey_pot:"🍯",cake:"🍰",bento:"🍱",stew:"🍲",egg:"🍳",fork_and_knife:"🍴",tea:"🍵",sake:"🍶",wine_glass:"🍷",cocktail:"🍸",tropical_drink:"🍹",beer:"🍺",beers:"🍻",baby_bottle:"🍼",knife_fork_plate:"🍽",champagne:"🍾",popcorn:"🍿",ribbon:"🎀",gift:"🎁",birthday:"🎂",jack_o_lantern:"🎃",christmas_tree:"🎄",santa:"🎅",fireworks:"🎆",sparkler:"🎇",balloon:"🎈",tada:"🎉",confetti_ball:"🎊",tanabata_tree:"🎋",crossed_flags:"🎌",bamboo:"🎍",dolls:"🎎",flags:"🎏",wind_chime:"🎐",rice_scene:"🎑",school_satchel:"🎒",mortar_board:"🎓",medal:"🎖",reminder_ribbon:"🎗",studio_microphone:"🎙",level_slider:"🎚",control_knobs:"🎛",film_frames:"🎞",admission_tickets:"🎟",carousel_horse:"🎠",ferris_wheel:"🎡",roller_coaster:"🎢",fishing_pole_and_fish:"🎣",microphone:"🎤",movie_camera:"🎥",cinema:"🎦",headphones:"🎧",art:"🎨",tophat:"🎩",circus_tent:"🎪",ticket:"🎫",clapper:"🎬",performing_arts:"🎭",video_game:"🎮",dart:"🎯",slot_machine:"🎰","8ball":"🎱",game_die:"🎲",bowling:"🎳",flower_playing_cards:"🎴",musical_note:"🎵",notes:"🎶",saxophone:"🎷",guitar:"🎸",musical_keyboard:"🎹",trumpet:"🎺",violin:"🎻",musical_score:"🎼",running_shirt_with_sash:"🎽",tennis:"🎾",ski:"🎿",basketball:"🏀",checkered_flag:"🏁",snowboarder:"🏂",runner:"🏃",running:"🏃",surfer:"🏄",sports_medal:"🏅",trophy:"🏆",horse_racing:"🏇",football:"🏈",rugby_football:"🏉",swimmer:"🏊",weight_lifter:"🏋",golfer:"🏌",racing_motorcycle:"🏍",racing_car:"🏎",cricket_bat_and_ball:"🏏",volleyball:"🏐",field_hockey_stick_and_ball:"🏑",ice_hockey_stick_and_puck:"🏒",table_tennis_paddle_and_ball:"🏓",snow_capped_mountain:"🏔",camping:"🏕",beach_with_umbrella:"🏖",building_construction:"🏗",house_buildings:"🏘",cityscape:"🏙",derelict_house_building:"🏚",classical_building:"🏛",desert:"🏜",desert_island:"🏝",national_park:"🏞",stadium:"🏟",house:"🏠",house_with_garden:"🏡",office:"🏢",post_office:"🏣",european_post_office:"🏤",hospital:"🏥",bank:"🏦",atm:"🏧",hotel:"🏨",love_hotel:"🏩",convenience_store:"🏪",school:"🏫",department_store:"🏬",factory:"🏭",izakaya_lantern:"🏮",lantern:"🏮",japanese_castle:"🏯",european_castle:"🏰",waving_white_flag:"🏳",waving_black_flag:"🏴",rosette:"🏵",label:"🏷",badminton_racquet_and_shuttlecock:"🏸",bow_and_arrow:"🏹",amphora:"🏺","skin-tone-2":"🏻","skin-tone-3":"🏼","skin-tone-4":"🏽","skin-tone-5":"🏾","skin-tone-6":"🏿",rat:"🐀",mouse2:"🐁",ox:"🐂",water_buffalo:"🐃",cow2:"🐄",tiger2:"🐅",leopard:"🐆",rabbit2:"🐇",cat2:"🐈",dragon:"🐉",crocodile:"🐊",whale2:"🐋",snail:"🐌",snake:"🐍",racehorse:"🐎",ram:"🐏",goat:"🐐",sheep:"🐑",monkey:"🐒",rooster:"🐓",chicken:"🐔",dog2:"🐕",pig2:"🐖",boar:"🐗",elephant:"🐘",octopus:"🐙",shell:"🐚",bug:"🐛",ant:"🐜",bee:"🐝",honeybee:"🐝",beetle:"🐞",fish:"🐟",tropical_fish:"🐠",blowfish:"🐡",turtle:"🐢",hatching_chick:"🐣",baby_chick:"🐤",hatched_chick:"🐥",bird:"🐦",penguin:"🐧",koala:"🐨",poodle:"🐩",dromedary_camel:"🐪",camel:"🐫",dolphin:"🐬",flipper:"🐬",mouse:"🐭",cow:"🐮",tiger:"🐯",rabbit:"🐰",cat:"🐱",dragon_face:"🐲",whale:"🐳",horse:"🐴",monkey_face:"🐵",dog:"🐶",pig:"🐷",frog:"🐸",hamster:"🐹",wolf:"🐺",bear:"🐻",panda_face:"🐼",pig_nose:"🐽",feet:"🐾",paw_prints:"🐾",chipmunk:"🐿",eyes:"👀",eye:"👁",ear:"👂",nose:"👃",lips:"👄",tongue:"👅",point_up_2:"👆",point_down:"👇",point_left:"👈",point_right:"👉",facepunch:"👊",punch:"👊",wave:"👋",ok_hand:"👌","+1":"👍",thumbsup:"👍","-1":"👎",thumbsdown:"👎",clap:"👏",open_hands:"👐",crown:"👑",womans_hat:"👒",eyeglasses:"👓",necktie:"👔",shirt:"👕",tshirt:"👕",jeans:"👖",dress:"👗",kimono:"👘",bikini:"👙",womans_clothes:"👚",purse:"👛",handbag:"👜",pouch:"👝",mans_shoe:"👞",shoe:"👞",athletic_shoe:"👟",high_heel:"👠",sandal:"👡",boot:"👢",footprints:"👣",bust_in_silhouette:"👤",busts_in_silhouette:"👥",boy:"👦",girl:"👧",man:"👨",woman:"👩",family:"👨‍👩‍👦","man-woman-boy":"👨‍👩‍👦",couple:"👫",man_and_woman_holding_hands:"👫",two_men_holding_hands:"👬",two_women_holding_hands:"👭",cop:"👮",dancers:"👯",bride_with_veil:"👰",person_with_blond_hair:"👱",man_with_gua_pi_mao:"👲",man_with_turban:"👳",older_man:"👴",older_woman:"👵",baby:"👶",construction_worker:"👷",princess:"👸",japanese_ogre:"👹",japanese_goblin:"👺",ghost:"👻",angel:"👼",alien:"👽",space_invader:"👾",imp:"👿",skull:"💀",information_desk_person:"💁",guardsman:"💂",dancer:"💃",lipstick:"💄",nail_care:"💅",massage:"💆",haircut:"💇",barber:"💈",syringe:"💉",pill:"💊",kiss:"💋",love_letter:"💌",ring:"💍",gem:"💎",couplekiss:"💏",bouquet:"💐",couple_with_heart:"💑",wedding:"💒",heartbeat:"💓",broken_heart:"💔",two_hearts:"💕",sparkling_heart:"💖",heartpulse:"💗",cupid:"💘",blue_heart:"💙",green_heart:"💚",yellow_heart:"💛",purple_heart:"💜",gift_heart:"💝",revolving_hearts:"💞",heart_decoration:"💟",diamond_shape_with_a_dot_inside:"💠",bulb:"💡",anger:"💢",bomb:"💣",zzz:"💤",boom:"💥",collision:"💥",sweat_drops:"💦",droplet:"💧",dash:"💨",hankey:"💩",poop:"💩",shit:"💩",muscle:"💪",dizzy:"💫",speech_balloon:"💬",thought_balloon:"💭",white_flower:"💮",moneybag:"💰",currency_exchange:"💱",heavy_dollar_sign:"💲",credit_card:"💳",yen:"💴",dollar:"💵",euro:"💶",pound:"💷",money_with_wings:"💸",chart:"💹",seat:"💺",computer:"💻",briefcase:"💼",minidisc:"💽",floppy_disk:"💾",cd:"💿",dvd:"📀",file_folder:"📁",open_file_folder:"📂",page_with_curl:"📃",page_facing_up:"📄",date:"📅",calendar:"📆",card_index:"📇",chart_with_upwards_trend:"📈",chart_with_downwards_trend:"📉",bar_chart:"📊",clipboard:"📋",pushpin:"📌",round_pushpin:"📍",paperclip:"📎",straight_ruler:"📏",triangular_ruler:"📐",bookmark_tabs:"📑",ledger:"📒",notebook:"📓",notebook_with_decorative_cover:"📔",closed_book:"📕",book:"📖",open_book:"📖",green_book:"📗",blue_book:"📘",orange_book:"📙",books:"📚",name_badge:"📛",scroll:"📜",memo:"📝",pencil:"📝",telephone_receiver:"📞",pager:"📟",fax:"📠",satellite:"🛰",loudspeaker:"📢",mega:"📣",outbox_tray:"📤",inbox_tray:"📥",package:"📦","e-mail":"📧",incoming_envelope:"📨",envelope_with_arrow:"📩",mailbox_closed:"📪",mailbox:"📫",mailbox_with_mail:"📬",mailbox_with_no_mail:"📭",postbox:"📮",postal_horn:"📯",newspaper:"📰",iphone:"📱",calling:"📲",vibration_mode:"📳",mobile_phone_off:"📴",no_mobile_phones:"📵",signal_strength:"📶",camera:"📷",camera_with_flash:"📸",video_camera:"📹",tv:"📺",radio:"📻",vhs:"📼",film_projector:"📽",prayer_beads:"📿",twisted_rightwards_arrows:"🔀",repeat:"🔁",repeat_one:"🔂",arrows_clockwise:"🔃",arrows_counterclockwise:"🔄",low_brightness:"🔅",high_brightness:"🔆",mute:"🔇",speaker:"🔈",sound:"🔉",loud_sound:"🔊",battery:"🔋",electric_plug:"🔌",mag:"🔍",mag_right:"🔎",lock_with_ink_pen:"🔏",closed_lock_with_key:"🔐",key:"🔑",lock:"🔒",unlock:"🔓",bell:"🔔",no_bell:"🔕",bookmark:"🔖",link:"🔗",radio_button:"🔘",back:"🔙",end:"🔚",on:"🔛",soon:"🔜",top:"🔝",underage:"🔞",keycap_ten:"🔟",capital_abcd:"🔠",abcd:"🔡",symbols:"🔣",abc:"🔤",fire:"🔥",flashlight:"🔦",wrench:"🔧",hammer:"🔨",nut_and_bolt:"🔩",hocho:"🔪",knife:"🔪",gun:"🔫",microscope:"🔬",telescope:"🔭",crystal_ball:"🔮",six_pointed_star:"🔯",beginner:"🔰",trident:"🔱",black_square_button:"🔲",white_square_button:"🔳",red_circle:"🔴",large_blue_circle:"🔵",large_orange_diamond:"🔶",large_blue_diamond:"🔷",small_orange_diamond:"🔸",small_blue_diamond:"🔹",small_red_triangle:"🔺",small_red_triangle_down:"🔻",arrow_up_small:"🔼",arrow_down_small:"🔽",om_symbol:"🕉",dove_of_peace:"🕊",kaaba:"🕋",mosque:"🕌",synagogue:"🕍",menorah_with_nine_branches:"🕎",clock1:"🕐",clock2:"🕑",clock3:"🕒",clock4:"🕓",clock5:"🕔",clock6:"🕕",clock7:"🕖",clock8:"🕗",clock9:"🕘",clock10:"🕙",clock11:"🕚",clock12:"🕛",clock130:"🕜",clock230:"🕝",clock330:"🕞",clock430:"🕟",clock530:"🕠",clock630:"🕡",clock730:"🕢",clock830:"🕣",clock930:"🕤",clock1030:"🕥",clock1130:"🕦",clock1230:"🕧",candle:"🕯",mantelpiece_clock:"🕰",hole:"🕳",man_in_business_suit_levitating:"🕴",sleuth_or_spy:"🕵",dark_sunglasses:"🕶",spider:"🕷",spider_web:"🕸",joystick:"🕹",linked_paperclips:"🖇",lower_left_ballpoint_pen:"🖊",lower_left_fountain_pen:"🖋",lower_left_paintbrush:"🖌",lower_left_crayon:"🖍",raised_hand_with_fingers_splayed:"🖐",middle_finger:"🖕",reversed_hand_with_middle_finger_extended:"🖕","spock-hand":"🖖",desktop_computer:"🖥",printer:"🖨",three_button_mouse:"🖱",trackball:"🖲",frame_with_picture:"🖼",card_index_dividers:"🗂",card_file_box:"🗃",file_cabinet:"🗄",wastebasket:"🗑",spiral_note_pad:"🗒",spiral_calendar_pad:"🗓",compression:"🗜",old_key:"🗝",rolled_up_newspaper:"🗞",dagger_knife:"🗡",speaking_head_in_silhouette:"🗣",left_speech_bubble:"🗨",right_anger_bubble:"🗯",ballot_box_with_ballot:"🗳",world_map:"🗺",mount_fuji:"🗻",tokyo_tower:"🗼",statue_of_liberty:"🗽",japan:"🗾",moyai:"🗿",grinning:"😀",grin:"😁",joy:"😂",smiley:"😃",smile:"😄",sweat_smile:"😅",laughing:"😆",satisfied:"😆",innocent:"😇",smiling_imp:"😈",wink:"😉",blush:"😊",yum:"😋",relieved:"😌",heart_eyes:"😍",sunglasses:"😎",smirk:"😏",neutral_face:"😐",expressionless:"😑",unamused:"😒",sweat:"😓",pensive:"😔",confused:"😕",confounded:"😖",kissing:"😗",kissing_heart:"😘",kissing_smiling_eyes:"😙",kissing_closed_eyes:"😚",stuck_out_tongue:"😛",stuck_out_tongue_winking_eye:"😜",stuck_out_tongue_closed_eyes:"😝",disappointed:"😞",worried:"😟",angry:"😠",rage:"😡",cry:"😢",persevere:"😣",triumph:"😤",disappointed_relieved:"😥",frowning:"😦",anguished:"😧",fearful:"😨",weary:"😩",sleepy:"😪",tired_face:"😫",grimacing:"😬",sob:"😭",open_mouth:"😮",hushed:"😯",cold_sweat:"😰",scream:"😱",astonished:"😲",flushed:"😳",sleeping:"😴",dizzy_face:"😵",no_mouth:"😶",mask:"😷",smile_cat:"😸",joy_cat:"😹",smiley_cat:"😺",heart_eyes_cat:"😻",smirk_cat:"😼",kissing_cat:"😽",pouting_cat:"😾",crying_cat_face:"😿",scream_cat:"🙀",slightly_frowning_face:"🙁",slightly_smiling_face:"🙂",upside_down_face:"🙃",face_with_rolling_eyes:"🙄",no_good:"🙅",ok_woman:"🙆",bow:"🙇",see_no_evil:"🙈",hear_no_evil:"🙉",speak_no_evil:"🙊",raising_hand:"🙋",raised_hands:"🙌",person_frowning:"🙍",person_with_pouting_face:"🙎",pray:"🙏",rocket:"🚀",helicopter:"🚁",steam_locomotive:"🚂",railway_car:"🚃",bullettrain_side:"🚄",bullettrain_front:"🚅",train2:"🚆",metro:"🚇",light_rail:"🚈",station:"🚉",tram:"🚊",train:"🚋",bus:"🚌",oncoming_bus:"🚍",trolleybus:"🚎",busstop:"🚏",minibus:"🚐",ambulance:"🚑",fire_engine:"🚒",police_car:"🚓",oncoming_police_car:"🚔",taxi:"🚕",oncoming_taxi:"🚖",car:"🚗",red_car:"🚗",oncoming_automobile:"🚘",blue_car:"🚙",truck:"🚚",articulated_lorry:"🚛",tractor:"🚜",monorail:"🚝",mountain_railway:"🚞",suspension_railway:"🚟",mountain_cableway:"🚠",aerial_tramway:"🚡",ship:"🚢",rowboat:"🚣",speedboat:"🚤",traffic_light:"🚥",vertical_traffic_light:"🚦",construction:"🚧",rotating_light:"🚨",triangular_flag_on_post:"🚩",door:"🚪",no_entry_sign:"🚫",smoking:"🚬",no_smoking:"🚭",put_litter_in_its_place:"🚮",do_not_litter:"🚯",potable_water:"🚰","non-potable_water":"🚱",bike:"🚲",no_bicycles:"🚳",bicyclist:"🚴",mountain_bicyclist:"🚵",walking:"🚶",no_pedestrians:"🚷",children_crossing:"🚸",mens:"🚹",womens:"🚺",restroom:"🚻",baby_symbol:"🚼",toilet:"🚽",wc:"🚾",shower:"🚿",bath:"🛀",bathtub:"🛁",passport_control:"🛂",customs:"🛃",baggage_claim:"🛄",left_luggage:"🛅",couch_and_lamp:"🛋",sleeping_accommodation:"🛌",shopping_bags:"🛍",bellhop_bell:"🛎",bed:"🛏",place_of_worship:"🛐",hammer_and_wrench:"🛠",shield:"🛡",oil_drum:"🛢",motorway:"🛣",railway_track:"🛤",motor_boat:"🛥",small_airplane:"🛩",airplane_departure:"🛫",airplane_arriving:"🛬",passenger_ship:"🛳",zipper_mouth_face:"🤐",money_mouth_face:"🤑",face_with_thermometer:"🤒",nerd_face:"🤓",thinking_face:"🤔",face_with_head_bandage:"🤕",robot_face:"🤖",hugging_face:"🤗",the_horns:"🤘",sign_of_the_horns:"🤘",crab:"🦀",lion_face:"🦁",scorpion:"🦂",turkey:"🦃",unicorn_face:"🦄",cheese_wedge:"🧀",hash:"#️⃣",keycap_star:"*⃣",zero:"0️⃣",one:"1️⃣",two:"2️⃣",three:"3️⃣",four:"4️⃣",five:"5️⃣",six:"6️⃣",seven:"7️⃣",eight:"8️⃣",nine:"9️⃣","flag-ac":"🇦🇨","flag-ad":"🇦🇩","flag-ae":"🇦🇪","flag-af":"🇦🇫","flag-ag":"🇦🇬","flag-ai":"🇦🇮","flag-al":"🇦🇱","flag-am":"🇦🇲","flag-ao":"🇦🇴","flag-aq":"🇦🇶","flag-ar":"🇦🇷","flag-as":"🇦🇸","flag-at":"🇦🇹","flag-au":"🇦🇺","flag-aw":"🇦🇼","flag-ax":"🇦🇽","flag-az":"🇦🇿","flag-ba":"🇧🇦","flag-bb":"🇧🇧","flag-bd":"🇧🇩","flag-be":"🇧🇪","flag-bf":"🇧🇫","flag-bg":"🇧🇬","flag-bh":"🇧🇭","flag-bi":"🇧🇮","flag-bj":"🇧🇯","flag-bl":"🇧🇱","flag-bm":"🇧🇲","flag-bn":"🇧🇳","flag-bo":"🇧🇴","flag-bq":"🇧🇶","flag-br":"🇧🇷","flag-bs":"🇧🇸","flag-bt":"🇧🇹","flag-bv":"🇧🇻","flag-bw":"🇧🇼","flag-by":"🇧🇾","flag-bz":"🇧🇿","flag-ca":"🇨🇦","flag-cc":"🇨🇨","flag-cd":"🇨🇩","flag-cf":"🇨🇫","flag-cg":"🇨🇬","flag-ch":"🇨🇭","flag-ci":"🇨🇮","flag-ck":"🇨🇰","flag-cl":"🇨🇱","flag-cm":"🇨🇲","flag-cn":"🇨🇳",cn:"🇨🇳","flag-co":"🇨🇴","flag-cp":"🇨🇵","flag-cr":"🇨🇷","flag-cu":"🇨🇺","flag-cv":"🇨🇻","flag-cw":"🇨🇼","flag-cx":"🇨🇽","flag-cy":"🇨🇾","flag-cz":"🇨🇿","flag-de":"🇩🇪",de:"🇩🇪","flag-dg":"🇩🇬","flag-dj":"🇩🇯","flag-dk":"🇩🇰","flag-dm":"🇩🇲","flag-do":"🇩🇴","flag-dz":"🇩🇿","flag-ea":"🇪🇦","flag-ec":"🇪🇨","flag-ee":"🇪🇪","flag-eg":"🇪🇬","flag-eh":"🇪🇭","flag-er":"🇪🇷","flag-es":"🇪🇸",es:"🇪🇸","flag-et":"🇪🇹","flag-eu":"🇪🇺","flag-fi":"🇫🇮","flag-fj":"🇫🇯","flag-fk":"🇫🇰","flag-fm":"🇫🇲","flag-fo":"🇫🇴","flag-fr":"🇫🇷",fr:"🇫🇷","flag-ga":"🇬🇦","flag-gb":"🇬🇧",gb:"🇬🇧",uk:"🇬🇧","flag-gd":"🇬🇩","flag-ge":"🇬🇪","flag-gf":"🇬🇫","flag-gg":"🇬🇬","flag-gh":"🇬🇭","flag-gi":"🇬🇮","flag-gl":"🇬🇱","flag-gm":"🇬🇲","flag-gn":"🇬🇳","flag-gp":"🇬🇵","flag-gq":"🇬🇶","flag-gr":"🇬🇷","flag-gs":"🇬🇸","flag-gt":"🇬🇹","flag-gu":"🇬🇺","flag-gw":"🇬🇼","flag-gy":"🇬🇾","flag-hk":"🇭🇰","flag-hm":"🇭🇲","flag-hn":"🇭🇳","flag-hr":"🇭🇷","flag-ht":"🇭🇹","flag-hu":"🇭🇺","flag-ic":"🇮🇨","flag-id":"🇮🇩","flag-ie":"🇮🇪","flag-il":"🇮🇱","flag-im":"🇮🇲","flag-in":"🇮🇳","flag-io":"🇮🇴","flag-iq":"🇮🇶","flag-ir":"🇮🇷","flag-is":"🇮🇸","flag-it":"🇮🇹",it:"🇮🇹","flag-je":"🇯🇪","flag-jm":"🇯🇲","flag-jo":"🇯🇴","flag-jp":"🇯🇵",jp:"🇯🇵","flag-ke":"🇰🇪","flag-kg":"🇰🇬","flag-kh":"🇰🇭","flag-ki":"🇰🇮","flag-km":"🇰🇲","flag-kn":"🇰🇳","flag-kp":"🇰🇵","flag-kr":"🇰🇷",kr:"🇰🇷","flag-kw":"🇰🇼","flag-ky":"🇰🇾","flag-kz":"🇰🇿","flag-la":"🇱🇦","flag-lb":"🇱🇧","flag-lc":"🇱🇨","flag-li":"🇱🇮","flag-lk":"🇱🇰","flag-lr":"🇱🇷","flag-ls":"🇱🇸","flag-lt":"🇱🇹","flag-lu":"🇱🇺","flag-lv":"🇱🇻","flag-ly":"🇱🇾","flag-ma":"🇲🇦","flag-mc":"🇲🇨","flag-md":"🇲🇩","flag-me":"🇲🇪","flag-mf":"🇲🇫","flag-mg":"🇲🇬","flag-mh":"🇲🇭","flag-mk":"🇲🇰","flag-ml":"🇲🇱","flag-mm":"🇲🇲","flag-mn":"🇲🇳","flag-mo":"🇲🇴","flag-mp":"🇲🇵","flag-mq":"🇲🇶","flag-mr":"🇲🇷","flag-ms":"🇲🇸","flag-mt":"🇲🇹","flag-mu":"🇲🇺","flag-mv":"🇲🇻","flag-mw":"🇲🇼","flag-mx":"🇲🇽","flag-my":"🇲🇾","flag-mz":"🇲🇿","flag-na":"🇳🇦","flag-nc":"🇳🇨","flag-ne":"🇳🇪","flag-nf":"🇳🇫","flag-ng":"🇳🇬","flag-ni":"🇳🇮","flag-nl":"🇳🇱","flag-no":"🇳🇴","flag-np":"🇳🇵","flag-nr":"🇳🇷","flag-nu":"🇳🇺","flag-nz":"🇳🇿","flag-om":"🇴🇲","flag-pa":"🇵🇦","flag-pe":"🇵🇪","flag-pf":"🇵🇫","flag-pg":"🇵🇬","flag-ph":"🇵🇭","flag-pk":"🇵🇰","flag-pl":"🇵🇱","flag-pm":"🇵🇲","flag-pn":"🇵🇳","flag-pr":"🇵🇷","flag-ps":"🇵🇸","flag-pt":"🇵🇹","flag-pw":"🇵🇼","flag-py":"🇵🇾","flag-qa":"🇶🇦","flag-re":"🇷🇪","flag-ro":"🇷🇴","flag-rs":"🇷🇸","flag-ru":"🇷🇺",ru:"🇷🇺","flag-rw":"🇷🇼","flag-sa":"🇸🇦","flag-sb":"🇸🇧","flag-sc":"🇸🇨","flag-sd":"🇸🇩","flag-se":"🇸🇪","flag-sg":"🇸🇬","flag-sh":"🇸🇭","flag-si":"🇸🇮","flag-sj":"🇸🇯","flag-sk":"🇸🇰","flag-sl":"🇸🇱","flag-sm":"🇸🇲","flag-sn":"🇸🇳","flag-so":"🇸🇴","flag-sr":"🇸🇷","flag-ss":"🇸🇸","flag-st":"🇸🇹","flag-sv":"🇸🇻","flag-sx":"🇸🇽","flag-sy":"🇸🇾","flag-sz":"🇸🇿","flag-ta":"🇹🇦","flag-tc":"🇹🇨","flag-td":"🇹🇩","flag-tf":"🇹🇫","flag-tg":"🇹🇬","flag-th":"🇹🇭","flag-tj":"🇹🇯","flag-tk":"🇹🇰","flag-tl":"🇹🇱","flag-tm":"🇹🇲","flag-tn":"🇹🇳","flag-to":"🇹🇴","flag-tr":"🇹🇷","flag-tt":"🇹🇹","flag-tv":"🇹🇻","flag-tw":"🇹🇼","flag-tz":"🇹🇿","flag-ua":"🇺🇦","flag-ug":"🇺🇬","flag-um":"🇺🇲","flag-us":"🇺🇸",us:"🇺🇸","flag-uy":"🇺🇾","flag-uz":"🇺🇿","flag-va":"🇻🇦","flag-vc":"🇻🇨","flag-ve":"🇻🇪","flag-vg":"🇻🇬","flag-vi":"🇻🇮","flag-vn":"🇻🇳","flag-vu":"🇻🇺","flag-wf":"🇼🇫","flag-ws":"🇼🇸","flag-xk":"🇽🇰","flag-ye":"🇾🇪","flag-yt":"🇾🇹","flag-za":"🇿🇦","flag-zm":"🇿🇲","flag-zw":"🇿🇼","man-man-boy":"👨‍👨‍👦","man-man-boy-boy":"👨‍👨‍👦‍👦","man-man-girl":"👨‍👨‍👧","man-man-girl-boy":"👨‍👨‍👧‍👦","man-man-girl-girl":"👨‍👨‍👧‍👧","man-woman-boy-boy":"👨‍👩‍👦‍👦","man-woman-girl":"👨‍👩‍👧","man-woman-girl-boy":"👨‍👩‍👧‍👦","man-woman-girl-girl":"👨‍👩‍👧‍👧","man-heart-man":"👨‍❤️‍👨","man-kiss-man":"👨‍❤️‍💋‍👨","woman-woman-boy":"👩‍👩‍👦","woman-woman-boy-boy":"👩‍👩‍👦‍👦","woman-woman-girl":"👩‍👩‍👧","woman-woman-girl-boy":"👩‍👩‍👧‍👦","woman-woman-girl-girl":"👩‍👩‍👧‍👧","woman-heart-woman":"👩‍❤️‍👩","woman-kiss-woman":"👩‍❤️‍💋‍👩"},parser=/:([a-zA-Z0-9_\-\+]+):/g;return function(str){return str=(str=angular.isString(str)?str:angular.isUndefined(str)||null===str?"":Object.prototype.toString(str)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),$sce.trustAsHtml(str.split(parser).map(function(s,i){return i%2==0?s:function(emoji){return EMOJIS.hasOwnProperty(emoji)?$sce.trustAsHtml('<span class="emoji">'+EMOJIS[emoji]+"</span>"):":"+emoji+":"}(s)}).join(""))}});